import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as E}from"./client-misc-B8CxQsfg.js";import{b as J,s as W,h as Q,t as z}from"./fourier-shared-DpvWsPe-.js";import{p as H,d as X,b as Y,P as I}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as M,e as ee}from"./utility-Dgy6CMn3.js";import{a as te}from"./hershey-fonts-Cv6hiE5v.js";import{r as ne}from"./letters-base-CTGJGQGt.js";function se(){document.body.style.backgroundColor="transparent",E.selectorQueryAll("[data-hide-background]",SVGElement).forEach(f=>f.style.display="none")}function re(){const f=E.selectorQuery("[data-hide-background]",SVGElement);f.parentElement?.append(f)}const U=new URLSearchParams(window.location.search);let D=!1;U.get("hide_background")=="1"?se():U.get("only_background")=="1"&&re();{const e=E.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");e.filter="url(#watercolor)";const t=1;e.scale(t,t)}const oe=1024;class ae{constructor(e,t){this.terms=t,e instanceof SVGGElement||(e=E.selectorQuery(e,SVGGElement)),this.#e=E.selectorQueryAll("g.frequency",SVGGElement,0,1/0,e).map(i=>{const r=E.selectorQuery("text",SVGTextElement,i),d=document.createElementNS("http://www.w3.org/2000/svg","text");return d.classList.add("background"),i.insertBefore(d,r),{top:i,spinner:E.selectorQuery(".spinner",SVGPolygonElement,i),text:r,background:d}})}#e;show(e,t){this.#e.forEach((i,r)=>{if(r>=e)i.top.style.display="none";else{i.top.style.display="";const d=this.terms[r];i.background.innerHTML=i.text.innerHTML=d.frequency.toString(),i.spinner.style.transform=`rotate(${t*d.frequency+d.phase+a.FULL_CIRCLE/4}rad)`}})}}function B(f,e){if(f>=e)throw new Error("wtf");const t=a.makeLinear(f,0,e,1);function i(r){if(r<=f)return 0;if(r>=e)return 1;const d=t(r);return ee(d)}return i}let q=()=>{};window.showFrame=f=>{q(f)};class O{constructor(e,t){this.getTransform=t,this.#e=E.selectorQuery(e,SVGGElement),this.#n=E.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=E.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#e)}#e;#n;#t;hide(){this.#e.style.display="none"}show(e,t){this.#e.style.display="",this.#n.style.stroke=e}setReferencePath(e){this.#n.setAttribute("d",e)}setLivePath(e){this.#t.forEach(t=>t.setAttribute("d",e))}setTransform(e){const t=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",t.toString())}static right=new O("#right",e=>H(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const j=new X;class ie{constructor(e){this.pathString=e,this.samples=J(e,oe),this.terms=W(this.samples),this.keyframes=a.initializedArray(21,t=>t)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(e,t=0,i=e-t){const r=this.makeGetPath2(),d=a.makeBoundedLinear(t,0,i,1),F=this.stepCount;function k(g){let m=Math.floor(g/e),s;m<0?(m=0,s=0):m>=F?(m=F-1,s=e):s=g%e;const u=d(s);return{pathString:r(m,u),index:m,t:u}}return k}makeGetPath2(){const e=[...this.terms],t=[...this.keyframes],i=this.stepCount,r=g=>Math.max(...e.slice(0,g).map(s=>Math.abs(s.frequency))),d=g=>{const m=r(g);return 8*Math.min(m,50)+7},F=a.initializedArray(i,g=>{const m=t[g],s=t[g+1];if(m==0&&s==1&&e[0].frequency==0){let u=function(p){return`${o.x*p},${o.y*p}`};const o=a.assertNonNullable(Q(e[0])),n=B(0,.5),c=B(0,1);return p=>{const y=c(p),w=u(y),S=n(p),C=u(S);return`M ${w} L ${C}`}}else{const o=.2/r(s),n=a.makeBoundedLinear(0,-o,1,1+o),c=z(e,m),p=z(e,s-m,m),y=d(s);if(m==0||m==1&&Q(e[0])){const w=Q(e[0])??{x:0,y:0};return S=>{const C=n(S),G=C-o,T=C+o,L=B(G,T),x=Math.min(1,T);if(x<=0)return`M${w.x},${w.y} L${w.x},${w.y}`;{let l=function(v){v=v*x;const R=c(v),P=1-L(v);if(P==0)return R;{const A=p(v);return{x:R.x+P*A.x,y:R.y+P*A.y}}};const h=Math.ceil(Math.max(y,150)*x);return I.glitchFreeParametric(l,h).rawPath}}}else return w=>{const S=n(w),C=B(S-o,S+o);function G(L){const x=c(L),l=1-C(L);if(l==0)return x;{const h=p(L);return{x:x.x+l*h.x,y:x.y+l*h.y}}}return I.glitchFreeParametric(G,y).rawPath}}});function k(g,m){const s=F[g];return s(m)}return k}}class ce{hide(){this.#t.hide()}#e;show(e){this.#t.show(this.#s,this.#r),this.#t.setReferencePath(this.#n),this.#t.setTransform(this.#o),this.#e(e)}endTime;#n;#t;#s;#r;#o;constructor(e,t){this.#n=e.base.pathString,this.#t=e.destination,this.#s=e.referenceColor,this.#r=e.liveColor,j.d=this.#n,this.#o=this.#t.getTransform(j.getBBox());const i=7500,r=750;this.endTime=i*e.base.stepCount;const d=e.base.makeGetPath1(i,0,i-r),F=new ae(t,e.base.terms);this.#e=k=>{const{pathString:g,index:m,t:s}=d(k);this.#t.setLivePath(g),F.show(e.base.keyframes[m+1],s*a.FULL_CIRCLE)}}}function le(...f){q=e=>{f.forEach(t=>t.show(e))}}let $;setTimeout(()=>{if(D)return;let f=NaN;$=new E.AnimationLoop(e=>{isNaN(f)&&(f=e);const t=e-f;q(t)}),window.animationLoop=$},1);function he(f){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),$?.cancel(),{source:"fourier-smackdown.ts",script:f,seconds:120,devicePixelRatio}}window.initScreenCapture=he;class ue{constructor(e,t){this.vertex1=e,this.vertex2=t}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class V{constructor(e,t){this.pathSoFar=e,this.remainingEdges=t}oneStep(){const e=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((t,i)=>{const r=t.other(e);return r===void 0||this.pathSoFar.length==1&&r!=1?[]:new V([...this.pathSoFar,r],this.remainingEdges.toSpliced(i,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const t of e)yield*t.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const t=Math.max(...e.map(r=>Math.max(r.vertex1,r.vertex2)))+1,i=new Set;for(const r of this.get(e)){const d=r.slice(0,r.length-1),F=this.#n(d);if(!i.has(F)){yield r,i.add(F);const k=this.#t(d,t).map(g=>this.#n(g));for(const g of k)i.add(g)}}}static#n(e){return String.fromCharCode(...e.map(t=>t+65))}static#t(e,t){const i=new Array;for(let r=1;r<e.length;r++){const d=e[r],F=(d+1)%t,k=M(e,r+1);F==k?i.push(a.initializedArray(e.length,g=>{const m=M(e,g+r);return a.positiveModulo(m-d,t)})):M(e,r-1)==F&&i.push(a.initializedArray(e.length,m=>{const s=M(e,r-m);return a.positiveModulo(s-d,t)}))}return i}static getSamples(){function e(t,...i){return a.initializedArray(t,r=>i.map(d=>new ue(r,(r+d)%t))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=V;function me(){const f=V.getSamples(),e=V.getUnique(f.pentagram);console.log(e,e.constructor.name);for(const t of e);}me();{let f=function(s,u=8){const o=[],n=s.terms,c=n.length;o.push();for(let y=0;y<5;y++){const w=a.assertNonNullable(n.shift());o.push([w])}for(let y=0;y<10;y++){const w=n.splice(0,2);if(w.length!=2)throw new Error("wtf");o.push(w)}if(console.log({bins:o,terms:n}),o.splice(u,0,[...n]),console.log(o),n.length=0,n.length!=0)throw new Error("wtf");const p=s.keyframes;if(p.length=0,p.push(0),o.forEach(y=>{n.push(...y),p.push(n.length)}),n.length!=c)throw new Error("wtf")};class e{constructor(u){throw new Error("wtf")}static points=a.initializedArray(5,u=>{const o=a.FULL_CIRCLE*u/5+a.FULL_CIRCLE/4,n=Math.cos(o),c=Math.sin(o);return{x:n,y:c}});static allPaths=[...V.getUnique(V.getSamples().pentagram)]}class t{constructor(u){throw new Error("wtf")}static points=a.initializedArray(6,u=>{const o=a.FULL_CIRCLE*u/6+a.FULL_CIRCLE/4,n=Math.cos(o),c=Math.sin(o);return{x:n,y:c}});static allPaths=[...V.getUnique(V.getSamples().dodecahedron)];static makePathShape(u){const o=this.allPaths[u],n=Y.M(i[0].x,i[0].y);return o.forEach((c,p)=>{if(p==0){if(c!=0)throw new Error("wtf")}else{const{x:y,y:w}=i[c],S=o[p-1];switch(a.positiveModulo(c-S,6)){case 1:{n.arc(0,0,y,w,"cw");break}case 2:case 4:{n.L(y,w);break}case 5:{n.arc(0,0,y,w,"ccw");break}default:throw new Error("wtf")}}}),n.pathShape}}const i=t.points,r=t.allPaths,d=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],F=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(r.length,()=>{const s=F()*3|0,u=d[s];return d.splice(s,1),d.push(u),u});const k=[{color:"#black",destRect:{x:.5,y:.5,width:5,height:5},index:29,colorName:"red"},{color:"black",destRect:{x:5.5,y:3.5,width:5,height:5},index:29,colorName:"white"},{color:"black",destRect:{x:10.5,y:.5,width:5,height:5},index:29,colorName:"blue"}],g=k.map(({index:s})=>{const u=t.makePathShape(s).rawPath;return new ie(u)});console.log(g),f(g[0],6),f(g[1],6),f(g[2],6);const m=new Array;for(const[s,u]of a.zip(k,g)){const{color:o,destRect:n}=s,c=s.colorName??s.color,p=E.selectorQuery(`g.frequencies[data-frequencies="${c}"]`,SVGGElement),y=new O(`[data-fourier-top="${c}"]`,C=>H(C,n,"srcRect fits completely into destRect"));p.style.fill=o;const w={base:u,destination:y,liveColor:o,referenceColor:o},S=new ce(w,p);m.push(S),console.log(S)}{let s=function(x,l){const b=[x,x+a.FULL_CIRCLE/3,x-a.FULL_CIRCLE/3].map(A=>T(Math.sin(A)));b.push(0),b.push(L(Math.cos(l)));const v=b.join(" "),P=[v,v,v,"0 0 0 0 1"].join(`
`);n.setAttribute("values",P)},u=function(x){const l=c.map(h=>[]);x.forEach(h=>{if(h.length!=c.length)throw new Error("wtf");h.forEach((b,v)=>{l[v].push(b)})});for(const[h,b]of a.zip(c,l))h.setAttribute("tableValues",b.join(" "))},o=function(x){const l=(x+24e4)/18e4*a.FULL_CIRCLE,h=x/24e4*a.FULL_CIRCLE/2;s(l,h)};const n=E.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),c=[E.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),E.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),E.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],C=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),G=a.makeLinear(0,0,255,1);C.forEach(x=>x.forEach((l,h,b)=>b[h]=G(l)));const T=a.makeLinear(-1,-.05,1,.8),L=a.makeLinear(1,0,-1,-.4);window.updateValues=s,u(C),m.push({show:o})}{let s=function(l){if(n.innerHTML="",l!=""){l.split(`
`).forEach((K,Z)=>{const N=document.createElementNS("http://www.w3.org/2000/svg","text");n.append(N),N.style.setProperty("--index",Z.toString()),N.textContent=K});const b=n.getBBox(),v=b.x+b.width,R=b.y+b.height,P=.1,A=16-v-P,_=9-R-P;n.style.transform=`translate(${A}px, ${_}px)`,c.x.baseVal.value=A-P*2,c.y.baseVal.value=_-P*4}else c.x.baseVal.value=17,c.y.baseVal.value=10},u=function(l){const h=a.assertClass(w.cloneNode(!0),SVGFilterElement);return l??=`lava-lamp-${S++}`,h.id=l,y.parentElement?.appendChild(h),{filter:h,id:l}},o=function(l){let h;l<8500?h=0:l<16e3?h=1:l<34750?h=2:l<5e4?h=3:l<58500?h=4:l<75e3?h=5:l<106e3?h=6:h=7,L.forEach((b,v)=>{const R=v>=h-1;b.style.display=R?"none":""}),s(p[h])};const n=E.getById("lava-lamp-text",SVGGElement),c=E.getById("lava-lamp-rect",SVGRectElement);window.setLavaLampText=s,s(`Hello
world!`);const p=["",`<filter
  id="lava-lamp"
  color-interpolation-filters="sRGB"
  filterUnits="objectBoundingBox"
  x="0"
  y="0"
  width="1"
  height="1"
  primitiveUnits="userSpaceOnUse"
>
`,`<feTurbulence
  type="fractalNoise"
  baseFrequency="0.3 0.75"
  numOctaves="1"
  seed="1971"
  stitchTiles="stitch"
  x="0%"
  y="0%"
  width="100%"
  height="100%"
/>
`,`<feColorMatrix
  type="matrix"
  values="1.2 0.3 -0.3 0 -0.105
          0.  0.   0.  0  0
          0.  0.   0.  0  0
          0.  0.   0.  0  1"
  x="0%"
  y="0%"
  width="100%"
  height="100%"
/>
`,`<feColorMatrix
  type="matrix"
  values="1 0 0 0 0
          1 0 0 0 0
          1 0 0 0 0
          0 0 0 0 1"
  x="0%"
  y="0%"
  width="100%"
  height="100%"
/>
`,`<feGaussianBlur stdDeviation="0.05" />
`,`<feComponentTransfer x="0%" y="0%" width="100%" height="100%">
  <feFuncR type="discrete" tableValues="1 0 0 1 1 0 1" />
  <feFuncG type="discrete" tableValues="0 1 0 0 1 1 1" />
  <feFuncB type="discrete" tableValues="0 0 1 1 0 1 1" />
  <feFuncA type="linear" slope="0" intercept="1" />
</feComponentTransfer>
`,`</filter>
`],y=E.getById("lava-lamp",SVGFilterElement),w=a.assertClass(y.cloneNode(!0),SVGFilterElement);w.id="";let S=1;const C=w.childElementCount;console.log({filterElementCount:C,master:w,duplicate:u});for(let l=0;l<C;l++){const h=u();Array.from(h.filter.children).slice(l+1).forEach(b=>{b.remove()})}const G=u("lava-lamp-without");a.assertClass(G.filter.children[C-2],SVGFEGaussianBlurElement).remove();const L=E.selectorQueryAll("#lava-lamp-pieces *",SVGRectElement);if(L.length+2!=p.length)throw new Error("wtf");m.push({show:o})}if(console.log(m),le(...m),U.get("thumbnail")=="1"){const s=E.selectorQuery("g#foreground",SVGGElement);D=!0;const u=new Array;Array.from(s.children).forEach(n=>{const c=a.assertClass(n,SVGElement);c.dataset.live===void 0?c.style.display="none":(console.log("live",c.dataset.live),u.push(c))}),q(0),E.selectorQueryAll("[data-reference]",SVGPathElement).forEach(n=>n.style.display="none");const o=ne(te,.5);[{name:"red",letter:"S"},{name:"white",letter:"V"},{name:"blue",letter:"G"}].forEach(({name:n,letter:c})=>{const p=o.get(c),y=p.shape.translate(p.advance/2,0).rawPath;E.selectorQueryAll(`[data-fourier-top="${n}"] [data-live]`,SVGPathElement,2,2).forEach(S=>{S.setAttribute("d",y)})}),E.selectorQueryAll("[data-fourier-top]",SVGGElement,3,3).forEach((n,c)=>{const p=getComputedStyle(n).transform,y=["-0.5px, -0.13px","-0.43px,-0.35px","-0.5px, -.13px"];n.style.transform=`${p} scale(4) translate(${y[c]})`}),window.showFrame=n=>{console.info("ignoring showFrame()",n)}}}
