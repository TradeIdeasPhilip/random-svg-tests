import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as m}from"./client-misc-DwSGpjs0.js";import{b as lt,s as ht,h as U,t as _}from"./fourier-shared-BzvpwVbs.js";import{p as K,d as ut,b as dt,r as ft,P as N,e as mt}from"./path-shape-CGtDHPNA.js";import{m as c}from"./misc-CMfj6Nfj.js";import{g as I,e as gt}from"./utility-CDhxIaUX.js";import{r as pt}from"./letters-base-BaPENQZj.js";import{r as yt}from"./hershey-fonts-CGx2ZFtu.js";import{T as wt}from"./letters-more-BY4ZaoeO.js";function St(){document.body.style.backgroundColor="transparent",m.querySelectorAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function Pt(){const i=m.querySelector("[data-hide-background]",SVGElement);i.parentElement?.append(i)}{const i=c.Random.fromString("Pastel 41"),t=m.querySelector("[data-favorite]",SVGCircleElement),e=c.makeLinear(0,.025,2,.15);for(let n=0;n<150;n++){const r=c.assertClass(t.cloneNode(!0),SVGCircleElement);r.cx.baseVal.value=i()*16,r.cy.baseVal.value=i()*9,r.r.baseVal.value=e(i()+i()),t.parentElement.append(r)}}const D=new URLSearchParams(window.location.search);let Z=!1;D.get("hide_background")=="1"?St():D.get("only_background")=="1"&&Pt();{const t=m.querySelector("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const xt=1024;class Q{static#t=m.querySelector("[data-motion-blur-spinners]",HTMLDivElement);#n;constructor(t={radius:1,centerX:2,centerY:2}){const e=document.createElement("div");e.classList.add("motion-blur-spinner"),Q.#t.append(e);const n=this.#n=e.style;n.setProperty("--radius",t.radius.toString()),n.setProperty("--center-x",t.centerX.toString()),n.setProperty("--center-y",t.centerY.toString()),t.color&&n.setProperty("--color",t.color),this.hide()}#e;showRadians(t){const e=this.#e??t;this.#e=t;const n=this.#n;n.display="",n.setProperty("--main-angle",`${t}rad`),n.setProperty("--blur-angle",`${e}rad`)}hide(){this.#e=void 0,this.#n.display="none"}}function B(i,t){if(i>=t)throw new Error("wtf");const e=c.makeLinear(i,0,t,1);function n(r){if(r<=i)return 0;if(r>=t)return 1;const u=e(r);return gt(u)}return n}let W=()=>{};window.showFrame=i=>{W(i)};class X{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=m.querySelector("[data-reference]",SVGPathElement,this.#t),this.#e=m.querySelectorAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new X(m.getById("right",SVGGElement),t=>K(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const J=new ut;class kt{constructor(t,e,n=0,r=e-n){this.stepCount=t,this.period=e,this.#t=c.makeBoundedLinear(n,0,r,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),n;e<0?(e=0,n=0):e>=this.stepCount?(e=this.stepCount-1,n=this.period):n=t%this.period;const r=this.#t(n);return{index:e,t:r}}}class Et{constructor(t){this.pathString=t,this.samples=lt(t,xt),this.terms=ht(this.samples),this.keyframes=c.initializedArray(21,e=>e)}samples;terms;keyframes;bins(){const t=new Array;return this.keyframes.forEach((e,n,r)=>{const u=n-1;if(u>=0){const k=r[u],v=this.terms.slice(k,e);t.push(v)}}),t}get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function n(r){const{index:u,t:k}=t.get(r);return e(u,k)}return n}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],n=this.stepCount,r=h=>Math.max(...t.slice(0,h).map(S=>Math.abs(S.frequency))),u=h=>{if(h==0)return 8;{const g=r(h);return 8*Math.min(g,50)+7}},k=c.initializedArray(n,h=>{const g=e[h],S=e[h+1];if(g==0&&S==1&&t[0].frequency==0){let G=function(C){return`${P.x*C},${P.y*C}`};const P=c.assertNonNullable(U(t[0])),E=B(0,.5),L=B(0,1);return C=>{const l=L(C),s=G(l),o=E(C),a=G(o);return`M ${s} L ${a}`}}else if(g==S){const G=_(t,g),P=u(S),L=N.glitchFreeParametric(G,P).rawPath;return C=>L}else{const P=.2/Math.abs(t[g].frequency),E=c.makeBoundedLinear(0,-P,1,1+P),L=_(t,g),C=_(t,S-g,g),l=u(S);if(g==0||g==1&&U(t[0])){const s=U(t[0])??{x:0,y:0};return o=>{const a=E(o),d=a-P,x=a+P,f=B(d,x),y=Math.min(1,x);if(y<=0)return`M${s.x},${s.y} L${s.x},${s.y}`;{let w=function(F){F=F*y;const b=L(F),q=1-f(F);if(q==0)return b;{const R=C(F);return{x:b.x+q*R.x,y:b.y+q*R.y}}};const p=Math.ceil(Math.max(l,150)*y);return N.glitchFreeParametric(w,p).rawPath}}}else return s=>{const o=E(s),a=B(o-P,o+P);function d(f){const y=L(f),w=1-a(f);if(w==0)return y;{const p=C(f);return{x:y.x+w*p.x,y:y.y+w*p.y}}}return N.glitchFreeParametric(d,l).rawPath}}});function v(h,g){const S=k[h];return S(g)}return v}}class ${hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#r,this.#s),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#a),this.#t(t)}timer;#n;#e;#r;#s;#a;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#r=t.referenceColor,this.#s=t.liveColor,J.d=this.#n,this.#a=this.#e.getTransform(J.getBBox()),this.timer=new kt(t.base.stepCount,$.PERIOD,$.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=n=>{const r=e(n);this.#e.setLivePath(r)}}}function bt(...i){W=t=>{i.forEach(e=>e.show(t))}}let H;setTimeout(()=>{if(Z)return;let i=NaN;H=new m.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;W(e)}),window.animationLoop=H},1);function vt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),H?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:69,devicePixelRatio}}window.initScreenCapture=vt;class Ct{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class M{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=c.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,n)=>{const r=e.other(t);return r===void 0||this.pathSoFar.length==1&&r!=1?[]:new M([...this.pathSoFar,r],this.remainingEdges.toSpliced(n,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(r=>Math.max(r.vertex1,r.vertex2)))+1,n=new Set;for(const r of this.get(t)){const u=r.slice(0,r.length-1),k=this.#n(u);if(!n.has(k)){yield r,n.add(k);const v=this.#e(u,e).map(h=>this.#n(h));for(const h of v)n.add(h)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const n=new Array;for(let r=1;r<t.length;r++){const u=t[r],k=(u+1)%e,v=I(t,r+1);k==v?n.push(c.initializedArray(t.length,h=>{const g=I(t,h+r);return c.positiveModulo(g-u,e)})):I(t,r-1)==k&&n.push(c.initializedArray(t.length,g=>{const S=I(t,r-g);return c.positiveModulo(S-u,e)}))}return n}static getSamples(){function t(e,...n){return c.initializedArray(e,r=>n.map(u=>new Ct(r,(r+u)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=M;function Ft(){const i=M.getSamples(),t=M.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}Ft();{let i=function(l,s,o){const a=s-l,d=o-l,x=2*l,f=2*l;return{x:a,y:d,width:x,height:f}};class t{constructor(s){throw new Error("wtf")}static points=c.initializedArray(5,s=>{const o=c.FULL_CIRCLE*s/5+c.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...M.getUnique(M.getSamples().pentagram)]}class e{constructor(s){throw new Error("wtf")}static points=c.initializedArray(6,s=>{const o=c.FULL_CIRCLE*s/6+c.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...M.getUnique(M.getSamples().dodecahedron)];static makePathShape(s){const o=this.allPaths[s],a=dt.M(n[0].x,n[0].y);return o.forEach((d,x)=>{if(x==0){if(d!=0)throw new Error("wtf")}else{const{x:f,y}=n[d],w=o[x-1];switch(c.positiveModulo(d-w,6)){case 1:{a.arc(0,0,f,y,"cw");break}case 2:case 4:{a.L(f,y);break}case 5:{a.arc(0,0,f,y,"ccw");break}default:throw new Error("wtf")}}}),a.pathShape}}const n=e.points,r=e.allPaths,u=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],k=c.Random.fromString("fourier-smackdown.ts");c.initializedArray(r.length,()=>{const l=k()*3|0,s=u[l];return u.splice(l,1),u.push(s),s});let v=64;const h=9/4,g=.65,S=[{color:"n/a",destRect:i(2,11.5,2.5),index:v},{color:"n/a",destRect:i(2,4.5,6.6),index:v}],G={radius:h*g,cx:[h,(h+16/2)/2,16/2,(16-h+16/2)/2,16-h],cy:[9-2.75*h,2.75*h]};console.log(G);const P=S.map(({index:l})=>{const s=e.makePathShape(l).rawPath;return new Et(s)});P.forEach(({terms:l,keyframes:s},o)=>{const a=l.length,d=[],x=7;for(;d.length<x-1;){let p;d.length<6?p=1:p=3;const V=l.splice(0,p);if(V.length!=p)throw new Error("wtf");d.push(V)}const f=[],y=[];d.forEach((p,V)=>{V%3<2?f.push(p):y.unshift(p)});const w=[...f,[...l],...y];if(w.length!=x)throw new Error("wtf");if(console.log(w),l.length=0,s.length=0,s.push(0),w.forEach((p,V,F)=>{l.push(...p),s.push(l.length)}),l.length!=a)throw new Error("wtf")}),console.log(P);const E=new Array,L=m.querySelector("g#foreground",SVGGElement);m.getById("chapterList",SVGTextElement);const C=[{light:"Magenta",dark:"black"},{light:"Magenta",dark:"black"},{light:"HotPink",dark:"red"},{light:"white",dark:"gray"},{light:"var(--blue)",dark:"blue"},{light:"orange",dark:"darkOrange"},{light:"Fuchsia ",dark:"DarkViolet"}];S.length-1;for(const[l,s,{light:o,dark:a},d]of c.zip(S,P,C,c.count())){const{destRect:x,search:f}=l,y=f===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):m.querySelector(`g.frequencies[data-frequencies="${f}"]`,SVGGElement),w=f===void 0?L.appendChild(c.assertClass(m.querySelector("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):m.querySelector(`[data-fourier-top="${f}"]`,SVGGElement);w.style.setProperty("--color",o),w.style.setProperty("--blur-color",a);const p=new X(w,b=>K(b,x,"srcRect fits completely into destRect"));w.dataset.liveIndex=d.toString(),y.style.fill=a;const V={base:s,destination:p,liveColor:a,referenceColor:o},F=new $(V);E.push(F),console.log(F)}{let l=function(){a.reset(),a.fillStyle="cyan",a.fillRect(0,0,o.width,o.height)},s=function(A){Y.currentTime=A;function O(T){const rt=c.assertNonNullable(T.getAttribute("d")),st=new Path2D(rt),z=getComputedStyle(T),at=z.strokeWidth,ot=c.assertNonNullable(c.parseFloatX(/^(.*)px$/.exec(at)[1]));a.lineWidth=ot,a.lineCap=z.strokeLinecap,a.lineJoin=z.strokeLinejoin;const it=mt(T,w),ct=y.multiply(it);a.setTransform(ct),a.stroke(st)}l(),a.strokeStyle="white",a.filter="url(#anti-anti-alias)",O(j),a.strokeStyle="black",a.filter="url(#checkerboard-alpha)",V.forEach(T=>{O(T)}),a.strokeStyle="magenta",a.filter="url(#anti-anti-alias)",p.forEach(T=>{O(T)})};const o=m.getById("cga",HTMLCanvasElement),a=o.getContext("2d"),d={x:2,y:0,width:12,height:9},x={x:0,y:0,width:o.width,height:o.height},f=ft(d,x),y=new DOMMatrix(f.transformString),w=m.getById("main",SVGSVGElement),p=m.querySelectorAll("[data-live-index] path.main",SVGPathElement),V=m.querySelectorAll("[data-live-index] path.offset-blur",SVGPathElement),F=pt(yt,2),b=new wt(F),q=[];q.push(...b.addText("Party","left")),b.carriageReturn(),b.lineFeed(),q.push(...b.addText(" like it’s")),b.carriageReturn(),b.lineFeed(),q.push(...b.addText("  1983."));const R=1,tt=2.2;let et=N.join(q.map(A=>({shape:A.description.shape,Δx:A.x+tt,Δy:A.baseline+R})));const nt=m.getById("line-text",SVGGElement),j=et.makeElement(!1);nt.append(j);const Y=o.animate([{clipPath:"rect(0% 100% 100% 0%)",offset:0},{clipPath:"rect(0% 100% 100% 100%)",offset:.5},{clipPath:"rect(0% 0% 100% 0%)",offset:.5},{clipPath:"rect(0% 100% 100% 0%)",offset:1}],{duration:9897,iterations:1/0});Y.pause(),E.push({show:s})}if(console.log(E),bt(...E),D.get("thumbnail")=="1"){Z=!0;const l=new Array;Array.from(L.children).forEach(s=>{const o=c.assertClass(s,SVGElement);o.dataset.live===void 0?o.style.display="none":(console.log("live",o.dataset.live),l.push(o))}),E[0].show(14e3),E[1].show(28e3),E[2].show(42e3),window.showFrame=s=>{console.info(`ignoring showFrame(${s})`)},m.querySelectorAll("[data-reference]",SVGPathElement).forEach(s=>s.style.display="none"),m.querySelectorAll("#new-starfield circle",SVGCircleElement).forEach(s=>{s.style.transform="scale(3)",s.style.transformOrigin=`${s.cx.baseVal.value}px ${s.cy.baseVal.value}px`})}}
