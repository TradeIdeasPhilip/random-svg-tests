import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as f}from"./client-misc-B8CxQsfg.js";import{b as H,s as D,h as B,t as _}from"./fourier-shared-DpvWsPe-.js";import{p as O,d as K,b as Z,P as $}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as T,e as J}from"./utility-Dgy6CMn3.js";function W(){document.body.style.backgroundColor="transparent",f.selectorQueryAll("[data-hide-background]",SVGElement).forEach(c=>c.style.display="none")}function X(){const c=f.selectorQuery("[data-hide-background]",SVGElement);c.parentElement?.append(c)}const N=new URLSearchParams(window.location.search);let j=!1;N.get("hide_background")=="1"?W():N.get("only_background")=="1"&&X();{const t=f.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const Y=1024;class tt{constructor(t,e){this.terms=e,t instanceof SVGGElement||(t=f.selectorQuery(t,SVGGElement)),this.#t=f.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(r=>{const s=f.selectorQuery("text",SVGTextElement,r),h=document.createElementNS("http://www.w3.org/2000/svg","text");return h.classList.add("background"),r.insertBefore(h,s),{top:r,spinner:f.selectorQuery(".spinner",SVGPolygonElement,r),text:s,background:h}})}#t;show(t,e){this.#t.forEach((r,s)=>{if(s>=t)r.top.style.display="none";else{r.top.style.display="";const h=this.terms[s];r.background.innerHTML=r.text.innerHTML=h.frequency.toString(),r.spinner.style.transform=`rotate(${e*h.frequency+h.phase+a.FULL_CIRCLE/4}rad)`}})}}function q(c,t){if(c>=t)throw new Error("wtf");const e=a.makeLinear(c,0,t,1);function r(s){if(s<=c)return 0;if(s>=t)return 1;const h=e(s);return J(h)}return r}let Q=()=>{};window.showFrame=c=>{Q(c)};class U{constructor(t,e){this.getTransform=e,this.#t=f.selectorQuery(t,SVGGElement),this.#n=f.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=f.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new U("#right",t=>O(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const z=new K;class et{constructor(t){this.pathString=t,this.samples=H(t,Y),this.terms=D(this.samples),this.keyframes=a.initializedArray(21,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t,e=0,r=t-e){const s=this.makeGetPath2(),h=a.makeBoundedLinear(e,0,r,1),S=this.stepCount;function F(m){let l=Math.floor(m/t),o;l<0?(l=0,o=0):l>=S?(l=S-1,o=t):o=m%t;const u=h(o);return{pathString:s(l,u),index:l,t:u}}return F}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],r=this.stepCount,s=m=>Math.max(...t.slice(0,m).map(o=>Math.abs(o.frequency))),h=m=>{const l=s(m);return 8*Math.min(l,50)+7},S=a.initializedArray(r,m=>{const l=e[m],o=e[m+1];if(l==0&&o==1&&t[0].frequency==0){let u=function(g){return`${n.x*g},${n.y*g}`};const n=a.assertNonNullable(B(t[0])),i=q(0,.5),d=q(0,1);return g=>{const w=d(g),p=u(w),C=i(g),E=u(C);return`M ${p} L ${E}`}}else{const n=.2/Math.abs(t[l].frequency),i=a.makeBoundedLinear(0,-n,1,1+n),d=_(t,l),g=_(t,o-l,l),w=h(o);if(l==0||l==1&&B(t[0])){const p=B(t[0])??{x:0,y:0};return C=>{const E=i(C),b=E-n,V=E+n,G=q(b,V),y=Math.min(1,V);if(y<=0)return`M${p.x},${p.y} L${p.x},${p.y}`;{let x=function(L){L=L*y;const R=d(L),M=1-G(L);if(M==0)return R;{const A=g(L);return{x:R.x+M*A.x,y:R.y+M*A.y}}};const k=Math.ceil(Math.max(w,150)*y);return $.glitchFreeParametric(x,k).rawPath}}}else return p=>{const C=i(p),E=q(C-n,C+n);function b(G){const y=d(G),x=1-E(G);if(x==0)return y;{const k=g(G);return{x:y.x+x*k.x,y:y.y+x*k.y}}}return $.glitchFreeParametric(b,w).rawPath}}});function F(m,l){const o=S[m];return o(l)}return F}}class nt{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}endTime;#n;#e;#s;#r;#o;constructor(t,e){this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,z.d=this.#n,this.#o=this.#e.getTransform(z.getBBox());const r=7500,s=750;this.endTime=r*t.base.stepCount;const h=t.base.makeGetPath1(r,0,r-s),S=new tt(e,t.base.terms);this.#t=F=>{const{pathString:m,index:l,t:o}=h(F);this.#e.setLivePath(m),S.show(t.base.keyframes[l+1],o*a.FULL_CIRCLE)}}}function st(...c){Q=t=>{c.forEach(e=>e.show(t))}}let I;setTimeout(()=>{if(j)return;let c=NaN;I=new f.AnimationLoop(t=>{isNaN(c)&&(c=t);const e=t-c;Q(e)}),window.animationLoop=I},1);function rt(c){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),I?.cancel(),{source:"fourier-smackdown.ts",script:c,seconds:95,devicePixelRatio}}window.initScreenCapture=rt;class ot{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class P{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,r)=>{const s=e.other(t);return s===void 0||this.pathSoFar.length==1&&s!=1?[]:new P([...this.pathSoFar,s],this.remainingEdges.toSpliced(r,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(s=>Math.max(s.vertex1,s.vertex2)))+1,r=new Set;for(const s of this.get(t)){const h=s.slice(0,s.length-1),S=this.#n(h);if(!r.has(S)){yield s,r.add(S);const F=this.#e(h,e).map(m=>this.#n(m));for(const m of F)r.add(m)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const r=new Array;for(let s=1;s<t.length;s++){const h=t[s],S=(h+1)%e,F=T(t,s+1);S==F?r.push(a.initializedArray(t.length,m=>{const l=T(t,m+s);return a.positiveModulo(l-h,e)})):T(t,s-1)==S&&r.push(a.initializedArray(t.length,l=>{const o=T(t,s-l);return a.positiveModulo(o-h,e)}))}return r}static getSamples(){function t(e,...r){return a.initializedArray(e,s=>r.map(h=>new ot(s,(s+h)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=P;function at(){const c=P.getSamples(),t=P.getUnique(c.pentagram);console.log(t,t.constructor.name);for(const e of t);}at();{let c=function(o,u=0){const n=[],i=o.terms,d=i.length,g=7,w=10,p=i.splice(5,3),C=p.splice(u,1);for(n.push(p);n.length<w-2;){let b;n.length<6?b=1:(n.length<9,b=2);const V=i.splice(0,b);if(V.length!=b)throw new Error("wtf");n.push(V)}if(n.splice(g,0,[...i]),n.push(C),console.log(n),n.length!=w)throw new Error("wtf");if(i.length=0,i.length!=0)throw new Error("wtf");const E=o.keyframes;if(E.length=0,E.push(0),n.forEach(b=>{i.push(...b),E.push(i.length)}),i.length!=d)throw new Error("wtf")};class t{constructor(u){throw new Error("wtf")}static points=a.initializedArray(5,u=>{const n=a.FULL_CIRCLE*u/5+a.FULL_CIRCLE/4,i=Math.cos(n),d=Math.sin(n);return{x:i,y:d}});static allPaths=[...P.getUnique(P.getSamples().pentagram)]}class e{constructor(u){throw new Error("wtf")}static points=a.initializedArray(6,u=>{const n=a.FULL_CIRCLE*u/6+a.FULL_CIRCLE/4,i=Math.cos(n),d=Math.sin(n);return{x:i,y:d}});static allPaths=[...P.getUnique(P.getSamples().dodecahedron)];static makePathShape(u){const n=this.allPaths[u],i=Z.M(r[0].x,r[0].y);return n.forEach((d,g)=>{if(g==0){if(d!=0)throw new Error("wtf")}else{const{x:w,y:p}=r[d],C=n[g-1];switch(a.positiveModulo(d-C,6)){case 1:{i.arc(0,0,w,p,"cw");break}case 2:case 4:{i.L(w,p);break}case 5:{i.arc(0,0,w,p,"ccw");break}default:throw new Error("wtf")}}}),i.pathShape}}const r=e.points,s=e.allPaths,h=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],S=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(s.length,()=>{const o=S()*3|0,u=h[o];return h.splice(o,1),h.push(u),u});const F=[{color:"#black",destRect:{x:.5,y:.5,width:5,height:5},index:35,colorName:"red"},{color:"black",destRect:{x:5.5,y:3.5,width:5,height:5},index:35,colorName:"white"},{color:"black",destRect:{x:10.5,y:.5,width:5,height:5},index:35,colorName:"blue"}],m=F.map(({index:o})=>{const u=e.makePathShape(o).rawPath;return new et(u)});console.log(m),c(m[0],0),c(m[1],1),c(m[2],2);const l=new Array;for(const[o,u]of a.zip(F,m)){const{color:n,destRect:i}=o,d=o.colorName??o.color,g=f.selectorQuery(`g.frequencies[data-frequencies="${d}"]`,SVGGElement),w=new U(`[data-fourier-top="${d}"]`,E=>O(E,i,"srcRect fits completely into destRect"));g.style.fill=n;const p={base:u,destination:w,liveColor:n,referenceColor:n},C=new nt(p,g);l.push(C),console.log(C)}{let o=function(y,x){const v=[y,y+a.FULL_CIRCLE/3,y-a.FULL_CIRCLE/3].map(A=>V(Math.sin(A)));v.push(0),v.push(G(Math.cos(x)));const L=v.join(" "),M=[L,L,L,"0 0 0 0 1"].join(`
`);i.setAttribute("values",M)},u=function(y){const x=d.map(k=>[]);y.forEach(k=>{if(k.length!=d.length)throw new Error("wtf");k.forEach((v,L)=>{x[L].push(v)})});for(const[k,v]of a.zip(d,x))k.setAttribute("tableValues",v.join(" "))},n=function(y){const x=y/24e4*a.FULL_CIRCLE*2,k=y/24e4*a.FULL_CIRCLE/2;o(x,k)};const i=f.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),d=[f.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),f.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),f.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],E=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),b=a.makeLinear(0,0,255,1);E.forEach(y=>y.forEach((x,k,v)=>v[k]=b(x)));const V=a.makeLinear(-1,-.05,1,.8),G=a.makeLinear(1,0,-1,-.4);window.updateValues=o,u(E),l.push({show:n})}if(console.log(l),st(...l),N.get("thumbnail")=="1"){const o=f.selectorQuery("g#foreground",SVGGElement);j=!0;const u=new Array;Array.from(o.children).forEach(n=>{const i=a.assertClass(n,SVGElement);i.dataset.live===void 0?i.style.display="none":(console.log("live",i.dataset.live),u.push(i))}),Q(14950),l[0].show(7450),f.selectorQueryAll("[data-reference]",SVGPathElement).forEach(n=>n.style.display="none"),f.selectorQueryAll("[data-fourier-top]",SVGGElement,3,3).forEach((n,i)=>{const d=getComputedStyle(n).transform,g=["-0.05px, -0.05px","-0.3px, 0px","-0.1px, 0px"],w=[3,1.5,1.5][i];n.style.transform=`${d} scale(${w}) translate(${g[i]})`}),window.showFrame=n=>{console.info("ignoring showFrame()",n)}}}{const c=a.Random.fromString("Starry Night"),t=f.selectorQuery("[data-favorite]",SVGCircleElement),e=a.makeLinear(0,.025,2,.1);for(let r=0;r<100;r++){const s=a.assertClass(t.cloneNode(!0),SVGCircleElement);s.cx.baseVal.value=c()*16,s.cy.baseVal.value=c()*9,s.r.baseVal.value=e(c()+c()),t.parentElement.append(s)}}
