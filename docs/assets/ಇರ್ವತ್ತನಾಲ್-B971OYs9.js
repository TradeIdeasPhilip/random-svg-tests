import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as m}from"./client-misc-B8CxQsfg.js";import{b as Y,s as tt,h as U,t as _}from"./fourier-shared-yVHHVzl_.js";import{p as X,d as et,b as nt,e as N,P as O}from"./path-shape-Cey3Rpwf.js";import{m as o}from"./misc-BHUyxQfl.js";import{g as B,e as st}from"./utility-Dgy6CMn3.js";function rt(){document.body.style.backgroundColor="transparent",m.selectorQueryAll("[data-hide-background]",SVGElement).forEach(c=>c.style.display="none")}function ot(){const c=m.selectorQuery("[data-hide-background]",SVGElement);c.parentElement?.append(c)}{const c=o.Random.fromString("Pastel 41"),t=m.selectorQuery("[data-favorite]",SVGCircleElement),e=o.makeLinear(0,.025,2,.15);for(let r=0;r<150;r++){const n=o.assertClass(t.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=c()*16,n.cy.baseVal.value=c()*9,n.r.baseVal.value=e(c()+c()),t.parentElement.append(n)}}const z=new URLSearchParams(window.location.search);let J=!1;z.get("hide_background")=="1"?rt():z.get("only_background")=="1"&&ot();{const t=m.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const at=1024;class it{#t;constructor(t){t instanceof SVGGElement||(t=m.selectorQuery(t,SVGGElement)),this.#t=m.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(e=>{const r=m.selectorQuery("text",SVGTextElement,e),n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.classList.add("background"),e.insertBefore(n,r),{top:e,spinner:m.selectorQuery(".spinner",SVGPolygonElement,e),text:r,background:n}})}show(t,e){this.#t.forEach((r,n,g)=>{if(n>=t.length)r.top.style.display="none";else{r.top.style.display="";const k=t[n];let F=k.frequency.toString();n==g.length-1&&g.length<t.length&&(F+=", â€¦"),r.background.innerHTML=r.text.innerHTML=F,r.spinner.style.transform=`rotate(${e*k.frequency+k.phase+o.FULL_CIRCLE/4}rad)`}})}}function Q(c,t){if(c>=t)throw new Error("wtf");const e=o.makeLinear(c,0,t,1);function r(n){if(n<=c)return 0;if(n>=t)return 1;const g=e(n);return st(g)}return r}let D=()=>{};window.showFrame=c=>{D(c)};class j{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=m.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=m.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new j(m.getById("right",SVGGElement),t=>X(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const K=new et;class ct{constructor(t,e,r=0,n=e-r){this.stepCount=t,this.period=e,this.#t=o.makeBoundedLinear(r,0,n,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),r;e<0?(e=0,r=0):e>=this.stepCount?(e=this.stepCount-1,r=this.period):r=t%this.period;const n=this.#t(r);return{index:e,t:n}}}class lt{constructor(t){this.pathString=t,this.samples=Y(t,at),this.terms=tt(this.samples),this.keyframes=o.initializedArray(21,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function r(n){const{index:g,t:k}=t.get(n);return e(g,k)}return r}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],r=this.stepCount,n=d=>Math.max(...t.slice(0,d).map(P=>Math.abs(P.frequency))),g=d=>{if(d==0)return 8;{const p=n(d);return 8*Math.min(p,50)+7}},k=o.initializedArray(r,d=>{const p=e[d],P=e[d+1];if(p==0&&P==1&&t[0].frequency==0){let G=function(s){return`${S.x*s},${S.y*s}`};const S=o.assertNonNullable(U(t[0])),M=Q(0,.5),i=Q(0,1);return s=>{const a=i(s),h=G(a),l=M(s),w=G(l);return`M ${h} L ${w}`}}else if(p==P){const G=_(t,p),S=g(P),i=O.glitchFreeParametric(G,S).rawPath;return s=>i}else{const S=.2/Math.abs(t[p].frequency),M=o.makeBoundedLinear(0,-S,1,1+S),i=_(t,p),s=_(t,P-p,p),a=g(P);if(p==0||p==1&&U(t[0])){const h=U(t[0])??{x:0,y:0};return l=>{const w=M(l),y=w-S,b=w+S,f=Q(y,b),u=Math.min(1,b);if(u<=0)return`M${h.x},${h.y} L${h.x},${h.y}`;{let C=function(x){x=x*u;const V=i(x),L=1-f(x);if(L==0)return V;{const E=s(x);return{x:V.x+L*E.x,y:V.y+L*E.y}}};const v=Math.ceil(Math.max(a,150)*u);return O.glitchFreeParametric(C,v).rawPath}}}else return h=>{const l=M(h),w=Q(l-S,l+S);function y(f){const u=i(f),C=1-w(f);if(C==0)return u;{const v=s(f);return{x:u.x+C*v.x,y:u.y+C*v.y}}}return O.glitchFreeParametric(y,a).rawPath}}});function F(d,p){const P=k[d];return P(p)}return F}}class R{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}timer;#n;#e;#s;#r;#o;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,K.d=this.#n,this.#o=this.#e.getTransform(K.getBBox()),this.timer=new ct(t.base.stepCount,R.PERIOD,R.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=r=>{const n=e(r);this.#e.setLivePath(n)}}}function ht(...c){D=t=>{c.forEach(e=>e.show(t))}}let $;setTimeout(()=>{if(J)return;let c=NaN;$=new m.AnimationLoop(t=>{isNaN(c)&&(c=t);const e=t-c;D(e)}),window.animationLoop=$},1);function ut(c){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),$?.cancel(),{source:"fourier-smackdown.ts",script:c,seconds:118,devicePixelRatio}}window.initScreenCapture=ut;class dt{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class A{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=o.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,r)=>{const n=e.other(t);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new A([...this.pathSoFar,n],this.remainingEdges.toSpliced(r,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(n=>Math.max(n.vertex1,n.vertex2)))+1,r=new Set;for(const n of this.get(t)){const g=n.slice(0,n.length-1),k=this.#n(g);if(!r.has(k)){yield n,r.add(k);const F=this.#e(g,e).map(d=>this.#n(d));for(const d of F)r.add(d)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const r=new Array;for(let n=1;n<t.length;n++){const g=t[n],k=(g+1)%e,F=B(t,n+1);k==F?r.push(o.initializedArray(t.length,d=>{const p=B(t,d+n);return o.positiveModulo(p-g,e)})):B(t,n-1)==k&&r.push(o.initializedArray(t.length,p=>{const P=B(t,n-p);return o.positiveModulo(P-g,e)}))}return r}static getSamples(){function t(e,...r){return o.initializedArray(e,n=>r.map(g=>new dt(n,(n+g)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=A;function ft(){const c=A.getSamples(),t=A.getUnique(c.pentagram);console.log(t,t.constructor.name);for(const e of t);}ft();{let c=function(i,s,a){const h=s-i,l=a-i,w=2*i,y=2*i;return{x:h,y:l,width:w,height:y}};class t{constructor(s){throw new Error("wtf")}static points=o.initializedArray(5,s=>{const a=o.FULL_CIRCLE*s/5+o.FULL_CIRCLE/4,h=Math.cos(a),l=Math.sin(a);return{x:h,y:l}});static allPaths=[...A.getUnique(A.getSamples().pentagram)]}class e{constructor(s){throw new Error("wtf")}static points=o.initializedArray(6,s=>{const a=o.FULL_CIRCLE*s/6+o.FULL_CIRCLE/4,h=Math.cos(a),l=Math.sin(a);return{x:h,y:l}});static allPaths=[...A.getUnique(A.getSamples().dodecahedron)];static makePathShape(s){const a=this.allPaths[s],h=nt.M(r[0].x,r[0].y);return a.forEach((l,w)=>{if(w==0){if(l!=0)throw new Error("wtf")}else{const{x:y,y:b}=r[l],f=a[w-1];switch(o.positiveModulo(l-f,6)){case 1:{h.arc(0,0,y,b,"cw");break}case 2:case 4:{h.L(y,b);break}case 5:{h.arc(0,0,y,b,"ccw");break}default:throw new Error("wtf")}}}),h.pathShape}}const r=e.points,n=e.allPaths,g=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],k=o.Random.fromString("fourier-smackdown.ts");o.initializedArray(n.length,()=>{const i=k()*3|0,s=g[i];return g.splice(i,1),g.push(s),s});let F=54;const d=9/4,p=.8,P=[{color:"n/a",destRect:c(d*p,d,d),index:F},{color:"n/a",destRect:c(d*p,3*d,d),index:F},{color:"n/a",destRect:c(7/2*p,16-7/2,9/2),index:F},{color:"n/a",destRect:c(d*p,3*d,3*d),index:F},{color:"n/a",destRect:c(d*p,d,3*d),index:F}],G=P.map(({index:i})=>{const s=e.makePathShape(i).rawPath;return new lt(s)});G.forEach(({terms:i,keyframes:s},a)=>{const h=i.length,l=[],w=10;for(;l.length<w-1;){let u;l.length<6?u=1:u=2;const C=i.splice(0,u);if(C.length!=u)throw new Error("wtf");l.push(C)}const y=[],b=[];l.forEach((u,C)=>{C%3<2?y.push(u):b.unshift(u)});const f=[...y,[...i],...b];if(f.length!=w)throw new Error("wtf");if(f.splice(0,0,...o.initializedArray(a,()=>[])),f.splice(Number.MAX_SAFE_INTEGER,0,...o.initializedArray(4-a,()=>[])),console.log(f),i.length=0,s.length=0,s.push(0),f.forEach((u,C,v)=>{i.push(...u),s.push(i.length)}),i.length!=h)throw new Error("wtf")}),console.log(G);const S=new Array,M=m.selectorQuery("g#foreground",SVGGElement);m.getById("chapterList",SVGTextElement),P.length-1;for(const[i,s,{light:a,dark:h},l]of o.zip(P,G,g,o.count())){const{destRect:w,search:y}=i,b=y===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):m.selectorQuery(`g.frequencies[data-frequencies="${y}"]`,SVGGElement),f=y===void 0?M.appendChild(o.assertClass(m.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):m.selectorQuery(`[data-fourier-top="${y}"]`,SVGGElement);f.style.setProperty("--color",a),f.style.setProperty("--blur-color",h);const u=new j(f,T=>X(T,w,"srcRect fits completely into destRect"));f.dataset.liveIndex=l.toString(),b.style.fill=h;const C={base:s,destination:u,liveColor:h,referenceColor:a},v=new R(C);S.push(v),console.log(v)}{let i=function(b){const{index:f,t:u}=h.get(b);u>=1?s.show([],0):s.show(l[f],u*o.FULL_CIRCLE)};const s=new it('[data-frequencies="red"]'),a=o.assertClass(S.at(2),R),h=a.timer,l=new Array,{keyframes:w,terms:y}=a.base;w.forEach((b,f)=>{const u=f-1;if(u>=0){const C=w[u],v=y.slice(C,b);l.push(v)}}),console.log(l),S.push({show:i})}{let i=function(W){q.currentTime=W};const a=m.getById("main",SVGSVGElement).viewBox.baseVal,h=N(a,a,"srcRect fits completely into destRect"),l=P[0].destRect,w=P[1].destRect,y=w.x+w.width+l.x,b={...l,x:0,width:y},f=N(b,a,"srcRect fits completely into destRect"),C={...P[4].destRect,x:0,width:y},v=N(C,a,"srcRect fits completely into destRect"),T=0,x=2*R.PERIOD,V=x+R.PAUSE,E=o.assertClass(S[0],R).timer.endTime,I=E-2*R.PERIOD,Z=I-R.PAUSE;console.log({initialTransform:f,middleTransform:h,finalTransform:v,initialSrcRect:b,finalSrcRect:C});const q=m.getById("panAndZoomMe",SVGGElement).animate([{offset:T/E,transform:f,easing:"ease"},{offset:x/E,transform:f,easing:"ease"},{offset:V/E,transform:h,easing:"ease"},{offset:Z/E,transform:h,easing:"ease"},{offset:I/E,transform:v,easing:"ease"},{offset:E/E,transform:v,easing:"ease"}],{duration:E,fill:"both"});q.pause(),S.push({show:i})}{let i=function(x,V){const E=[x,x+o.FULL_CIRCLE/3,x-o.FULL_CIRCLE/3].map(q=>v(Math.sin(q)));E.push(0),E.push(T(Math.cos(V)));const I=E.join(" "),H=[I,I,I,"0 0 0 0 1"].join(`
`);h.setAttribute("values",H)},s=function(x){const V=l.map(L=>[]);x.forEach(L=>{if(L.length!=l.length)throw new Error("wtf");L.forEach((E,I)=>{V[I].push(E)})});for(const[L,E]of o.zip(l,V))L.setAttribute("tableValues",E.join(" "))},a=function(x){const V=x/24e4*o.FULL_CIRCLE*2,L=x/24e4*o.FULL_CIRCLE/2;i(V,L)};const h=m.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),l=[m.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),m.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),m.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],u=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),C=o.makeLinear(0,0,255,1);u.forEach(x=>x.forEach((V,L,E)=>E[L]=C(V)));const v=o.makeLinear(-1,-.05,1,.8),T=o.makeLinear(1,0,-1,-.4);window.updateValues=i,s(u),S.push({show:a})}if(console.log(S),ht(...S),z.get("thumbnail")=="1"){J=!0;const i=new Array;Array.from(M.children).forEach(s=>{const a=o.assertClass(s,SVGElement);a.dataset.live===void 0?a.style.display="none":(console.log("live",a.dataset.live),i.push(a))}),S.forEach((s,a)=>{s.show(8500+950*a)}),m.selectorQueryAll("[data-reference]",SVGPathElement).forEach(s=>s.style.display="none"),m.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(s=>{s.style.transform="scale(3)",s.style.transformOrigin=`${s.cx.baseVal.value}px ${s.cy.baseVal.value}px`})}}
