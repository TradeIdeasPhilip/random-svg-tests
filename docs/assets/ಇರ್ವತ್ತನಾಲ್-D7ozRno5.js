import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as m}from"./client-misc-B8CxQsfg.js";import{b as lt,s as ht,h as z,t as U}from"./fourier-shared-BtRQghVL.js";import{p as J,d as ut,b as dt,r as ft,P as N,e as mt}from"./path-shape-DRm3ZWo5.js";import{m as c}from"./misc-BHUyxQfl.js";import{g as B,f as gt}from"./utility-DRmoXCRu.js";import{r as pt}from"./letters-base-DBBBqRHI.js";import{r as yt}from"./hershey-fonts-DyiAW2LT.js";import{T as wt}from"./letters-more-DR6DBSZL.js";function St(){document.body.style.backgroundColor="transparent",m.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function Pt(){const i=m.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}{const i=c.Random.fromString("Pastel 41"),t=m.selectorQuery("[data-favorite]",SVGCircleElement),e=c.makeLinear(0,.025,2,.15);for(let n=0;n<150;n++){const s=c.assertClass(t.cloneNode(!0),SVGCircleElement);s.cx.baseVal.value=i()*16,s.cy.baseVal.value=i()*9,s.r.baseVal.value=e(i()+i()),t.parentElement.append(s)}}const _=new URLSearchParams(window.location.search);let K=!1;_.get("hide_background")=="1"?St():_.get("only_background")=="1"&&Pt();{const t=m.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const xt=1024;class Z{static#t=m.selectorQuery("[data-motion-blur-spinners]",HTMLDivElement);#n;constructor(t={radius:1,centerX:2,centerY:2}){const e=document.createElement("div");e.classList.add("motion-blur-spinner"),Z.#t.append(e);const n=this.#n=e.style;n.setProperty("--radius",t.radius.toString()),n.setProperty("--center-x",t.centerX.toString()),n.setProperty("--center-y",t.centerY.toString()),t.color&&n.setProperty("--color",t.color),this.hide()}#e;showRadians(t){const e=this.#e??t;this.#e=t;const n=this.#n;n.display="",n.setProperty("--main-angle",`${t}rad`),n.setProperty("--blur-angle",`${e}rad`)}hide(){this.#e=void 0,this.#n.display="none"}}function q(i,t){if(i>=t)throw new Error("wtf");const e=c.makeLinear(i,0,t,1);function n(s){if(s<=i)return 0;if(s>=t)return 1;const u=e(s);return gt(u)}return n}let H=()=>{};window.showFrame=i=>{H(i)};class W{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=m.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=m.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new W(m.getById("right",SVGGElement),t=>J(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const Y=new ut;class kt{constructor(t,e,n=0,s=e-n){this.stepCount=t,this.period=e,this.#t=c.makeBoundedLinear(n,0,s,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),n;e<0?(e=0,n=0):e>=this.stepCount?(e=this.stepCount-1,n=this.period):n=t%this.period;const s=this.#t(n);return{index:e,t:s}}}class Et{constructor(t){this.pathString=t,this.samples=lt(t,xt),this.terms=ht(this.samples),this.keyframes=c.initializedArray(21,e=>e)}samples;terms;keyframes;bins(){const t=new Array;return this.keyframes.forEach((e,n,s)=>{const u=n-1;if(u>=0){const k=s[u],v=this.terms.slice(k,e);t.push(v)}}),t}get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function n(s){const{index:u,t:k}=t.get(s);return e(u,k)}return n}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],n=this.stepCount,s=h=>Math.max(...t.slice(0,h).map(S=>Math.abs(S.frequency))),u=h=>{if(h==0)return 8;{const g=s(h);return 8*Math.min(g,50)+7}},k=c.initializedArray(n,h=>{const g=e[h],S=e[h+1];if(g==0&&S==1&&t[0].frequency==0){let G=function(C){return`${P.x*C},${P.y*C}`};const P=c.assertNonNullable(z(t[0])),E=q(0,.5),L=q(0,1);return C=>{const l=L(C),r=G(l),o=E(C),a=G(o);return`M ${r} L ${a}`}}else if(g==S){const G=U(t,g),P=u(S),L=N.glitchFreeParametric(G,P).rawPath;return C=>L}else{const P=.2/Math.abs(t[g].frequency),E=c.makeBoundedLinear(0,-P,1,1+P),L=U(t,g),C=U(t,S-g,g),l=u(S);if(g==0||g==1&&z(t[0])){const r=z(t[0])??{x:0,y:0};return o=>{const a=E(o),d=a-P,x=a+P,f=q(d,x),y=Math.min(1,x);if(y<=0)return`M${r.x},${r.y} L${r.x},${r.y}`;{let w=function(F){F=F*y;const b=L(F),T=1-f(F);if(T==0)return b;{const I=C(F);return{x:b.x+T*I.x,y:b.y+T*I.y}}};const p=Math.ceil(Math.max(l,150)*y);return N.glitchFreeParametric(w,p).rawPath}}}else return r=>{const o=E(r),a=q(o-P,o+P);function d(f){const y=L(f),w=1-a(f);if(w==0)return y;{const p=C(f);return{x:y.x+w*p.x,y:y.y+w*p.y}}}return N.glitchFreeParametric(d,l).rawPath}}});function v(h,g){const S=k[h];return S(g)}return v}}class ${hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#a),this.#t(t)}timer;#n;#e;#s;#r;#a;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,Y.d=this.#n,this.#a=this.#e.getTransform(Y.getBBox()),this.timer=new kt(t.base.stepCount,$.PERIOD,$.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=n=>{const s=e(n);this.#e.setLivePath(s)}}}function bt(...i){H=t=>{i.forEach(e=>e.show(t))}}let D;setTimeout(()=>{if(K)return;let i=NaN;D=new m.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;H(e)}),window.animationLoop=D},1);function vt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),D?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:69,devicePixelRatio}}window.initScreenCapture=vt;class Ct{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class M{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=c.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,n)=>{const s=e.other(t);return s===void 0||this.pathSoFar.length==1&&s!=1?[]:new M([...this.pathSoFar,s],this.remainingEdges.toSpliced(n,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(s=>Math.max(s.vertex1,s.vertex2)))+1,n=new Set;for(const s of this.get(t)){const u=s.slice(0,s.length-1),k=this.#n(u);if(!n.has(k)){yield s,n.add(k);const v=this.#e(u,e).map(h=>this.#n(h));for(const h of v)n.add(h)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const n=new Array;for(let s=1;s<t.length;s++){const u=t[s],k=(u+1)%e,v=B(t,s+1);k==v?n.push(c.initializedArray(t.length,h=>{const g=B(t,h+s);return c.positiveModulo(g-u,e)})):B(t,s-1)==k&&n.push(c.initializedArray(t.length,g=>{const S=B(t,s-g);return c.positiveModulo(S-u,e)}))}return n}static getSamples(){function t(e,...n){return c.initializedArray(e,s=>n.map(u=>new Ct(s,(s+u)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=M;function Ft(){const i=M.getSamples(),t=M.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}Ft();{let i=function(l,r,o){const a=r-l,d=o-l,x=2*l,f=2*l;return{x:a,y:d,width:x,height:f}};class t{constructor(r){throw new Error("wtf")}static points=c.initializedArray(5,r=>{const o=c.FULL_CIRCLE*r/5+c.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...M.getUnique(M.getSamples().pentagram)]}class e{constructor(r){throw new Error("wtf")}static points=c.initializedArray(6,r=>{const o=c.FULL_CIRCLE*r/6+c.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...M.getUnique(M.getSamples().dodecahedron)];static makePathShape(r){const o=this.allPaths[r],a=dt.M(n[0].x,n[0].y);return o.forEach((d,x)=>{if(x==0){if(d!=0)throw new Error("wtf")}else{const{x:f,y}=n[d],w=o[x-1];switch(c.positiveModulo(d-w,6)){case 1:{a.arc(0,0,f,y,"cw");break}case 2:case 4:{a.L(f,y);break}case 5:{a.arc(0,0,f,y,"ccw");break}default:throw new Error("wtf")}}}),a.pathShape}}const n=e.points,s=e.allPaths,u=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],k=c.Random.fromString("fourier-smackdown.ts");c.initializedArray(s.length,()=>{const l=k()*3|0,r=u[l];return u.splice(l,1),u.push(r),r});let v=64;const h=9/4,g=.65,S=[{color:"n/a",destRect:i(2,11.5,2.5),index:v},{color:"n/a",destRect:i(2,4.5,6.6),index:v}],G={radius:h*g,cx:[h,(h+16/2)/2,16/2,(16-h+16/2)/2,16-h],cy:[9-2.75*h,2.75*h]};console.log(G);const P=S.map(({index:l})=>{const r=e.makePathShape(l).rawPath;return new Et(r)});P.forEach(({terms:l,keyframes:r},o)=>{const a=l.length,d=[],x=7;for(;d.length<x-1;){let p;d.length<6?p=1:p=3;const V=l.splice(0,p);if(V.length!=p)throw new Error("wtf");d.push(V)}const f=[],y=[];d.forEach((p,V)=>{V%3<2?f.push(p):y.unshift(p)});const w=[...f,[...l],...y];if(w.length!=x)throw new Error("wtf");if(console.log(w),l.length=0,r.length=0,r.push(0),w.forEach((p,V,F)=>{l.push(...p),r.push(l.length)}),l.length!=a)throw new Error("wtf")}),console.log(P);const E=new Array,L=m.selectorQuery("g#foreground",SVGGElement);m.getById("chapterList",SVGTextElement);const C=[{light:"Magenta",dark:"black"},{light:"Magenta",dark:"black"},{light:"HotPink",dark:"red"},{light:"white",dark:"gray"},{light:"var(--blue)",dark:"blue"},{light:"orange",dark:"darkOrange"},{light:"Fuchsia ",dark:"DarkViolet"}];S.length-1;for(const[l,r,{light:o,dark:a},d]of c.zip(S,P,C,c.count())){const{destRect:x,search:f}=l,y=f===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):m.selectorQuery(`g.frequencies[data-frequencies="${f}"]`,SVGGElement),w=f===void 0?L.appendChild(c.assertClass(m.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):m.selectorQuery(`[data-fourier-top="${f}"]`,SVGGElement);w.style.setProperty("--color",o),w.style.setProperty("--blur-color",a);const p=new W(w,b=>J(b,x,"srcRect fits completely into destRect"));w.dataset.liveIndex=d.toString(),y.style.fill=a;const V={base:r,destination:p,liveColor:a,referenceColor:o},F=new $(V);E.push(F),console.log(F)}{let l=function(){a.reset(),a.fillStyle="cyan",a.fillRect(0,0,o.width,o.height)},r=function(R){j.currentTime=R;function O(A){const st=c.assertNonNullable(A.getAttribute("d")),rt=new Path2D(st),Q=getComputedStyle(A),at=Q.strokeWidth,ot=c.assertNonNullable(c.parseFloatX(/^(.*)px$/.exec(at)[1]));a.lineWidth=ot,a.lineCap=Q.strokeLinecap,a.lineJoin=Q.strokeLinejoin;const it=mt(A,w),ct=y.multiply(it);a.setTransform(ct),a.stroke(rt)}l(),a.strokeStyle="white",a.filter="url(#anti-anti-alias)",O(X),a.strokeStyle="black",a.filter="url(#checkerboard-alpha)",V.forEach(A=>{O(A)}),a.strokeStyle="magenta",a.filter="url(#anti-anti-alias)",p.forEach(A=>{O(A)})};const o=m.getById("cga",HTMLCanvasElement),a=o.getContext("2d"),d={x:2,y:0,width:12,height:9},x={x:0,y:0,width:o.width,height:o.height},f=ft(d,x),y=new DOMMatrix(f.transformString),w=m.getById("main",SVGSVGElement),p=m.selectorQueryAll("[data-live-index] path.main",SVGPathElement),V=m.selectorQueryAll("[data-live-index] path.offset-blur",SVGPathElement),F=pt(yt,2),b=new wt(F),T=[];T.push(...b.addText("Party","left")),b.carriageReturn(),b.lineFeed(),T.push(...b.addText(" like it’s")),b.carriageReturn(),b.lineFeed(),T.push(...b.addText("  1983."));const I=1,tt=2.2;let et=N.join(T.map(R=>({shape:R.description.shape,Δx:R.x+tt,Δy:R.baseline+I})));const nt=m.getById("line-text",SVGGElement),X=et.makeElement(!1);nt.append(X);const j=o.animate([{clipPath:"rect(0% 100% 100% 0%)",offset:0},{clipPath:"rect(0% 100% 100% 100%)",offset:.5},{clipPath:"rect(0% 0% 100% 0%)",offset:.5},{clipPath:"rect(0% 100% 100% 0%)",offset:1}],{duration:9897,iterations:1/0});j.pause(),E.push({show:r})}if(console.log(E),bt(...E),_.get("thumbnail")=="1"){K=!0;const l=new Array;Array.from(L.children).forEach(r=>{const o=c.assertClass(r,SVGElement);o.dataset.live===void 0?o.style.display="none":(console.log("live",o.dataset.live),l.push(o))}),E[0].show(14e3),E[1].show(28e3),E[2].show(42e3),window.showFrame=r=>{console.info(`ignoring showFrame(${r})`)},m.selectorQueryAll("[data-reference]",SVGPathElement).forEach(r=>r.style.display="none"),m.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(r=>{r.style.transform="scale(3)",r.style.transformOrigin=`${r.cx.baseVal.value}px ${r.cy.baseVal.value}px`})}}
