import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as x}from"./client-misc-B8CxQsfg.js";import{b as _,s as N,g as D,t as A,h as R}from"./fourier-shared-BdjzRlL0.js";import{p as I,d as H,b as K,P as $}from"./path-shape-CZZKMsju.js";import{m as h}from"./misc-BHUyxQfl.js";import{g as M,e as Z}from"./utility-Dgy6CMn3.js";const j=1024;class J{constructor(t,s){this.terms=s,t instanceof SVGGElement||(t=x.selectorQuery(t,SVGGElement)),this.#t=x.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(a=>{const e=x.selectorQuery("text",SVGTextElement,a),r=document.createElementNS("http://www.w3.org/2000/svg","text");return r.classList.add("background"),a.insertBefore(r,e),{top:a,spinner:x.selectorQuery(".spinner",SVGPolygonElement,a),text:e,background:r}})}#t;show(t,s,a){this.#t.forEach((e,r)=>{if(r>=t+s)e.top.style.display="none";else{e.top.style.display="";const u=this.terms[r];e.background.innerHTML=e.text.innerHTML=u.frequency.toString(),e.spinner.style.transform=`rotate(${a*u.frequency+u.phase+h.FULL_CIRCLE/4}rad)`}})}}function V(l,t){if(l>=t)throw new Error("wtf");const s=h.makeLinear(l,0,t,1);function a(e){if(e<=l)return 0;if(e>=t)return 1;const r=s(e);return Z(r)}return a}let U=()=>{};window.showFrame=l=>{U(l)};class Q{constructor(t,s){this.getTransform=s,this.#t=x.selectorQuery(t,SVGGElement),this.#s=x.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=x.selectorQuery("[data-live]",SVGPathElement,this.#t)}#t;#s;#e;hide(){this.#t.style.display="none"}show(t,s){this.#t.style.display="",this.#s.style.stroke=t,this.#e.style.stroke=s}setReferencePath(t){this.#s.setAttribute("d",t)}setLivePath(t){this.#e.setAttribute("d",t)}setTransform(t){const s=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",s.toString())}static right=new Q("#right",t=>I(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const B=new H;class W{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#n,this.#r),this.#e.setReferencePath(this.#s),this.#e.setTransform(this.#i),this.#t(t)}endTime;#s;#e;#n;#r;#i;constructor(t,s){this.#s=t.pathString,this.#e=t.destination,this.#n=t.referenceColor,this.#r=t.liveColor,B.d=this.#s,this.#i=this.#e.getTransform(B.getBBox());const a=_(t.pathString,j),e=N(a),r=D({addTime:5250,pauseTime:750,maxGroupsToDisplay:t.maxGroupsToDisplay,skipCountAtEnd:t.skipCountAtEnd??0,terms:e});this.endTime=r.at(-1).endTime;const u=n=>Math.max(...e.slice(0,n).map(o=>Math.abs(o.frequency))),m=n=>8*u(n)+7,i=r.map(n=>{if(n.addingCircles==0){const c=A(e,n.usingCircles),o=m(n.usingCircles),g=$.glitchFreeParametric(c,o);return()=>g.rawPath}else if(n.usingCircles==0&&n.addingCircles==1&&e[0].frequency==0){let c=function(p){return`${f.x*p},${f.y*p}`};const{startTime:o,endTime:g}=n,y=g-o,w=V(o,o+y/2),S=V(o,g),f=R(e[0]);return p=>{const C=S(p),k=c(C),T=w(p),L=c(T);return`M ${k} L ${L}`}}else{const o=.2/u(n.usingCircles+n.addingCircles),g=h.makeBoundedLinear(n.startTime,-o,n.endTime,1+o),y=A(e,n.usingCircles),w=A(e,n.addingCircles,n.usingCircles);let S=m(n.usingCircles+n.addingCircles);if(n.usingCircles==0||n.usingCircles==1&&R(e[0])){const f=R(e[0])??{x:0,y:0};return p=>{const C=g(p),k=C-o,T=C+o,L=V(k,T),P=Math.min(1,T);if(P<=0)return`M${f.x},${f.y} L${f.x},${f.y}`;{let v=function(b){b=b*P;const q=y(b),G=1-L(b);if(G==0)return q;{const z=w(b);return{x:q.x+G*z.x,y:q.y+G*z.y}}};const E=Math.ceil(Math.max(S,150)*P);return $.glitchFreeParametric(v,E).rawPath}}}else return f=>{const p=g(f),C=V(p-o,p+o);function k(L){const P=y(L),v=1-C(L);if(v==0)return P;{const E=w(L);return{x:P.x+v*E.x,y:P.y+v*E.y}}}return $.glitchFreeParametric(k,S).rawPath}}}),d=new J(s,e);this.#t=n=>{function c(){const C=r.findIndex(({endTime:k})=>n<k);return C==-1?r.length-1:C}const o=c(),g=i[o](n);this.#e.setLivePath(g);const{usingCircles:y,addingCircles:w,startTime:S,endTime:f}=r[o],p=w>0?(n-S)/(f-S)*h.FULL_CIRCLE:0;d.show(y,w,p)}}}function X(...l){U=t=>{l.forEach(s=>s.show(t))}}let O;setTimeout(()=>{let l=NaN;O=new x.AnimationLoop(t=>{isNaN(l)&&(l=t);const s=t-l;U(s)}),window.animationLoop=O},1);function Y(l){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),O.cancel(),{source:"fourier-smackdown.ts",script:l,seconds:107,devicePixelRatio}}window.initScreenCapture=Y;class tt{constructor(t,s){this.vertex1=t,this.vertex2=s}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class F{constructor(t,s){this.pathSoFar=t,this.remainingEdges=s}oneStep(){const t=h.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((s,a)=>{const e=s.other(t);return e===void 0||this.pathSoFar.length==1&&e!=1?[]:new F([...this.pathSoFar,e],this.remainingEdges.toSpliced(a,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const s of t)yield*s.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const s=Math.max(...t.map(e=>Math.max(e.vertex1,e.vertex2)))+1,a=new Set;for(const e of this.get(t)){const r=e.slice(0,e.length-1),u=this.#s(r);if(!a.has(u)){yield e,a.add(u);const m=this.#e(r,s).map(i=>this.#s(i));for(const i of m)a.add(i)}}}static#s(t){return String.fromCharCode(...t.map(s=>s+65))}static#e(t,s){const a=new Array;for(let e=1;e<t.length;e++){const r=t[e],u=(r+1)%s,m=M(t,e+1);u==m?a.push(h.initializedArray(t.length,i=>{const d=M(t,i+e);return h.positiveModulo(d-r,s)})):M(t,e-1)==u&&a.push(h.initializedArray(t.length,d=>{const n=M(t,e-d);return h.positiveModulo(n-r,s)}))}return a}static getSamples(){function t(s,...a){return h.initializedArray(s,e=>a.map(r=>new tt(e,(e+r)%s))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=F;function et(){const l=F.getSamples(),t=F.getUnique(l.pentagram);console.log(t,t.constructor.name);for(const s of t);}et();{class l{constructor(i){throw new Error("wtf")}static points=h.initializedArray(5,i=>{const d=h.FULL_CIRCLE*i/5+h.FULL_CIRCLE/4,n=Math.cos(d),c=Math.sin(d);return{x:n,y:c}});static allPaths=[...F.getUnique(F.getSamples().pentagram)]}class t{constructor(i){throw new Error("wtf")}static points=h.initializedArray(6,i=>{const d=h.FULL_CIRCLE*i/6+h.FULL_CIRCLE/4,n=Math.cos(d),c=Math.sin(d);return{x:n,y:c}});static allPaths=[...F.getUnique(F.getSamples().dodecahedron)];static makePathShape(i){const d=this.allPaths[i],n=K.M(s[0].x,s[0].y);return d.forEach((c,o)=>{if(o==0){if(c!=0)throw new Error("wtf")}else{const{x:g,y}=s[c],w=d[o-1];switch(h.positiveModulo(c-w,6)){case 1:{n.arc(0,0,g,y,"cw");break}case 2:case 4:{n.L(g,y);break}case 5:{n.arc(0,0,g,y,"ccw");break}default:throw new Error("wtf")}}}),n.pathShape}}const s=t.points,a=t.allPaths,e=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],r=h.Random.fromString("fourier-smackdown.ts");h.initializedArray(a.length,()=>{const m=r()*3|0,i=e[m];return e.splice(m,1),e.push(i),i});const u=new Array;{let m=function(i,d,n,c=i){const o=x.selectorQuery(`g.frequencies[data-frequencies="${c}"]`,SVGGElement),g=new Q(`[data-fourier-top="${c}"]`,p=>I(p,d,"srcRect fits completely into destRect"));o.style.fill=i;const w={maxGroupsToDisplay:15,skipCountAtEnd:1,pathString:t.makePathShape(n).rawPath,destination:g,liveColor:i,referenceColor:i},S=new W(w,o);u.push(S);const f=x.selectorQuery(`text.chapter[data-chapter="${c}"]`,SVGTextElement);f.innerHTML=`#${n}`,f.style.fill=i};m("red",{x:.5,y:.5,width:5,height:5},6),m("white",{x:5.5,y:3.5,width:5,height:5},7),m("var(--blue)",{x:10.5,y:.5,width:5,height:5},8,"blue")}X(...u)}
