import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as m}from"./client-misc-B8CxQsfg.js";import{b as ut,s as dt,h as O,t as Q}from"./fourier-shared-BtRQghVL.js";import{p as J,d as ft,b as mt,r as gt,P as N,e as pt}from"./path-shape-DRm3ZWo5.js";import{m as i}from"./misc-BHUyxQfl.js";import{g as I,e as yt}from"./utility-Dgy6CMn3.js";import{r as wt}from"./letters-base-6l4xCC6y.js";import{r as St}from"./hershey-fonts-uaj_-gfn.js";import{T as Pt}from"./letters-more-C6AAduc2.js";function xt(){document.body.style.backgroundColor="transparent",m.selectorQueryAll("[data-hide-background]",SVGElement).forEach(c=>c.style.display="none")}function bt(){const c=m.selectorQuery("[data-hide-background]",SVGElement);c.parentElement?.append(c)}{const c=i.Random.fromString("Pastel 41"),t=m.selectorQuery("[data-favorite]",SVGCircleElement),e=i.makeLinear(0,.025,2,.15);for(let n=0;n<150;n++){const s=i.assertClass(t.cloneNode(!0),SVGCircleElement);s.cx.baseVal.value=c()*16,s.cy.baseVal.value=c()*9,s.r.baseVal.value=e(c()+c()),t.parentElement.append(s)}}const z=new URLSearchParams(window.location.search);let tt=!1;z.get("hide_background")=="1"?xt():z.get("only_background")=="1"&&bt();{const t=m.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const Et=1024;class et{static#t=m.selectorQuery("[data-motion-blur-spinners]",HTMLDivElement);#n;constructor(t={radius:1,centerX:2,centerY:2}){const e=document.createElement("div");e.classList.add("motion-blur-spinner"),et.#t.append(e);const n=this.#n=e.style;n.setProperty("--radius",t.radius.toString()),n.setProperty("--center-x",t.centerX.toString()),n.setProperty("--center-y",t.centerY.toString()),t.color&&n.setProperty("--color",t.color),this.hide()}#e;showRadians(t){const e=this.#e??t;this.#e=t;const n=this.#n;n.display="",n.setProperty("--main-angle",`${t}rad`),n.setProperty("--blur-angle",`${e}rad`)}hide(){this.#e=void 0,this.#n.display="none"}}function B(c,t){if(c>=t)throw new Error("wtf");const e=i.makeLinear(c,0,t,1);function n(s){if(s<=c)return 0;if(s>=t)return 1;const u=e(s);return yt(u)}return n}let D=()=>{};window.showFrame=c=>{D(c)};class _{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=m.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=m.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new _(m.getById("right",SVGGElement),t=>J(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const Z=new ft;class kt{constructor(t,e,n=0,s=e-n){this.stepCount=t,this.period=e,this.#t=i.makeBoundedLinear(n,0,s,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),n;e<0?(e=0,n=0):e>=this.stepCount?(e=this.stepCount-1,n=this.period):n=t%this.period;const s=this.#t(n);return{index:e,t:s}}}class vt{constructor(t){this.pathString=t,this.samples=ut(t,Et),this.terms=dt(this.samples),this.keyframes=i.initializedArray(21,e=>e)}samples;terms;keyframes;bins(){const t=new Array;return this.keyframes.forEach((e,n,s)=>{const u=n-1;if(u>=0){const b=s[u],F=this.terms.slice(b,e);t.push(F)}}),t}get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function n(s){const{index:u,t:b}=t.get(s);return e(u,b)}return n}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],n=this.stepCount,s=h=>Math.max(...t.slice(0,h).map(S=>Math.abs(S.frequency))),u=h=>{if(h==0)return 8;{const g=s(h);return 8*Math.min(g,50)+7}},b=i.initializedArray(n,h=>{const g=e[h],S=e[h+1];if(g==0&&S==1&&t[0].frequency==0){let M=function(v){return`${P.x*v},${P.y*v}`};const P=i.assertNonNullable(O(t[0])),E=B(0,.5),G=B(0,1);return v=>{const l=G(v),r=M(l),o=E(v),a=M(o);return`M ${r} L ${a}`}}else if(g==S){const M=Q(t,g),P=u(S),G=N.glitchFreeParametric(M,P).rawPath;return v=>G}else{const P=.2/Math.abs(t[g].frequency),E=i.makeBoundedLinear(0,-P,1,1+P),G=Q(t,g),v=Q(t,S-g,g),l=u(S);if(g==0||g==1&&O(t[0])){const r=O(t[0])??{x:0,y:0};return o=>{const a=E(o),d=a-P,x=a+P,f=B(d,x),y=Math.min(1,x);if(y<=0)return`M${r.x},${r.y} L${r.x},${r.y}`;{let w=function(C){C=C*y;const k=G(C),T=1-f(C);if(T==0)return k;{const R=v(C);return{x:k.x+T*R.x,y:k.y+T*R.y}}};const p=Math.ceil(Math.max(l,150)*y);return N.glitchFreeParametric(w,p).rawPath}}}else return r=>{const o=E(r),a=B(o-P,o+P);function d(f){const y=G(f),w=1-a(f);if(w==0)return y;{const p=v(f);return{x:y.x+w*p.x,y:y.y+w*p.y}}}return N.glitchFreeParametric(d,l).rawPath}}});function F(h,g){const S=b[h];return S(g)}return F}}class q{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#a),this.#t(t)}timer;#n;#e;#s;#r;#a;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,Z.d=this.#n,this.#a=this.#e.getTransform(Z.getBBox()),this.timer=new kt(t.base.stepCount,q.PERIOD,q.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=n=>{const s=e(n);this.#e.setLivePath(s)}}}function Ct(...c){D=t=>{c.forEach(e=>e.show(t))}}let U;setTimeout(()=>{if(tt)return;let c=NaN;U=new m.AnimationLoop(t=>{isNaN(c)&&(c=t);const e=t-c;D(e)}),window.animationLoop=U},1);function Ft(c){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),U?.cancel(),{source:"fourier-smackdown.ts",script:c,seconds:69,devicePixelRatio}}window.initScreenCapture=Ft;class Vt{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class L{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=i.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,n)=>{const s=e.other(t);return s===void 0||this.pathSoFar.length==1&&s!=1?[]:new L([...this.pathSoFar,s],this.remainingEdges.toSpliced(n,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(s=>Math.max(s.vertex1,s.vertex2)))+1,n=new Set;for(const s of this.get(t)){const u=s.slice(0,s.length-1),b=this.#n(u);if(!n.has(b)){yield s,n.add(b);const F=this.#e(u,e).map(h=>this.#n(h));for(const h of F)n.add(h)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const n=new Array;for(let s=1;s<t.length;s++){const u=t[s],b=(u+1)%e,F=I(t,s+1);b==F?n.push(i.initializedArray(t.length,h=>{const g=I(t,h+s);return i.positiveModulo(g-u,e)})):I(t,s-1)==b&&n.push(i.initializedArray(t.length,g=>{const S=I(t,s-g);return i.positiveModulo(S-u,e)}))}return n}static getSamples(){function t(e,...n){return i.initializedArray(e,s=>n.map(u=>new Vt(s,(s+u)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=L;function Gt(){const c=L.getSamples(),t=L.getUnique(c.pentagram);console.log(t,t.constructor.name);for(const e of t);}Gt();{let c=function(l,r,o){const a=r-l,d=o-l,x=2*l,f=2*l;return{x:a,y:d,width:x,height:f}};class t{constructor(r){throw new Error("wtf")}static points=i.initializedArray(5,r=>{const o=i.FULL_CIRCLE*r/5+i.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...L.getUnique(L.getSamples().pentagram)]}class e{constructor(r){throw new Error("wtf")}static points=i.initializedArray(6,r=>{const o=i.FULL_CIRCLE*r/6+i.FULL_CIRCLE/4,a=Math.cos(o),d=Math.sin(o);return{x:a,y:d}});static allPaths=[...L.getUnique(L.getSamples().dodecahedron)];static makePathShape(r){const o=this.allPaths[r],a=mt.M(n[0].x,n[0].y);return o.forEach((d,x)=>{if(x==0){if(d!=0)throw new Error("wtf")}else{const{x:f,y}=n[d],w=o[x-1];switch(i.positiveModulo(d-w,6)){case 1:{a.arc(0,0,f,y,"cw");break}case 2:case 4:{a.L(f,y);break}case 5:{a.arc(0,0,f,y,"ccw");break}default:throw new Error("wtf")}}}),a.pathShape}}const n=e.points,s=e.allPaths,u=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],b=i.Random.fromString("fourier-smackdown.ts");i.initializedArray(s.length,()=>{const l=b()*3|0,r=u[l];return u.splice(l,1),u.push(r),r});let F=65;const h=9/4,g=.65,S=[{color:"n/a",destRect:c(4,8,4.5),index:F}],M={radius:h*g,cx:[h,(h+16/2)/2,16/2,(16-h+16/2)/2,16-h],cy:[9-2.75*h,2.75*h]};console.log(M);const P=S.map(({index:l})=>{const r=e.makePathShape(l).rawPath;return new vt(r)});P.forEach(({terms:l,keyframes:r},o)=>{const a=l.length,d=[],x=7;for(;d.length<x-1;){let p;d.length<6?p=1:p=3;const V=l.splice(0,p);if(V.length!=p)throw new Error("wtf");d.push(V)}const f=[],y=[];d.forEach((p,V)=>{V%3<2?f.push(p):y.unshift(p)});const w=[...f,[...l],...y];if(w.length!=x)throw new Error("wtf");if(console.log(w),l.length=0,r.length=0,r.push(0),w.forEach((p,V,C)=>{l.push(...p),r.push(l.length)}),l.length!=a)throw new Error("wtf")}),console.log(P);const E=new Array,G=m.selectorQuery("g#foreground",SVGGElement);m.getById("chapterList",SVGTextElement);const v=[{light:"Magenta",dark:"black"},{light:"HotPink",dark:"red"},{light:"white",dark:"gray"},{light:"var(--blue)",dark:"blue"},{light:"orange",dark:"darkOrange"},{light:"Fuchsia ",dark:"DarkViolet"}];S.length-1;for(const[l,r,{light:o,dark:a},d]of i.zip(S,P,v,i.count())){const{destRect:x,search:f}=l,y=f===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):m.selectorQuery(`g.frequencies[data-frequencies="${f}"]`,SVGGElement),w=f===void 0?G.appendChild(i.assertClass(m.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):m.selectorQuery(`[data-fourier-top="${f}"]`,SVGGElement);w.style.setProperty("--color",o),w.style.setProperty("--blur-color",a);const p=new _(w,k=>J(k,x,"srcRect fits completely into destRect"));w.dataset.liveIndex=d.toString(),y.style.fill=a;const V={base:r,destination:p,liveColor:a,referenceColor:o},C=new q(V);E.push(C),console.log(C)}{let l=function(){a.reset(),a.fillStyle="cyan",a.fillRect(0,0,o.width,o.height)},r=function(A){X.currentTime=A;const at=i.assertNonNullable(p.getAttribute("d")),Y=new Path2D(at);function $(j,ot){const K=getComputedStyle(j),it=K.strokeWidth,ct=i.assertNonNullable(i.parseFloatX(/^(.*)px$/.exec(it)[1]));a.lineWidth=ct,a.lineCap=K.strokeLinecap;const lt=pt(j,w),ht=y.multiply(lt);a.setTransform(ht),a.stroke(ot)}l(),a.strokeStyle="white",a.filter="url(#anti-anti-alias)",$(W,rt),a.strokeStyle="black",a.filter="url(#checkerboard-alpha)",$(V,Y),a.strokeStyle="magenta",a.filter="url(#anti-anti-alias)",$(p,Y)};const o=m.getById("cga",HTMLCanvasElement),a=o.getContext("2d"),d={x:2,y:0,width:12,height:9},x={x:0,y:0,width:o.width,height:o.height},f=gt(d,x),y=new DOMMatrix(f.transformString),w=m.getById("main",SVGSVGElement),p=i.assertNonNullable(m.selectorQueryAll("[data-live-index] path",SVGPathElement).at(-1)),V=m.selectorQuery("[data-live-index] path.offset-blur",SVGPathElement),C=wt(St,2),k=new Pt(C),T=[];T.push(...k.addText("Party","left")),k.carriageReturn(),k.lineFeed(),T.push(...k.addText(" like it’s")),k.carriageReturn(),k.lineFeed(),T.push(...k.addText("  1983."));const R=1,nt=2.2;let H=N.join(T.map(A=>({shape:A.description.shape,Δx:A.x+nt,Δy:A.baseline+R})));const st=m.getById("line-text",SVGGElement),W=H.makeElement(!1),rt=new Path2D(H.rawPath);st.append(W);const X=o.animate([{clipPath:"rect(0% 100% 100% 0%)",offset:0},{clipPath:"rect(0% 100% 100% 100%)",offset:.5},{clipPath:"rect(0% 0% 100% 0%)",offset:.5},{clipPath:"rect(0% 100% 100% 0%)",offset:1}],{duration:9897,iterations:1/0});X.pause(),E.push({show:r})}if(console.log(E),Ct(...E),z.get("thumbnail")=="1"){tt=!0;const l=new Array;Array.from(G.children).forEach(r=>{const o=i.assertClass(r,SVGElement);o.dataset.live===void 0?o.style.display="none":(console.log("live",o.dataset.live),l.push(o))}),E[0].show(14e3),E[1].show(28e3),E[2].show(42e3),window.showFrame=r=>{console.info(`ignoring showFrame(${r})`)},m.selectorQueryAll("[data-reference]",SVGPathElement).forEach(r=>r.style.display="none"),m.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(r=>{r.style.transform="scale(3)",r.style.transformOrigin=`${r.cx.baseVal.value}px ${r.cy.baseVal.value}px`})}}
