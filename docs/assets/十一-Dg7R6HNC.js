import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as f}from"./client-misc-B8CxQsfg.js";import{m as I}from"./misc-BHUyxQfl.js";import{m as tt,c as nt,b as B}from"./utility-Dgy6CMn3.js";import{m as H,T as k}from"./letters-more-DOdzY1Qc.js";import{m as G}from"./rough-lib-Cip-DRa-.js";import{H as et}from"./handwriting-effect-2FjZRqWW.js";import"./letters-base-f0EqzUwR.js";import"./path-shape-DN4hoPl6.js";import"./math-to-path-DHD-XsCZ.js";const W=f.getById("randomSeed",HTMLInputElement),it=f.getById("draw",HTMLButtonElement),ot=f.getById("timeInSeconds",HTMLInputElement),V=f.getById("start",HTMLButtonElement),st=f.getById("time",HTMLInputElement),y=f.getById("handwriting",SVGGElement),R=f.getById("morph",SVGGElement);it.addEventListener("click",()=>{N()});const at=Intl.NumberFormat(void 0,{useGrouping:!0,maximumFractionDigits:4}),rt=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:2,maximumFractionDigits:2}),ct=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:4,maximumFractionDigits:4});function N(){function s(t){const n=at.format(t),o=t+1,e=t-1,i=o/e,c=e/o,u=(i+c)/2,r=i-u;return isFinite(u)&&isFinite(r)?{baseValueString:n,finite:!0,meanString:rt.format(u),errorString:ct.format(r)}:{baseValueString:n,finite:!1,errorMessage:"#DIV/0!"}}const p=[{strings:s(10001),finalRough:0},{strings:s(1001),finalRough:0},{strings:s(101),finalRough:.2},{strings:s(11),finalRough:.45},{strings:s(2),finalRough:.7},{strings:s(1.1),finalRough:1},{strings:s(1.01),finalRough:1.2},{strings:s(1.001),finalRough:1.5},{strings:s(1.0001),finalRough:2},{strings:s(1),finalRough:0}];let l=W.value;I.Random.seedIsValid(l)||(l=I.Random.newSeed(),W.value=l);const L=I.Random.create(l);y.innerHTML="",R.innerHTML="";class x{#n=new Array;get letters(){return[...this.#n]}#t=new k;constructor(n){n instanceof Map||(n=H(n)),this.#t.font=n,this.restart()}restart(){this.#t.restart(0,0),this.#n.length=0}addAndTag(n,o){const e=this.#t.addText(n),i=this.#n;e.forEach(c=>i.push({colorName:o,...c}))}get width(){return this.#t.x}extract(){const n={width:this.width,letters:this.letters};return this.restart(),n}single(n,o){return this.restart(),this.addAndTag(n,o),this.extract()}}const g=H(2.7),m=new x(g),w=m.single(" ÷ ","blue"),M=m.single(" → ","blue"),S=p.map(t=>{const n=t.strings;m.addAndTag("("+n.baseValueString,"blue"),m.addAndTag(" ± 1","white"),m.addAndTag(")","blue");const o=m.extract();if(n.finite){const e=m.single(n.meanString,"blue"),i=m.single(" ± "+n.errorString,"white");return{inputLayoutInfo:o,finite:!0,meanLayoutInfo:e,errorLayoutInfo:i}}else{const e=m.single(n.errorMessage,"gold");return{inputLayoutInfo:o,finite:!1,messageLayoutInfo:e}}});let a=7;const E=Math.max(...S.map(t=>t.inputLayoutInfo.width)),F=a+E/2;a+=E;const P=a;a+=w.width;const C=a+E/2;a+=E;const O=a;a+=M.width;const q=Math.max(...S.flatMap(t=>t.finite?[t.meanLayoutInfo.width]:[])),v=a;a+=q;const U=a,X=Math.max(...S.flatMap(t=>t.finite?[t.errorLayoutInfo.width]:[]));a+=X;const j=a,z=a,J=S.map((t,n)=>{const o=[],e=(n+1)*4.8*1.125;function i(r,d,h){d.forEach(b=>{o.push({...b,x:b.x+r,baseline:e,neverLeaveRough:h})})}const c=F-t.inputLayoutInfo.width/2;i(c,t.inputLayoutInfo.letters,!0),i(P,w.letters,!0);const u=c-F+C;if(i(u,t.inputLayoutInfo.letters,!0),i(O,M.letters,!0),t.finite){const r=t.meanLayoutInfo;i(U-r.width,r.letters,!1);const d=t.errorLayoutInfo;i(j-d.width,d.letters,!1)}else{const d=z-v-t.messageLayoutInfo.width,h=v+d/2;i(h,t.messageLayoutInfo.letters,!0)}return o}),T=[];J.map((t,n)=>{const o=p[n].finalRough;t.forEach(e=>{const i=G(e.description.shape,e.description.fontMetrics.strokeWidth,L),c=e.neverLeaveRough?0:o;if(c<=1){const u=i.after,r=i.before,d=1-c,h=e.description.reshape(u);T.push({...e,initialShape:u,finalShape:r,finalAnimation:d,description:h})}else{const u=G(i.after,e.description.fontMetrics.strokeWidth*(c-1)*3,L),r=u.before,d=u.after,h="forever",b=e.description.reshape(r);T.push({...e,initialShape:r,finalShape:d,finalAnimation:h,description:b})}})});const A=k.displayText(T,R).map(t=>{t.element.classList.add(t.colorName);const n=t.finalAnimation,o=[{offset:0,d:t.initialShape.cssPath},{offset:1,d:t.finalShape.cssPath}];if(typeof n=="number"){const e=t.element.animate(o,{duration:1,fill:"both"});e.currentTime=n,e.commitStyles(),e.cancel(),o.pop();const i=t.element.animate(o,{duration:1,fill:"both"});return i.pause(),i}else{const e=t.element.animate(o,{duration:5,fill:"both",direction:"alternate",iterations:1/0});return e.pause(),e}}),K=()=>{R.style.display="none"},Q=t=>{B(t),R.style.display="";const o=t*A.length*(.5+1);A.forEach((e,i)=>{const c=o-i;e.currentTime=c})};{const t=new et(y);T.forEach(n=>{t.add({baseline:n.baseline,x:n.x,shape:n.description.shape}).forEach(({element:e})=>{e.classList.add(n.colorName)})})}const Y=()=>{y.style.display="none"},Z=t=>{B(t),y.style.display="",y.style.setProperty("--t",t.toString())},_=tt(2,1.5),$=t=>{const n=_(t);switch(n.index){case 0:{K(),Z(n.t);break}case 1:{Y(),Q(n.t);break}default:throw new Error("wtf")}};window.showFrame=$,V.disabled=!1}let D;V.addEventListener("click",()=>{D?.cancel();const s=I.parseIntX(ot.value);if(s===void 0)throw new Error("I don't want to do this better");let p=0,l;const L=nt(3),x=new f.AnimationLoop(g=>{if(l||(p=g+s*1e3,l=I.makeLinear(g,0,p,1)),g>p)x.cancel(),window.showFrame(1);else{const m=l(g),w=L(m);st.value=w.toString(),window.showFrame(w)}});D=x});function mt(){return N(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(s=>{if(!(s instanceof SVGElement||s instanceof HTMLElement))throw new Error("wtf");s.style.display="none"}),{source:"show-text-1.ts",devicePixelRatio}}window.initScreenCapture=mt;
