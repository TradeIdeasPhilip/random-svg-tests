import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as x}from"./client-misc-B8CxQsfg.js";import{b as rt,s as st,h as Q,t as U}from"./fourier-shared-BneanVCb.js";import{p as j,d as ot,b as at,P as _}from"./path-shape-DN4hoPl6.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as O,e as it}from"./utility-Dgy6CMn3.js";function ct(){document.body.style.backgroundColor="transparent",x.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function lt(){const i=x.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}{const i=a.Random.fromString("Pastel 41"),t=x.selectorQuery("[data-favorite]",SVGCircleElement),e=a.makeLinear(0,.025,2,.15);for(let n=0;n<150;n++){const r=a.assertClass(t.cloneNode(!0),SVGCircleElement);r.cx.baseVal.value=i()*16,r.cy.baseVal.value=i()*9,r.r.baseVal.value=e(i()+i()),t.parentElement.append(r)}}const X=new URLSearchParams(window.location.search);let J=!1;X.get("hide_background")=="1"?ct():X.get("only_background")=="1"&&lt();{const t=x.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const ht=1024;class D{static#t=x.selectorQuery("[data-motion-blur-spinners]",HTMLDivElement);#n;constructor(t={radius:1,centerX:2,centerY:2}){const e=document.createElement("div");e.classList.add("motion-blur-spinner"),D.#t.append(e);const n=this.#n=e.style;n.setProperty("--radius",t.radius.toString()),n.setProperty("--center-x",t.centerX.toString()),n.setProperty("--center-y",t.centerY.toString()),t.color&&n.setProperty("--color",t.color),this.hide()}#e;showRadians(t){const e=this.#e??t;this.#e=t;const n=this.#n;n.display="",n.setProperty("--main-angle",`${t}rad`),n.setProperty("--blur-angle",`${e}rad`)}hide(){this.#e=void 0,this.#n.display="none"}}function $(i,t){if(i>=t)throw new Error("wtf");const e=a.makeLinear(i,0,t,1);function n(r){if(r<=i)return 0;if(r>=t)return 1;const u=e(r);return it(u)}return n}let H=()=>{};window.showFrame=i=>{H(i)};class K{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=x.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=x.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new K(x.getById("right",SVGGElement),t=>j(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const Z=new ot;class ut{constructor(t,e,n=0,r=e-n){this.stepCount=t,this.period=e,this.#t=a.makeBoundedLinear(n,0,r,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),n;e<0?(e=0,n=0):e>=this.stepCount?(e=this.stepCount-1,n=this.period):n=t%this.period;const r=this.#t(n);return{index:e,t:r}}}class dt{constructor(t){this.pathString=t,this.samples=rt(t,ht),this.terms=st(this.samples),this.keyframes=a.initializedArray(21,e=>e)}samples;terms;keyframes;bins(){const t=new Array;return this.keyframes.forEach((e,n,r)=>{const u=n-1;if(u>=0){const C=r[u],L=this.terms.slice(C,e);t.push(L)}}),t}get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function n(r){const{index:u,t:C}=t.get(r);return e(u,C)}return n}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],n=this.stepCount,r=m=>Math.max(...t.slice(0,m).map(P=>Math.abs(P.frequency))),u=m=>{if(m==0)return 8;{const S=r(m);return 8*Math.min(S,50)+7}},C=a.initializedArray(n,m=>{const S=e[m],P=e[m+1];if(S==0&&P==1&&t[0].frequency==0){let V=function(o){return`${y.x*o},${y.y*o}`};const y=a.assertNonNullable(Q(t[0])),M=$(0,.5),A=$(0,1);return o=>{const s=A(o),c=V(s),l=M(o),h=V(l);return`M ${c} L ${h}`}}else if(S==P){const V=U(t,S),y=u(P),A=_.glitchFreeParametric(V,y).rawPath;return o=>A}else{const y=.2/Math.abs(t[S].frequency),M=a.makeBoundedLinear(0,-y,1,1+y),A=U(t,S),o=U(t,P-S,S),s=u(P);if(S==0||S==1&&Q(t[0])){const c=Q(t[0])??{x:0,y:0};return l=>{const h=M(l),k=h-y,p=h+y,b=$(k,p),w=Math.min(1,p);if(w<=0)return`M${c.x},${c.y} L${c.x},${c.y}`;{let g=function(f){f=f*w;const E=A(f),F=1-b(f);if(F==0)return E;{const I=o(f);return{x:E.x+F*I.x,y:E.y+F*I.y}}};const v=Math.ceil(Math.max(s,150)*w);return _.glitchFreeParametric(g,v).rawPath}}}else return c=>{const l=M(c),h=$(l-y,l+y);function k(b){const w=A(b),g=1-h(b);if(g==0)return w;{const v=o(b);return{x:w.x+g*v.x,y:w.y+g*v.y}}}return _.glitchFreeParametric(k,s).rawPath}}});function L(m,S){const P=C[m];return P(S)}return L}}class T{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#r,this.#s),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}timer;#n;#e;#r;#s;#o;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#r=t.referenceColor,this.#s=t.liveColor,Z.d=this.#n,this.#o=this.#e.getTransform(Z.getBBox()),this.timer=new ut(t.base.stepCount,T.PERIOD,T.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=n=>{const r=e(n);this.#e.setLivePath(r)}}}function ft(...i){H=t=>{i.forEach(e=>e.show(t))}}let Y;setTimeout(()=>{if(J)return;let i=NaN;Y=new x.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;H(e)}),window.animationLoop=Y},1);function pt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),Y?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:70,devicePixelRatio}}window.initScreenCapture=pt;class gt{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class G{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,n)=>{const r=e.other(t);return r===void 0||this.pathSoFar.length==1&&r!=1?[]:new G([...this.pathSoFar,r],this.remainingEdges.toSpliced(n,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(r=>Math.max(r.vertex1,r.vertex2)))+1,n=new Set;for(const r of this.get(t)){const u=r.slice(0,r.length-1),C=this.#n(u);if(!n.has(C)){yield r,n.add(C);const L=this.#e(u,e).map(m=>this.#n(m));for(const m of L)n.add(m)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const n=new Array;for(let r=1;r<t.length;r++){const u=t[r],C=(u+1)%e,L=O(t,r+1);C==L?n.push(a.initializedArray(t.length,m=>{const S=O(t,m+r);return a.positiveModulo(S-u,e)})):O(t,r-1)==C&&n.push(a.initializedArray(t.length,S=>{const P=O(t,r-S);return a.positiveModulo(P-u,e)}))}return n}static getSamples(){function t(e,...n){return a.initializedArray(e,r=>n.map(u=>new gt(r,(r+u)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=G;function mt(){const i=G.getSamples(),t=G.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}mt();{let i=function(o,s,c){const l=s-o,h=c-o,k=2*o,p=2*o;return{x:l,y:h,width:k,height:p}};class t{constructor(s){throw new Error("wtf")}static points=a.initializedArray(5,s=>{const c=a.FULL_CIRCLE*s/5+a.FULL_CIRCLE/4,l=Math.cos(c),h=Math.sin(c);return{x:l,y:h}});static allPaths=[...G.getUnique(G.getSamples().pentagram)]}class e{constructor(s){throw new Error("wtf")}static points=a.initializedArray(6,s=>{const c=a.FULL_CIRCLE*s/6+a.FULL_CIRCLE/4,l=Math.cos(c),h=Math.sin(c);return{x:l,y:h}});static allPaths=[...G.getUnique(G.getSamples().dodecahedron)];static makePathShape(s){const c=this.allPaths[s],l=at.M(n[0].x,n[0].y);return c.forEach((h,k)=>{if(k==0){if(h!=0)throw new Error("wtf")}else{const{x:p,y:b}=n[h],w=c[k-1];switch(a.positiveModulo(h-w,6)){case 1:{l.arc(0,0,p,b,"cw");break}case 2:case 4:{l.L(p,b);break}case 5:{l.arc(0,0,p,b,"ccw");break}default:throw new Error("wtf")}}}),l.pathShape}}const n=e.points,r=e.allPaths,u=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],C=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(r.length,()=>{const o=C()*3|0,s=u[o];return u.splice(o,1),u.push(s),s});let L=61;const m=9/4,P=[{color:"n/a",destRect:i(m*.8,m,2.75*m),index:L}],V=P.map(({index:o})=>{const s=e.makePathShape(o).rawPath;return new dt(s)});V.forEach(({terms:o,keyframes:s},c)=>{const l=o.length,h=[],k=10;for(;h.length<k-1;){let g;h.length<6?g=2:g=3;const v=o.splice(0,g);if(v.length!=g)throw new Error("wtf");h.push(v)}const p=[],b=[];h.forEach((g,v)=>{v%3<2?p.push(g):b.unshift(g)});const w=[...p,[...o],...b];if(w.length!=k)throw new Error("wtf");if(console.log(w),o.length=0,s.length=0,s.push(0),w.forEach((g,v,d)=>{o.push(...g),s.push(o.length)}),o.length!=l)throw new Error("wtf")}),console.log(V);const y=new Array,M=x.selectorQuery("g#foreground",SVGGElement);x.getById("chapterList",SVGTextElement),P.length-1;const A=[{light:"orange",dark:"darkOrange"},{light:"Fuchsia ",dark:"purple"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"red",dark:"darkRed"},{light:"white",dark:"black"},{light:"var(--blue)",dark:"darkblue"}];for(const[o,s,{light:c,dark:l},h]of a.zip(P,V,A,a.count())){const{destRect:k,search:p}=o,b=p===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):x.selectorQuery(`g.frequencies[data-frequencies="${p}"]`,SVGGElement),w=p===void 0?M.appendChild(a.assertClass(x.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):x.selectorQuery(`[data-fourier-top="${p}"]`,SVGGElement);w.style.setProperty("--color",c),w.style.setProperty("--blur-color",l);const g=new K(w,f=>j(f,k,"srcRect fits completely into destRect"));w.dataset.liveIndex=h.toString(),b.style.fill=l;const v={base:s,destination:g,liveColor:l,referenceColor:c},d=new T(v);y.push(d),console.log(d)}{let o=function(d){return u.map(({dark:f})=>new D({...d,color:f})).reverse()},s=function(d){const f=new Array;for(;;){const E=d.shift();if(!E)break;const F=E.shift();F&&(f.push(F),d.push(E))}return f},c=function(d){const{index:f,t:E}=h.get(d),F=E>=1?-1:f,I=E*a.FULL_CIRCLE;v.forEach(({term:B,spinner:R,startIndex:z})=>{if(z>F)R.hide();else{const q=I*B.frequency+B.phase;R.showRadians(q)}})};const l=a.assertClass(y[0],T),h=l.timer,k=l.base.bins(),p=new Array,b=new Array;k.forEach((d,f)=>{const E=d.length<7?p:b;d.forEach(F=>{E.push({term:F,startIndex:f})})}),[p,b].forEach(d=>{d.sort((f,E)=>Math.abs(f.term.frequency)-Math.abs(E.term.frequency))}),console.log({smallGroupInfo:p,largeGroupInfo:b});const w=[{centerX:2,centerY:2,radius:1},{centerX:5,centerY:2,radius:1},{centerX:8,centerY:2,radius:1},{centerX:11,centerY:2,radius:1},{centerX:14,centerY:2,radius:1}].map(d=>o(d)),g=[];{const F=1.4642857142857142,I=4-.5,B=9-.25,R=3,z=(B-I)/R;for(let q=0;q<R;q++)for(let N=0;N<7;N++){const W=5.5+(N+.5)*F,tt=I+(q+.5)*z,et=1/3,nt=o({centerX:W,centerY:tt,radius:et});g.push(nt)}}const v=new Array;for(const[{term:d,startIndex:f},E]of a.zip(p,s(w)))v.push({term:d,spinner:E,startIndex:f});for(const[{term:d,startIndex:f},E]of a.zip(b,s(g)))v.push({term:d,spinner:E,startIndex:f});y.push({show:c})}if(console.log(y),ft(...y),X.get("thumbnail")=="1"){J=!0;const o=new Array;Array.from(M.children).forEach(s=>{const c=a.assertClass(s,SVGElement);c.dataset.live===void 0?c.style.display="none":(console.log("live",c.dataset.live),o.push(c))}),y[0].show(14e3),y[1].show(28e3),y[2].show(42e3),window.showFrame=s=>{console.info(`ignoring showFrame(${s})`)},x.selectorQueryAll("[data-reference]",SVGPathElement).forEach(s=>s.style.display="none"),x.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(s=>{s.style.transform="scale(3)",s.style.transformOrigin=`${s.cx.baseVal.value}px ${s.cy.baseVal.value}px`})}}
