import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as y}from"./client-misc-B8CxQsfg.js";import{b as D,s as K,h as N,t as z}from"./fourier-shared-DpvWsPe-.js";import{p as O,d as Z,b as J,P as B}from"./path-shape-CZZKMsju.js";import{m as c}from"./misc-BHUyxQfl.js";import{g as q,e as W}from"./utility-Dgy6CMn3.js";import{a as X}from"./hershey-fonts-Cv6hiE5v.js";import{r as Y}from"./letters-base-CTGJGQGt.js";function tt(){document.body.style.backgroundColor="transparent",y.selectorQueryAll("[data-hide-background]",SVGElement).forEach(d=>d.style.display="none")}function et(){const d=y.selectorQuery("[data-hide-background]",SVGElement);d.parentElement?.append(d)}const U=new URLSearchParams(window.location.search);let j=!1;U.get("hide_background")=="1"?tt():U.get("only_background")=="1"&&et();{const t=y.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const nt=1024;class rt{constructor(t,e){this.terms=e,t instanceof SVGGElement||(t=y.selectorQuery(t,SVGGElement)),this.#t=y.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(o=>{const r=y.selectorQuery("text",SVGTextElement,o),m=document.createElementNS("http://www.w3.org/2000/svg","text");return m.classList.add("background"),o.insertBefore(m,r),{top:o,spinner:y.selectorQuery(".spinner",SVGPolygonElement,o),text:r,background:m}})}#t;show(t,e){this.#t.forEach((o,r)=>{if(r>=t)o.top.style.display="none";else{o.top.style.display="";const m=this.terms[r];o.background.innerHTML=o.text.innerHTML=m.frequency.toString(),o.spinner.style.transform=`rotate(${e*m.frequency+m.phase+c.FULL_CIRCLE/4}rad)`}})}}function T(d,t){if(d>=t)throw new Error("wtf");const e=c.makeLinear(d,0,t,1);function o(r){if(r<=d)return 0;if(r>=t)return 1;const m=e(r);return W(m)}return o}let Q=()=>{};window.showFrame=d=>{Q(d)};class ${constructor(t,e){this.getTransform=e,this.#t=y.selectorQuery(t,SVGGElement),this.#n=y.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=y.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new $("#right",t=>O(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const I=new Z;class st{constructor(t){this.pathString=t,this.samples=D(t,nt),this.terms=K(this.samples),this.keyframes=c.initializedArray(21,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t,e=0,o=t-e){const r=this.makeGetPath2(),m=c.makeBoundedLinear(e,0,o,1),w=this.stepCount;function F(p){let l=Math.floor(p/t),g;l<0?(l=0,g=0):l>=w?(l=w-1,g=t):g=p%t;const u=m(g);return{pathString:r(l,u),index:l,t:u}}return F}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],o=this.stepCount,r=p=>Math.max(...t.slice(0,p).map(g=>Math.abs(g.frequency))),m=p=>{const l=r(p);return 8*Math.min(l,50)+7},w=c.initializedArray(o,p=>{const l=e[p],g=e[p+1];if(l==0&&g==1&&t[0].frequency==0){let u=function(s){return`${i.x*s},${i.y*s}`};const i=c.assertNonNullable(N(t[0])),h=T(0,.5),n=T(0,1);return s=>{const f=n(s),a=u(f),E=h(s),b=u(E);return`M ${a} L ${b}`}}else{const i=.2/r(g),h=c.makeBoundedLinear(0,-i,1,1+i),n=z(t,l),s=z(t,g-l,l),f=m(g);if(l==0||l==1&&N(t[0])){const a=N(t[0])??{x:0,y:0};return E=>{const b=h(E),L=b-i,M=b+i,G=T(L,M),P=Math.min(1,M);if(P<=0)return`M${a.x},${a.y} L${a.x},${a.y}`;{let S=function(k){k=k*P;const v=n(k),A=1-G(k);if(A==0)return v;{const R=s(k);return{x:v.x+A*R.x,y:v.y+A*R.y}}};const C=Math.ceil(Math.max(f,150)*P);return B.glitchFreeParametric(S,C).rawPath}}}else return a=>{const E=h(a),b=T(E-i,E+i);function L(G){const P=n(G),S=1-b(G);if(S==0)return P;{const C=s(G);return{x:P.x+S*C.x,y:P.y+S*C.y}}}return B.glitchFreeParametric(L,f).rawPath}}});function F(p,l){const g=w[p];return g(l)}return F}}class ot{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#r,this.#s),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}endTime;#n;#e;#r;#s;#o;constructor(t,e){this.#n=t.base.pathString,this.#e=t.destination,this.#r=t.referenceColor,this.#s=t.liveColor,I.d=this.#n,this.#o=this.#e.getTransform(I.getBBox());const o=6e3,r=750;this.endTime=o*t.base.stepCount;const m=t.base.makeGetPath1(o,0,o-r),w=new rt(e,t.base.terms);this.#t=F=>{const{pathString:p,index:l,t:g}=m(F);this.#e.setLivePath(p),w.show(t.base.keyframes[l+1],g*c.FULL_CIRCLE)}}}function at(...d){Q=t=>{d.forEach(e=>e.show(t))}}let _;setTimeout(()=>{if(j)return;let d=NaN;_=new y.AnimationLoop(t=>{isNaN(d)&&(d=t);const e=t-d;Q(e)}),window.animationLoop=_},1);function it(d){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),_?.cancel(),{source:"fourier-smackdown.ts",script:d,seconds:120,devicePixelRatio}}window.initScreenCapture=it;class ct{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class V{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=c.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,o)=>{const r=e.other(t);return r===void 0||this.pathSoFar.length==1&&r!=1?[]:new V([...this.pathSoFar,r],this.remainingEdges.toSpliced(o,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(r=>Math.max(r.vertex1,r.vertex2)))+1,o=new Set;for(const r of this.get(t)){const m=r.slice(0,r.length-1),w=this.#n(m);if(!o.has(w)){yield r,o.add(w);const F=this.#e(m,e).map(p=>this.#n(p));for(const p of F)o.add(p)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const o=new Array;for(let r=1;r<t.length;r++){const m=t[r],w=(m+1)%e,F=q(t,r+1);w==F?o.push(c.initializedArray(t.length,p=>{const l=q(t,p+r);return c.positiveModulo(l-m,e)})):q(t,r-1)==w&&o.push(c.initializedArray(t.length,l=>{const g=q(t,r-l);return c.positiveModulo(g-m,e)}))}return o}static getSamples(){function t(e,...o){return c.initializedArray(e,r=>o.map(m=>new ct(r,(r+m)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=V;function lt(){const d=V.getSamples(),t=V.getUnique(d.pentagram);console.log(t,t.constructor.name);for(const e of t);}lt();{let d=function(u,i,h){u.sort((a,E)=>E.amplitude-a.amplitude);const n=new Array,s=new Array;let f;return u.forEach(a=>{f!==void 0&&a.amplitude<f?s.push(a):(a.frequency+h)%i==0?(n.push(a),f===void 0&&(f=a.amplitude*.05)):s.push(a)}),u.length=0,u.push(...n,...s),console.log(n,s,u),{frontLength:n.length}},t=function(u,i=8){const h=[],n=u.terms,s=n.length;for(h.push();h.length<i;){const a=c.assertNonNullable(n.shift());h.push([a])}for(;h.length<19;){const a=n.splice(0,2);if(a.length!=2)throw new Error("wtf");h.push(a)}if(console.log({bins:h,terms:n}),h.splice(i,0,[...n]),console.log(h),n.length=0,n.length!=0)throw new Error("wtf");const f=u.keyframes;if(f.length=0,f.push(0),h.forEach(a=>{n.push(...a),f.push(n.length)}),n.length!=s)throw new Error("wtf")};class e{constructor(i){throw new Error("wtf")}static points=c.initializedArray(5,i=>{const h=c.FULL_CIRCLE*i/5+c.FULL_CIRCLE/4,n=Math.cos(h),s=Math.sin(h);return{x:n,y:s}});static allPaths=[...V.getUnique(V.getSamples().pentagram)]}class o{constructor(i){throw new Error("wtf")}static points=c.initializedArray(6,i=>{const h=c.FULL_CIRCLE*i/6+c.FULL_CIRCLE/4,n=Math.cos(h),s=Math.sin(h);return{x:n,y:s}});static allPaths=[...V.getUnique(V.getSamples().dodecahedron)];static makePathShape(i){const h=this.allPaths[i],n=J.M(r[0].x,r[0].y);return h.forEach((s,f)=>{if(f==0){if(s!=0)throw new Error("wtf")}else{const{x:a,y:E}=r[s],b=h[f-1];switch(c.positiveModulo(s-b,6)){case 1:{n.arc(0,0,a,E,"cw");break}case 2:case 4:{n.L(a,E);break}case 5:{n.arc(0,0,a,E,"ccw");break}default:throw new Error("wtf")}}}),n.pathShape}}const r=o.points,m=o.allPaths,w=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],F=c.Random.fromString("fourier-smackdown.ts");c.initializedArray(m.length,()=>{const u=F()*3|0,i=w[u];return w.splice(u,1),w.push(i),i});const p=[{color:"#black",destRect:{x:.5,y:.5,width:5,height:5},index:30,colorName:"red"},{color:"black",destRect:{x:5.5,y:3.5,width:5,height:5},index:31,colorName:"white"},{color:"black",destRect:{x:10.5,y:.5,width:5,height:5},index:32,colorName:"blue"}],l=p.map(({index:u})=>{const i=o.makePathShape(u).rawPath;return new st(i)});d(l[0].terms,4,-1),d(l[1].terms,4,-1),d(l[2].terms,5,-1),console.log(l),t(l[0],7),t(l[1],8),t(l[2],6);const g=new Array;for(const[u,i]of c.zip(p,l)){const{color:h,destRect:n}=u,s=u.colorName??u.color,f=y.selectorQuery(`g.frequencies[data-frequencies="${s}"]`,SVGGElement),a=new $(`[data-fourier-top="${s}"]`,L=>O(L,n,"srcRect fits completely into destRect"));f.style.fill=h;const E={base:i,destination:a,liveColor:h,referenceColor:h},b=new ot(E,f);g.push(b),console.log(b)}{let u=function(S,C){const k=[S,S+c.FULL_CIRCLE/3,S-c.FULL_CIRCLE/3].map(H=>G(Math.sin(H)));k.push(0),k.push(P(Math.cos(C)));const v=k.join(" "),R=[v,v,v,"0 0 0 0 1"].join(`
`);n.setAttribute("values",R)},i=function(S){const C=s.map(x=>[]);S.forEach(x=>{if(x.length!=s.length)throw new Error("wtf");x.forEach((k,v)=>{C[v].push(k)})});for(const[x,k]of c.zip(s,C))x.setAttribute("tableValues",k.join(" "))},h=function(S){const C=S/24e4*c.FULL_CIRCLE*2,x=S/24e4*c.FULL_CIRCLE/2;u(C,x)};const n=y.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),s=[y.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),y.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),y.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],L=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),M=c.makeLinear(0,0,255,1);L.forEach(S=>S.forEach((C,x,k)=>k[x]=M(C)));const G=c.makeLinear(-1,-.05,1,.8),P=c.makeLinear(1,0,-1,-.4);window.updateValues=u,i(L),g.push({show:h})}if(console.log(g),at(...g),U.get("thumbnail")=="1"){const u=y.selectorQuery("g#foreground",SVGGElement);j=!0;const i=new Array;Array.from(u.children).forEach(n=>{const s=c.assertClass(n,SVGElement);s.dataset.live===void 0?s.style.display="none":(console.log("live",s.dataset.live),i.push(s))}),Q(0),y.selectorQueryAll("[data-reference]",SVGPathElement).forEach(n=>n.style.display="none");const h=Y(X,.5);[{name:"red",letter:"S"},{name:"white",letter:"V"},{name:"blue",letter:"G"}].forEach(({name:n,letter:s})=>{const f=h.get(s),a=f.shape.translate(f.advance/2,0).rawPath;y.selectorQueryAll(`[data-fourier-top="${n}"] [data-live]`,SVGPathElement,2,2).forEach(b=>{b.setAttribute("d",a)})}),y.selectorQueryAll("[data-fourier-top]",SVGGElement,3,3).forEach((n,s)=>{const f=getComputedStyle(n).transform,a=["-0.5px, -0.13px","-0.43px,-0.35px","-0.5px, -.13px"];n.style.transform=`${f} scale(4) translate(${a[s]})`}),window.showFrame=n=>{console.info("ignoring showFrame()",n)}}}
