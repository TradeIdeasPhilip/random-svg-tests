import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as u,m as H,A as $}from"./client-misc-CqK8Npau.js";import{R as T,m as tt,a as k,c as nt}from"./utility-Dy_Bs-fT.js";import{m as G,T as B}from"./letters-more-CV-mTeEn.js";import{m as et}from"./rough-lib-CvCwcX-1.js";import{H as st}from"./handwriting-effect-C7XdtHPU.js";import"./path-shape-C6cKjNL0.js";import"./math-to-path-D11qeOG5.js";const D=u("randomSeed",HTMLInputElement),ot=u("draw",HTMLButtonElement),it=u("timeInSeconds",HTMLInputElement),V=u("start",HTMLButtonElement),at=u("time",HTMLInputElement),w=u("handwriting",SVGGElement),x=u("morph",SVGGElement);ot.addEventListener("click",()=>{W()});const rt=Intl.NumberFormat(void 0,{useGrouping:!0,maximumFractionDigits:4}),ct=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:2,maximumFractionDigits:2}),mt=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:4,maximumFractionDigits:4});function W(){function s(t){const n=rt.format(t),e=t+1,i=t-1,o=e/i,m=i/e,g=(o+m)/2,d=o-g;return isFinite(g)&&isFinite(d)?{baseValueString:n,finite:!0,meanString:ct.format(g),errorString:mt.format(d)}:{baseValueString:n,finite:!1,errorMessage:"#DIV/0!"}}const f=[{strings:s(10001),finalRough:0},{strings:s(1001),finalRough:0},{strings:s(101),finalRough:0},{strings:s(11),finalRough:.2},{strings:s(2),finalRough:.9},{strings:s(1.1),finalRough:1},{strings:s(1.01),finalRough:"bad"},{strings:s(1.001),finalRough:"bad"},{strings:s(1.0001),finalRough:"very bad"},{strings:s(1),finalRough:0}];let c=D.value;T.seedIsValid(c)||(c=T.newSeed(),D.value=c);const S=T.create(c);w.innerHTML="",x.innerHTML="";class L{#n=new Array;get letters(){return[...this.#n]}#t=new B;constructor(n){n instanceof Map||(n=G(n)),this.#t.font=n,this.restart()}restart(){this.#t.restart(0,0),this.#n.length=0}addAndTag(n,e){const i=this.#t.addText(n),o=this.#n;i.forEach(m=>o.push({colorName:e,...m}))}get width(){return this.#t.x}extract(){const n={width:this.width,letters:this.letters};return this.restart(),n}single(n,e){return this.restart(),this.addAndTag(n,e),this.extract()}}const l=G(2.7),r=new L(l),p=r.single(" ÷ ","blue"),E=r.single(" → ","blue"),y=f.map(t=>{const n=t.strings;r.addAndTag("("+n.baseValueString,"blue"),r.addAndTag(" ± 1","white"),r.addAndTag(")","blue");const e=r.extract();if(n.finite){const i=r.single(n.meanString,"blue"),o=r.single(" ± "+n.errorString,"white");return{inputLayoutInfo:e,finite:!0,meanLayoutInfo:i,errorLayoutInfo:o}}else{const i=r.single(n.errorMessage,"gold");return{inputLayoutInfo:e,finite:!1,messageLayoutInfo:i}}});let a=7;const I=Math.max(...y.map(t=>t.inputLayoutInfo.width)),M=a+I/2;a+=I;const N=a;a+=p.width;const C=a+I/2;a+=I;const O=a;a+=E.width;const _=Math.max(...y.flatMap(t=>t.finite?[t.meanLayoutInfo.width]:[])),F=a;a+=_;const q=a,U=Math.max(...y.flatMap(t=>t.finite?[t.errorLayoutInfo.width]:[]));a+=U;const X=a,j=a,R=y.map((t,n)=>{const e=[],i=(n+1)*4.8*1.125;function o(d,h,b){b.forEach(A=>{e.push({...A,x:A.x+d,baseline:i,group:h})})}const m=M-t.inputLayoutInfo.width/2;o(m,"base",t.inputLayoutInfo.letters),o(N,"base",p.letters);const g=m-M+C;if(o(g,"base",t.inputLayoutInfo.letters),o(O,"base",E.letters),t.finite){const d=t.meanLayoutInfo;o(q-d.width,"mean",d.letters);const h=t.errorLayoutInfo;o(X-h.width,"error",h.letters)}else{const h=j-F-t.messageLayoutInfo.width,b=F+h/2;o(b,"base",t.messageLayoutInfo.letters)}return e}).flat().map(t=>{const n=et(t.description.shape,t.description.fontMetrics.strokeWidth,S),e=n.after,i=n.before;return{...t,roughShape:e,normalShape:i,description:{shape:e}}}),v=B.displayText(R,x).map(t=>{t.element.classList.add(t.colorName);const n=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],e=t.element.animate(n,{duration:1,fill:"both"});return e.pause(),e}),z=()=>{x.style.display="none"},J=t=>{k(t),x.style.display="";const n=t*v.length;v.forEach((e,i)=>{const o=n-i,m=Math.min(1,Math.max(0,o));e.currentTime=m})};{const t=new st(w);R.forEach(n=>{t.add({baseline:n.baseline,x:n.x,shape:n.description.shape}).forEach(({element:i})=>{i.classList.add(n.colorName)})})}const K=()=>{w.style.display="none"},Q=t=>{k(t),w.style.display="",w.style.setProperty("--t",t.toString())},Y=tt(2,1),Z=t=>{const n=Y(t);switch(n.index){case 0:{z(),Q(n.t);break}case 1:{K(),J(n.t);break}default:throw new Error("wtf")}};window.showFrame=Z,V.disabled=!1}let P;V.addEventListener("click",()=>{P?.cancel();const s=H.parseIntX(it.value);if(s===void 0)throw new Error("I don't want to do this better");let f=0,c;const S=nt(3),L=new $(l=>{if(c||(f=l+s*1e3,c=H.makeLinear(l,0,f,1)),l>f)L.cancel(),window.showFrame(1);else{const r=c(l),p=S(r);at.value=p.toString(),window.showFrame(p)}});P=L});function dt(){return W(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(s=>{if(!(s instanceof SVGElement||s instanceof HTMLElement))throw new Error("wtf");s.style.display="none"}),{source:"show-text-1.ts",devicePixelRatio}}window.initScreenCapture=dt;
