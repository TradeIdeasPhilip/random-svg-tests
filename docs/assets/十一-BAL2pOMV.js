import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as h,m as R,A as Z}from"./client-misc-CqK8Npau.js";import{R as b,m as tt,a as k}from"./utility-CcMiQaH1.js";import{m as H,T as P}from"./letters-more-CV-mTeEn.js";import{m as et}from"./rough-lib-CvCwcX-1.js";import"./path-shape-C6cKjNL0.js";import"./math-to-path-D11qeOG5.js";const V=h("randomSeed",HTMLInputElement),nt=h("draw",HTMLButtonElement),ot=h("timeInSeconds",HTMLInputElement),D=h("start",HTMLButtonElement),st=h("time",HTMLInputElement),f=h("handwriting",SVGGElement),S=h("morph",SVGGElement);nt.addEventListener("click",()=>{N()});const at=Intl.NumberFormat(void 0,{useGrouping:!0,maximumFractionDigits:4}),rt=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:2,maximumFractionDigits:2}),it=Intl.NumberFormat(void 0,{useGrouping:!0,minimumFractionDigits:4,maximumFractionDigits:4}),ct="#DIV/0!";function N(){const g=[10001,1001,101,11,2,1.1,1.01,1.001,1.0001,1].map(t=>{const e=at.format(t),n=t+1,a=t-1,o=n/a,r=a/n,m=(o+r)/2,i=o-m,l=isFinite(m)&&isFinite(i)?{finite:!0,meanString:rt.format(m),errorString:it.format(i)}:{finite:!1};return{baseValue:t,baseValueString:e,mean:m,error:i,...l}});let d=V.value;b.seedIsValid(d)||(d=b.newSeed(),V.value=d);const w=b.create(d);f.innerHTML="",S.innerHTML="";class p{#e=new Array;get letters(){return[...this.#e]}#t=new P;constructor(e){e instanceof Map||(e=H(e)),this.#t.font=e,this.restart()}restart(){this.#t.restart(0,0),this.#e.length=0}addAndTag(e,n){const a=this.#t.addText(e),o=this.#e;a.forEach(r=>o.push({colorName:n,...r}))}get width(){return this.#t.x}extract(){const e={width:this.width,letters:this.letters};return this.restart(),e}single(e,n){return this.restart(),this.addAndTag(e,n),this.extract()}}const y=H(2.7),c=new p(y),T=c.single(" ÷ ","blue"),E=c.single(" → ","blue"),L=g.map(t=>{c.addAndTag("("+t.baseValueString,"blue"),c.addAndTag(" ± 1","white"),c.addAndTag(")","blue");const e=c.extract();if(t.finite){const n=c.single(t.meanString,"blue"),a=c.single(" ± "+t.errorString,"white");return{...t,inputLayoutInfo:e,meanLayoutInfo:n,errorLayoutInfo:a}}else{const n=c.single(ct,"gold");return{...t,inputLayoutInfo:e,messageLayoutInfo:n}}});let s=7;const I=Math.max(...L.map(t=>t.inputLayoutInfo.width)),M=s+I/2;s+=I;const O=s;s+=T.width;const W=s+I/2;s+=I;const C=s;s+=E.width;const _=Math.max(...L.flatMap(t=>t.meanLayoutInfo?[t.meanLayoutInfo.width]:[])),v=s;s+=_;const U=s,X=Math.max(...L.flatMap(t=>t.errorLayoutInfo?[t.errorLayoutInfo.width]:[]));s+=X;const $=s,q=s,F=L.map((t,e)=>{const n=[],a=(e+1)*4.8*1.125;function o(i,l,x){x.forEach(G=>{n.push({...G,x:G.x+i,baseline:a,group:l})})}const r=M-t.inputLayoutInfo.width/2;o(r,"base",t.inputLayoutInfo.letters),o(O,"base",T.letters);const m=r-M+W;if(o(m,"base",t.inputLayoutInfo.letters),o(C,"base",E.letters),t.messageLayoutInfo){const l=q-v-t.messageLayoutInfo.width,x=v+l/2;o(x,"base",t.messageLayoutInfo.letters)}else{const i=t.meanLayoutInfo;o(U-i.width,"mean",i.letters);const l=t.errorLayoutInfo;o($-l.width,"error",l.letters)}return n}).flat().map(t=>{const e=et(t.description.shape,t.description.fontMetrics.strokeWidth,w),n=e.after,a=e.before;return{...t,roughShape:n,normalShape:a,description:{shape:n}}}),A=P.displayText(F,S).map(t=>{t.element.classList.add(t.colorName);const e=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],n=t.element.animate(e,{duration:1,fill:"both"});return n.pause(),n}),j=()=>{S.style.display="none"},z=t=>{k(t),S.style.display="";const e=t*A.length;A.forEach((n,a)=>{const o=e-a,r=Math.min(1,Math.max(0,o));n.currentTime=r})};{let t=.01;F.forEach(e=>{e.roughShape.splitOnMove().map(a=>{const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",a.rawPath),o.style.transform=`translate(${e.x}px, ${e.baseline}px)`,o.classList.add(e.colorName),f.appendChild(o);const r=t,m=o.getTotalLength();t=r+m,o.style.setProperty("--offset",r.toString()),o.style.setProperty("--length",m.toString())});const n=t;f.style.setProperty("--total-length",n.toString())})}const J=()=>{f.style.display="none"},K=t=>{k(t),f.style.display="",f.style.setProperty("--t",t.toString())},Q=tt(2,1),Y=t=>{const e=Q(t);switch(e.index){case 0:{j(),K(e.t);break}case 1:{J(),z(e.t);break}default:throw new Error("wtf")}};window.showFrame=Y,D.disabled=!1}let B;D.addEventListener("click",()=>{B?.cancel();const u=R.parseIntX(ot.value);if(u===void 0)throw new Error("I don't want to do this better");let g=0,d;const w=new Z(p=>{if(d||(g=p+u*1e3,d=R.makeLinear(p,0,g,1)),p>g)w.cancel(),window.showFrame(1);else{const y=d(p);st.value=y.toString(),window.showFrame(y)}});B=w});function mt(){return N(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(u=>{if(!(u instanceof SVGElement||u instanceof HTMLElement))throw new Error("wtf");u.style.display="none"}),{source:"show-text-1.ts",devicePixelRatio}}window.initScreenCapture=mt;
