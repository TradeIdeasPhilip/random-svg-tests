import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as m}from"./client-misc-B8CxQsfg.js";import{b as Z,s as J,h as Q,t as B}from"./fourier-shared-DpvWsPe-.js";import{p as j,d as W,b as X,P as _}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as A,e as Y}from"./utility-Dgy6CMn3.js";function ee(){document.body.style.backgroundColor="transparent",m.selectorQueryAll("[data-hide-background]",SVGElement).forEach(c=>c.style.display="none")}function te(){const c=m.selectorQuery("[data-hide-background]",SVGElement);c.parentElement?.append(c)}{const c=a.Random.fromString("Good Night ðŸŒ›"),e=m.selectorQuery("[data-favorite]",SVGCircleElement),t=a.makeLinear(0,.025,2,.15);for(let r=0;r<150;r++){const n=a.assertClass(e.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=c()*16,n.cy.baseVal.value=c()*9,n.r.baseVal.value=t(c()+c()),e.parentElement.append(n)}}const U=new URLSearchParams(window.location.search);let H=!1;U.get("hide_background")=="1"?ee():U.get("only_background")=="1"&&te();{const e=m.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");e.filter="url(#watercolor)";const t=1;e.scale(t,t)}const ne=1024;class se{#e;constructor(e){e instanceof SVGGElement||(e=m.selectorQuery(e,SVGGElement)),this.#e=m.selectorQueryAll("g.frequency",SVGGElement,0,1/0,e).map(t=>{const r=m.selectorQuery("text",SVGTextElement,t),n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.classList.add("background"),t.insertBefore(n,r),{top:t,spinner:m.selectorQuery(".spinner",SVGPolygonElement,t),text:r,background:n}})}show(e,t){this.#e.forEach((r,n,u)=>{if(n>=e.length)r.top.style.display="none";else{r.top.style.display="";const S=e[n];let x=S.frequency.toString();n==u.length-1&&u.length<e.length&&(x+=", â€¦"),r.background.innerHTML=r.text.innerHTML=x,r.spinner.style.transform=`rotate(${t*S.frequency+S.phase+a.FULL_CIRCLE/4}rad)`}})}}function T(c,e){if(c>=e)throw new Error("wtf");const t=a.makeLinear(c,0,e,1);function r(n){if(n<=c)return 0;if(n>=e)return 1;const u=t(n);return Y(u)}return r}let q=()=>{};window.showFrame=c=>{q(c)};class ${constructor(e,t){this.getTransform=t,this.#e=e,this.#n=m.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=m.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#e)}#e;#n;#t;hide(){this.#e.style.display="none"}show(e,t){this.#e.style.display="",this.#n.style.stroke=e}setReferencePath(e){this.#n.setAttribute("d",e)}setLivePath(e){this.#t.forEach(t=>t.setAttribute("d",e))}setTransform(e){const t=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",t.toString())}static right=new $(m.getById("right",SVGGElement),e=>j(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const z=new W;class re{constructor(e,t,r=0,n=t-r){this.stepCount=e,this.period=t,this.#e=a.makeBoundedLinear(r,0,n,1),this.endTime=t*e}#e;endTime;get(e){let t=Math.floor(e/this.period),r;t<0?(t=0,r=0):t>=this.stepCount?(t=this.stepCount-1,r=this.period):r=e%this.period;const n=this.#e(r);return{index:t,t:n}}}class oe{constructor(e){this.pathString=e,this.samples=Z(e,ne),this.terms=J(this.samples),this.keyframes=a.initializedArray(21,t=>t)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(e){const t=this.makeGetPath2();function r(n){const{index:u,t:S}=e.get(n);return t(u,S)}return r}makeGetPath2(){const e=[...this.terms],t=[...this.keyframes],r=this.stepCount,n=p=>Math.max(...e.slice(0,p).map(y=>Math.abs(y.frequency))),u=p=>{if(p==0)return 8;{const d=n(p);return 8*Math.min(d,50)+7}},S=a.initializedArray(r,p=>{const d=t[p],y=t[p+1];if(d==0&&y==1&&e[0].frequency==0){let V=function(i){return`${l.x*i},${l.y*i}`};const l=a.assertNonNullable(Q(e[0])),o=T(0,.5),s=T(0,1);return i=>{const h=s(i),w=V(h),E=o(i),b=V(E);return`M ${w} L ${b}`}}else if(d==y){const V=B(e,d),l=u(y),s=_.glitchFreeParametric(V,l).rawPath;return i=>s}else{const l=.2/Math.abs(e[d].frequency),o=a.makeBoundedLinear(0,-l,1,1+l),s=B(e,d),i=B(e,y-d,d),h=u(y);if(d==0||d==1&&Q(e[0])){const w=Q(e[0])??{x:0,y:0};return E=>{const b=o(E),g=b-l,k=b+l,C=T(g,k),f=Math.min(1,k);if(f<=0)return`M${w.x},${w.y} L${w.x},${w.y}`;{let P=function(v){v=v*f;const L=s(v),R=1-C(v);if(R==0)return L;{const I=i(v);return{x:L.x+R*I.x,y:L.y+R*I.y}}};const F=Math.ceil(Math.max(h,150)*f);return _.glitchFreeParametric(P,F).rawPath}}}else return w=>{const E=o(w),b=T(E-l,E+l);function g(C){const f=s(C),P=1-b(C);if(P==0)return f;{const F=i(C);return{x:f.x+P*F.x,y:f.y+P*F.y}}}return _.glitchFreeParametric(g,h).rawPath}}});function x(p,d){const y=S[p];return y(d)}return x}}class O{hide(){this.#t.hide()}#e;show(e){this.#t.show(this.#s,this.#r),this.#t.setReferencePath(this.#n),this.#t.setTransform(this.#o),this.#e(e)}timer;#n;#t;#s;#r;#o;base;constructor(e){this.base=e.base,this.#n=e.base.pathString,this.#t=e.destination,this.#s=e.referenceColor,this.#r=e.liveColor,z.d=this.#n,this.#o=this.#t.getTransform(z.getBBox());const t=7e3,r=750;this.timer=new re(e.base.stepCount,t,r);const n=e.base.makeGetPath1(this.timer);this.#e=u=>{const S=n(u);this.#t.setLivePath(S)}}}function ae(...c){q=e=>{c.forEach(t=>t.show(e))}}let N;setTimeout(()=>{if(H)return;let c=NaN;N=new m.AnimationLoop(e=>{isNaN(c)&&(c=e);const t=e-c;q(t)}),window.animationLoop=N},1);function ie(c){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),N?.cancel(),{source:"fourier-smackdown.ts",script:c,seconds:7*14+20,devicePixelRatio}}window.initScreenCapture=ie;class ce{constructor(e,t){this.vertex1=e,this.vertex2=t}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class M{constructor(e,t){this.pathSoFar=e,this.remainingEdges=t}oneStep(){const e=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((t,r)=>{const n=t.other(e);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new M([...this.pathSoFar,n],this.remainingEdges.toSpliced(r,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const t of e)yield*t.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const t=Math.max(...e.map(n=>Math.max(n.vertex1,n.vertex2)))+1,r=new Set;for(const n of this.get(e)){const u=n.slice(0,n.length-1),S=this.#n(u);if(!r.has(S)){yield n,r.add(S);const x=this.#t(u,t).map(p=>this.#n(p));for(const p of x)r.add(p)}}}static#n(e){return String.fromCharCode(...e.map(t=>t+65))}static#t(e,t){const r=new Array;for(let n=1;n<e.length;n++){const u=e[n],S=(u+1)%t,x=A(e,n+1);S==x?r.push(a.initializedArray(e.length,p=>{const d=A(e,p+n);return a.positiveModulo(d-u,t)})):A(e,n-1)==S&&r.push(a.initializedArray(e.length,d=>{const y=A(e,n-d);return a.positiveModulo(y-u,t)}))}return r}static getSamples(){function e(t,...r){return a.initializedArray(t,n=>r.map(u=>new ce(n,(n+u)%t))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=M;function le(){const c=M.getSamples(),e=M.getUnique(c.pentagram);console.log(e,e.constructor.name);for(const t of e);}le();{let c=function(l,o=0){o==0&&console.table(l.terms.slice(0,20));const s=[],i=l.terms,h=i.length,w=7,E=14,b=i.splice(3,3),g=[];for(b.forEach((f,P)=>{(o&2**P)>0?(s.push([f]),g.push([])):(s.push([]),g.push([f]))});s.length<E-1-g.length;){let f;s.length<6?f=1:s.length<8?f=2:f=3;const P=i.splice(0,f);if(P.length!=f)throw new Error("wtf");s.push(P)}const k=s.splice(5,1)[0];if(s.splice(0,0,k),s.splice(w,0,[...i]),s.push(...g),console.log(s),s.length!=E)throw new Error("wtf");if(i.length=0,i.length!=0)throw new Error("wtf");const C=l.keyframes;if(C.length=0,C.push(0),s.forEach(f=>{i.push(...f),C.push(i.length)}),i.length!=h)throw new Error("wtf")};class e{constructor(o){throw new Error("wtf")}static points=a.initializedArray(5,o=>{const s=a.FULL_CIRCLE*o/5+a.FULL_CIRCLE/4,i=Math.cos(s),h=Math.sin(s);return{x:i,y:h}});static allPaths=[...M.getUnique(M.getSamples().pentagram)]}class t{constructor(o){throw new Error("wtf")}static points=a.initializedArray(6,o=>{const s=a.FULL_CIRCLE*o/6+a.FULL_CIRCLE/4,i=Math.cos(s),h=Math.sin(s);return{x:i,y:h}});static allPaths=[...M.getUnique(M.getSamples().dodecahedron)];static makePathShape(o){const s=this.allPaths[o],i=X.M(r[0].x,r[0].y);return s.forEach((h,w)=>{if(w==0){if(h!=0)throw new Error("wtf")}else{const{x:E,y:b}=r[h],g=s[w-1];switch(a.positiveModulo(h-g,6)){case 1:{i.arc(0,0,E,b,"cw");break}case 2:case 4:{i.L(E,b);break}case 5:{i.arc(0,0,E,b,"ccw");break}default:throw new Error("wtf")}}}),i.pathShape}}const r=t.points,n=t.allPaths,u=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],S=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(n.length,()=>{const l=S()*3|0,o=u[l];return u.splice(l,1),u.push(o),o});const x=40,p=[{color:"red",destRect:{x:.5,y:4.5,width:3,height:3},index:x},{color:"yellow",destRect:{x:4.5,y:1.5,width:3,height:3},index:x},{color:"lime",destRect:{x:4.5,y:5.5,width:3,height:3},index:x},{color:"cyan",destRect:{x:8.5,y:.5,width:3,height:3},index:x},{color:"white",destRect:{x:8.5,y:4.5,width:3,height:3},index:x},{color:"blue",destRect:{x:12.5,y:1.5,width:3,height:3},index:x},{color:"magenta",destRect:{x:12.5,y:5.5,width:3,height:3},index:x}],d=p.map(({index:l})=>{const o=t.makePathShape(l).rawPath;return new oe(o)});console.log(d),d.forEach((l,o)=>{c(l,o+1)});const y=new Array,V=m.selectorQuery("g#foreground",SVGGElement);for(const[l,o]of a.zip(p,d)){const{color:s,destRect:i,search:h}=l,w=h===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):m.selectorQuery(`g.frequencies[data-frequencies="${h}"]`,SVGGElement),E=h===void 0?V.appendChild(a.assertClass(m.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):m.selectorQuery(`[data-fourier-top="${h}"]`,SVGGElement);E.style.setProperty("--color",s);const b=new $(E,C=>j(C,i,"srcRect fits completely into destRect"));w.style.fill=s;const g={base:o,destination:b,liveColor:s,referenceColor:s},k=new O(g);y.push(k),console.log(k)}{let l=function(g){const{index:k,t:C}=i.get(g);o.show(h[k],C*a.FULL_CIRCLE)};const o=new se('[data-frequencies="red"]'),s=a.assertClass(y.at(-1),O),i=s.timer,h=new Array,{keyframes:w,terms:E}=s.base;w.forEach((g,k)=>{const C=k-1;if(C>=0){const f=w[C],P=E.slice(f,g);h.push(P)}});const b=h.splice(h.length-3,3,...h.slice(1,4));if(b.length!=3)throw new Error("wtf");b.forEach(g=>{if(g.length!=0)throw new Error("wtf")}),console.log(h),y.push({show:l})}{let l=function(F,G){const L=[F,F+a.FULL_CIRCLE/3,F-a.FULL_CIRCLE/3].map(K=>f(Math.sin(K)));L.push(0),L.push(P(Math.cos(G)));const R=L.join(" "),D=[R,R,R,"0 0 0 0 1"].join(`
`);i.setAttribute("values",D)},o=function(F){const G=h.map(v=>[]);F.forEach(v=>{if(v.length!=h.length)throw new Error("wtf");v.forEach((L,R)=>{G[R].push(L)})});for(const[v,L]of a.zip(h,G))v.setAttribute("tableValues",L.join(" "))},s=function(F){const G=F/24e4*a.FULL_CIRCLE*2,v=F/24e4*a.FULL_CIRCLE/2;l(G,v)};const i=m.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),h=[m.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),m.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),m.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],k=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),C=a.makeLinear(0,0,255,1);k.forEach(F=>F.forEach((G,v,L)=>L[v]=C(G)));const f=a.makeLinear(-1,-.05,1,.8),P=a.makeLinear(1,0,-1,-.4);window.updateValues=l,o(k),y.push({show:s})}if(console.log(y),ae(...y),U.get("thumbnail")=="1"){H=!0;const l=new Array;Array.from(V.children).forEach(o=>{const s=a.assertClass(o,SVGElement);s.dataset.live===void 0?s.style.display="none":(console.log("live",s.dataset.live),l.push(s))}),q(7e3*4.15),m.selectorQueryAll("[data-reference]",SVGPathElement).forEach(o=>o.style.display="none"),m.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(o=>{o.style.transform="scale(3)",o.style.transformOrigin=`${o.cx.baseVal.value}px ${o.cy.baseVal.value}px`}),window.showFrame=o=>{console.info("ignoring showFrame()",o)}}}
