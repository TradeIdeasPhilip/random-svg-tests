import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as p}from"./client-misc-B8CxQsfg.js";import{b as W,s as X,h as _,t as B}from"./fourier-shared-DpvWsPe-.js";import{p as D,d as Y,b as tt,P as U}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as I,e as et}from"./utility-Dgy6CMn3.js";function nt(){document.body.style.backgroundColor="transparent",p.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function st(){const i=p.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}{const i=a.Random.fromString("Pastel 41"),t=p.selectorQuery("[data-favorite]",SVGCircleElement),e=a.makeLinear(0,.025,2,.15);for(let s=0;s<150;s++){const n=a.assertClass(t.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=i()*16,n.cy.baseVal.value=i()*9,n.r.baseVal.value=e(i()+i()),t.parentElement.append(n)}}const N=new URLSearchParams(window.location.search);let K=!1;N.get("hide_background")=="1"?nt():N.get("only_background")=="1"&&st();{const t=p.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const rt=1024;class ot{#t;constructor(t){t instanceof SVGGElement||(t=p.selectorQuery(t,SVGGElement)),this.#t=p.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(e=>{const s=p.selectorQuery("text",SVGTextElement,e),n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.classList.add("background"),e.insertBefore(n,s),{top:e,spinner:p.selectorQuery(".spinner",SVGPolygonElement,e),text:s,background:n}})}show(t,e){this.#t.forEach((s,n,m)=>{if(n>=t.length)s.top.style.display="none";else{s.top.style.display="";const y=t[n];let F=y.frequency.toString();n==m.length-1&&m.length<t.length&&(F+=", â€¦"),s.background.innerHTML=s.text.innerHTML=F,s.spinner.style.transform=`rotate(${e*y.frequency+y.phase+a.FULL_CIRCLE/4}rad)`}})}}function Q(i,t){if(i>=t)throw new Error("wtf");const e=a.makeLinear(i,0,t,1);function s(n){if(n<=i)return 0;if(n>=t)return 1;const m=e(n);return et(m)}return s}let z=()=>{};window.showFrame=i=>{z(i)};class O{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=p.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=p.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new O(p.getById("right",SVGGElement),t=>D(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const j=new Y;class at{constructor(t,e,s=0,n=e-s){this.stepCount=t,this.period=e,this.#t=a.makeBoundedLinear(s,0,n,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),s;e<0?(e=0,s=0):e>=this.stepCount?(e=this.stepCount-1,s=this.period):s=t%this.period;const n=this.#t(s);return{index:e,t:n}}}class it{constructor(t){this.pathString=t,this.samples=W(t,rt),this.terms=X(this.samples),this.keyframes=a.initializedArray(21,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function s(n){const{index:m,t:y}=t.get(n);return e(m,y)}return s}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],s=this.stepCount,n=f=>Math.max(...t.slice(0,f).map(S=>Math.abs(S.frequency))),m=f=>{if(f==0)return 8;{const h=n(f);return 8*Math.min(h,50)+7}},y=a.initializedArray(s,f=>{const h=e[f],S=e[f+1];if(h==0&&S==1&&t[0].frequency==0){let V=function(c){return`${C.x*c},${C.y*c}`};const C=a.assertNonNullable(_(t[0])),x=Q(0,.5),G=Q(0,1);return c=>{const o=G(c),r=V(o),l=x(c),u=V(l);return`M ${r} L ${u}`}}else if(h==S){const V=B(t,h),C=m(S),G=U.glitchFreeParametric(V,C).rawPath;return c=>G}else{const C=.2/Math.abs(t[h].frequency),x=a.makeBoundedLinear(0,-C,1,1+C),G=B(t,h),c=B(t,S-h,h),o=m(S);if(h==0||h==1&&_(t[0])){const r=_(t[0])??{x:0,y:0};return l=>{const u=x(l),w=u-C,b=u+C,g=Q(w,b),d=Math.min(1,b);if(d<=0)return`M${r.x},${r.y} L${r.x},${r.y}`;{let E=function(A){A=A*d;const k=G(A),v=1-g(A);if(v==0)return k;{const P=c(A);return{x:k.x+v*P.x,y:k.y+v*P.y}}};const L=Math.ceil(Math.max(o,150)*d);return U.glitchFreeParametric(E,L).rawPath}}}else return r=>{const l=x(r),u=Q(l-C,l+C);function w(g){const d=G(g),E=1-u(g);if(E==0)return d;{const L=c(g);return{x:d.x+E*L.x,y:d.y+E*L.y}}}return U.glitchFreeParametric(w,o).rawPath}}});function F(f,h){const S=y[f];return S(h)}return F}}class H{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}timer;#n;#e;#s;#r;#o;base;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,j.d=this.#n,this.#o=this.#e.getTransform(j.getBBox());const e=7e3,s=750;this.timer=new at(t.base.stepCount,e,s);const n=t.base.makeGetPath1(this.timer);this.#t=m=>{const y=n(m);this.#e.setLivePath(y)}}}function ct(...i){z=t=>{i.forEach(e=>e.show(t))}}let $;setTimeout(()=>{if(K)return;let i=NaN;$=new p.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;z(e)}),window.animationLoop=$},1);function lt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),$?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:7*14+20,devicePixelRatio}}window.initScreenCapture=lt;class ht{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class R{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,s)=>{const n=e.other(t);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new R([...this.pathSoFar,n],this.remainingEdges.toSpliced(s,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(n=>Math.max(n.vertex1,n.vertex2)))+1,s=new Set;for(const n of this.get(t)){const m=n.slice(0,n.length-1),y=this.#n(m);if(!s.has(y)){yield n,s.add(y);const F=this.#e(m,e).map(f=>this.#n(f));for(const f of F)s.add(f)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const s=new Array;for(let n=1;n<t.length;n++){const m=t[n],y=(m+1)%e,F=I(t,n+1);y==F?s.push(a.initializedArray(t.length,f=>{const h=I(t,f+n);return a.positiveModulo(h-m,e)})):I(t,n-1)==y&&s.push(a.initializedArray(t.length,h=>{const S=I(t,n-h);return a.positiveModulo(S-m,e)}))}return s}static getSamples(){function t(e,...s){return a.initializedArray(e,n=>s.map(m=>new ht(n,(n+m)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=R;function ut(){const i=R.getSamples(),t=R.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}ut();{let i=function(c,o,r){const l=o-c,u=r-c,w=2*c,b=2*c;return{x:l,y:u,width:w,height:b}},t=function(c,o=0){o==0&&console.table(c.terms.slice(0,20));const r=[],l=c.terms,u=l.length,w=3+2*o,b=12;for(;r.length<b-1;){let d;r.length<6?d=1:r.length<8?d=2:d=5;const E=l.splice(0,d);if(E.length!=d)throw new Error("wtf");r.push(E)}if(r.splice(w,0,[...l]),console.log(r),r.length!=b)throw new Error("wtf");if(l.length=0,l.length!=0)throw new Error("wtf");const g=c.keyframes;if(g.length=0,g.push(0),r.forEach(d=>{l.push(...d),g.push(l.length)}),l.length!=u)throw new Error("wtf")};class e{constructor(o){throw new Error("wtf")}static points=a.initializedArray(5,o=>{const r=a.FULL_CIRCLE*o/5+a.FULL_CIRCLE/4,l=Math.cos(r),u=Math.sin(r);return{x:l,y:u}});static allPaths=[...R.getUnique(R.getSamples().pentagram)]}class s{constructor(o){throw new Error("wtf")}static points=a.initializedArray(6,o=>{const r=a.FULL_CIRCLE*o/6+a.FULL_CIRCLE/4,l=Math.cos(r),u=Math.sin(r);return{x:l,y:u}});static allPaths=[...R.getUnique(R.getSamples().dodecahedron)];static makePathShape(o){const r=this.allPaths[o],l=tt.M(n[0].x,n[0].y);return r.forEach((u,w)=>{if(w==0){if(u!=0)throw new Error("wtf")}else{const{x:b,y:g}=n[u],d=r[w-1];switch(a.positiveModulo(u-d,6)){case 1:{l.arc(0,0,b,g,"cw");break}case 2:case 4:{l.L(b,g);break}case 5:{l.arc(0,0,b,g,"ccw");break}default:throw new Error("wtf")}}}),l.pathShape}}const n=s.points,m=s.allPaths,y=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],F=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(m.length,()=>{const c=F()*3|0,o=y[c];return y.splice(c,1),y.push(o),o});const f=41,h=9/4,S=.8,V=[{color:"red",destRect:i(h*S,16-h,h),index:f},{color:"yellow",destRect:i(h*S,16-3*h,h),index:f},{color:"lime",destRect:i(7/2*S,7/2,9/2),index:f},{color:"cyan",destRect:i(h*S,16-3*h,3*h),index:f},{color:"white",destRect:i(h*S,16-h,3*h),index:f}],C=V.map(({index:c})=>{const o=s.makePathShape(c).rawPath;return new it(o)});console.log(C),C.forEach((c,o)=>{t(c,o)});const x=new Array,G=p.selectorQuery("g#foreground",SVGGElement);for(const[c,o,{light:r,dark:l}]of a.zip(V,C,y)){const{destRect:u,search:w}=c,b=w===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):p.selectorQuery(`g.frequencies[data-frequencies="${w}"]`,SVGGElement),g=w===void 0?G.appendChild(a.assertClass(p.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):p.selectorQuery(`[data-fourier-top="${w}"]`,SVGGElement);g.style.setProperty("--color",r),g.style.setProperty("--blur-color",l);const d=new O(g,q=>D(q,u,"srcRect fits completely into destRect"));b.style.fill=l;const E={base:o,destination:d,liveColor:l,referenceColor:r},L=new H(E);x.push(L),console.log(L)}{let c=function(g){const{index:d,t:E}=l.get(g);o.show(u[d],E*a.FULL_CIRCLE)};const o=new ot('[data-frequencies="red"]'),r=a.assertClass(x.at(2),H),l=r.timer,u=new Array,{keyframes:w,terms:b}=r.base;w.forEach((g,d)=>{const E=d-1;if(E>=0){const L=w[E],q=b.slice(L,g);u.push(q)}}),console.log(u),x.push({show:c})}{let c=function(k,v){const M=[k,k+a.FULL_CIRCLE/3,k-a.FULL_CIRCLE/3].map(J=>q(Math.sin(J)));M.push(0),M.push(A(Math.cos(v)));const T=M.join(" "),Z=[T,T,T,"0 0 0 0 1"].join(`
`);l.setAttribute("values",Z)},o=function(k){const v=u.map(P=>[]);k.forEach(P=>{if(P.length!=u.length)throw new Error("wtf");P.forEach((M,T)=>{v[T].push(M)})});for(const[P,M]of a.zip(u,v))P.setAttribute("tableValues",M.join(" "))},r=function(k){const v=k/24e4*a.FULL_CIRCLE*2,P=k/24e4*a.FULL_CIRCLE/2;c(v,P)};const l=p.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),u=[p.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),p.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),p.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],E=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),L=a.makeLinear(0,0,255,1);E.forEach(k=>k.forEach((v,P,M)=>M[P]=L(v)));const q=a.makeLinear(-1,-.05,1,.8),A=a.makeLinear(1,0,-1,-.4);window.updateValues=c,o(E),x.push({show:r})}if(console.log(x),ct(...x),N.get("thumbnail")=="1"){K=!0;const c=new Array;Array.from(G.children).forEach(o=>{const r=a.assertClass(o,SVGElement);r.dataset.live===void 0?r.style.display="none":(console.log("live",r.dataset.live),c.push(r))}),x.forEach((o,r)=>{o.show(8500+950*r)}),p.selectorQueryAll("[data-reference]",SVGPathElement).forEach(o=>o.style.display="none"),p.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(o=>{o.style.transform="scale(3)",o.style.transformOrigin=`${o.cx.baseVal.value}px ${o.cy.baseVal.value}px`})}}
