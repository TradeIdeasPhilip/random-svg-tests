import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as y}from"./client-misc-B8CxQsfg.js";import{b as _,s as H,t as M,g as j,h as O}from"./fourier-shared-_PrSLLN4.js";import{p as I,d as K,b as X,c as Z,P as $}from"./path-shape-CZZKMsju.js";import{m as l}from"./misc-BHUyxQfl.js";import{g as R,e as J}from"./utility-Dgy6CMn3.js";const W=1024,D=y.getById("scaled",SVGGElement),q=y.selectorQuery("[data-reference]",SVGPathElement),z=y.selectorQuery("[data-live]",SVGPathElement);function E(a,e){if(a>=e)throw new Error("wtf");const t=l.makeLinear(a,0,e,1);function o(s){if(s<=a)return 0;if(s>=e)return 1;const i=t(s);return J(i)}return o}let N=()=>{};window.showFrame=a=>{N(a)};class Q{constructor(e,t){this.getTransform=t,this.#e=y.selectorQuery(e,SVGGElement),this.#s=y.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=y.selectorQuery("[data-live]",SVGPathElement,this.#e)}#e;#s;#t;hide(){this.#e.style.display="none"}show(e,t){this.#e.style.display="",this.#s.style.stroke=e,this.#t.style.stroke=t}setReferencePath(e){this.#s.setAttribute("d",e)}setLivePath(e){this.#t.setAttribute("d",e)}setTransform(e){const t=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",t.toString())}static right=new Q("#scaled",e=>I(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}class Y{#e=y.getById("backgroundCanvas",HTMLCanvasElement);#s;constructor(e){this.#s=this.#r(e)}#t=l.assertNonNullable(this.#e.getContext("2d",{colorSpace:"display-p3"}));#r(e){y.selectorQuery("feTurbulence",SVGFETurbulenceElement).seed.baseVal=e;const t=document.createElement("canvas");t.width=3840,t.height=2160;const o=t.getContext("2d",{colorSpace:"display-p3"}),s=o.createLinearGradient(0,0,3840,2160);return s.addColorStop(0,"hsl(220, 10%, 30%)"),s.addColorStop(1,"hsl(220, 15%, 40%)"),o.fillStyle=s,o.globalCompositeOperation="source-over",o.filter="url(#noiseFilter)",o.fillStyle="rgb(255, 165, 0)",o.fillRect(0,0,3840,2160),o.filter="none",o.globalCompositeOperation="source-over",t}#o=l.makeLinear(-1,.333,1,.667);#n=0;addDebugText(e){const t=this.#n*216+108;this.#n=(this.#n+1)%10,this.#t.font="100px sans-serif",this.#t.fillStyle="white",this.#t.fillText(e,20,t)}draw(e){const t=this.#t;t.drawImage(this.#s,0,0);const o=[0,l.FULL_CIRCLE/3,l.FULL_CIRCLE*(2/3)],s=6e4,i=e%s/s*l.FULL_CIRCLE,[u,p,h]=o.map(g=>this.#o(Math.sin(i+g)));t.globalCompositeOperation="multiply",t.fillStyle=`rgb(${u*255}, ${p*255}, ${h*255})`,t.fillRect(0,0,3840,2160),t.globalCompositeOperation="source-over"}extract(e){e!==void 0&&this.draw(e);const{promise:t,resolve:o,reject:s}=Promise.withResolvers();return this.#e.toBlob(i=>{i?o(i):s("wtf")},"image/png",1),t}}new K;function ee(a){q.setAttribute("d",a.pathString);const e=I(q.getBBox(),{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1),t=e.a;D.style.transform=e.toString(),D.style.setProperty("--path-scale",t.toString());const o=_(a.pathString,W),s=H(o);window.debugPath=n=>{const c=M(s,n),r=new Z(c);r.go(5e3),r.dump(),console.log(r),q.setAttribute("d",r.pathShape.rawPath)},console.log("Try debugPath(2);");const i=j({addTime:4800,pauseTime:200,maxGroupsToDisplay:a.maxGroupsToDisplay,terms:s}),u=n=>Math.max(...s.slice(0,n).map(r=>Math.abs(r.frequency))),p=n=>8*u(n)+7,h=i.map(n=>{if(n.addingCircles==0){const c=M(s,n.usingCircles),r=p(n.usingCircles),d=$.glitchFreeParametric(c,r);return()=>d.rawPath}else if(n.usingCircles==0&&n.addingCircles==1&&s[0].frequency==0){let c=function(f){return`${w.x*f},${w.y*f}`};const{startTime:r,endTime:d}=n,m=d-r,x=E(r,r+m/2),F=E(r,d),w=O(s[0]);return f=>{const P=F(f),v=c(P),k=x(f),C=c(k);return`M ${v} L ${C}`}}else{const r=.2/u(n.usingCircles+n.addingCircles),d=l.makeBoundedLinear(n.startTime,-r,n.endTime,1+r),m=M(s,n.usingCircles),x=M(s,n.addingCircles,n.usingCircles);let F=p(n.usingCircles+n.addingCircles);if(n.usingCircles==0||n.usingCircles==1&&O(s[0])){const w=O(s[0])??{x:0,y:0};return f=>{const P=d(f),v=P-r,k=P+r,C=E(v,k),S=Math.min(1,k);if(S<=0)return`M${w.x},${w.y} L${w.x},${w.y}`;{let L=function(T){T=T*S;const G=m(T),A=1-C(T);if(A==0)return G;{const U=x(T);return{x:G.x+A*U.x,y:G.y+A*U.y}}};const V=Math.ceil(Math.max(F,150)*S);return $.glitchFreeParametric(L,V).rawPath}}}else return w=>{const f=d(w),P=E(f-r,f+r);function v(C){const S=m(C),L=1-P(C);if(L==0)return S;{const V=x(C);return{x:S.x+L*V.x,y:S.y+L*V.y}}}return $.glitchFreeParametric(v,F).rawPath}}}),g=new Y(a.backgroundSeed);window.customBackground=g,N=n=>{g.draw(n),g.addDebugText(`frame #${Math.round(n/1e3*60)} @${(n/1e3).toFixed(3)} seconds`);function c(){const m=i.findIndex(({endTime:x})=>n<x);return m==-1?i.length-1:m}const r=c(),d=h[r](n);z.setAttribute("d",d)}}let B;setTimeout(()=>{let a=NaN;B=new y.AnimationLoop(e=>{isNaN(a)&&(a=e);const t=e-a;N(t)}),window.animationLoop=B},1);function te(a){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),B.cancel(),{source:"fourier-smackdown.ts",script:a,seconds:60,devicePixelRatio}}window.initScreenCapture=te;class se{constructor(e,t){this.vertex1=e,this.vertex2=t}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class b{constructor(e,t){this.pathSoFar=e,this.remainingEdges=t}oneStep(){const e=l.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((t,o)=>{const s=t.other(e);return s===void 0||this.pathSoFar.length==1&&s!=1?[]:new b([...this.pathSoFar,s],this.remainingEdges.toSpliced(o,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const t of e)yield*t.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const t=Math.max(...e.map(s=>Math.max(s.vertex1,s.vertex2)))+1,o=new Set;for(const s of this.get(e)){const i=s.slice(0,s.length-1),u=this.#s(i);if(!o.has(u)){yield s,o.add(u);const p=this.#t(i,t).map(h=>this.#s(h));for(const h of p)o.add(h)}}}static#s(e){return String.fromCharCode(...e.map(t=>t+65))}static#t(e,t){const o=new Array;for(let s=1;s<e.length;s++){const i=e[s],u=(i+1)%t,p=R(e,s+1);u==p?o.push(l.initializedArray(e.length,h=>{const g=R(e,h+s);return l.positiveModulo(g-i,t)})):R(e,s-1)==u&&o.push(l.initializedArray(e.length,g=>{const n=R(e,s-g);return l.positiveModulo(n-i,t)}))}return o}static getSamples(){function e(t,...o){return l.initializedArray(t,s=>o.map(i=>new se(s,(s+i)%t))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=b;function ne(){const a=b.getSamples(),e=b.getUnique(a.pentagram);console.log(e,e.constructor.name);for(const t of e);}ne();{const a=l.initializedArray(5,c=>{const r=l.FULL_CIRCLE*c/5+l.FULL_CIRCLE/4,d=Math.cos(r),m=Math.sin(r);return{x:d,y:m}}),e=[...b.getUnique(b.getSamples().pentagram)],t=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],o=l.Random.fromString("fourier-smackdown.ts"),s=l.initializedArray(e.length,()=>{const c=o()*3|0,r=t[c];return t.splice(c,1),t.push(r),r}),i=l.parseIntX(new URLSearchParams(window.location.search).get("index")),u=i??Math.random()*e.length|0,p=e[u],h=s[u];console.log({requestedIndex:i,index:u,path:p,...h}),console.log(e),z.style.stroke=h.light,q.style.stroke=h.dark;const g=X.M(a[0].x,a[0].y);p.forEach((c,r)=>{if(r==0){if(c!=0)throw new Error("wtf")}else{const{x:d,y:m}=a[c],x=p[r-1];switch(l.positiveModulo(c-x,5)){case 1:{g.arc(0,0,d,m,"cw");break}case 2:case 3:{g.L(d,m);break}case 4:{g.arc(0,0,d,m,"ccw");break}default:throw new Error("wtf")}}});const n=g.pathShape.rawPath;console.log(n),ee({maxGroupsToDisplay:12,pathString:n,liveColor:h.light,referenceColor:h.dark,backgroundSeed:u})}
