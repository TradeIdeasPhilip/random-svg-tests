import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as x}from"./client-misc-B8CxQsfg.js";import{b as N,s as H,g as K,t as R,h as M}from"./fourier-shared-BdjzRlL0.js";import{p as z,d as X,b as Y,P as B}from"./path-shape-CZZKMsju.js";import{m as f}from"./misc-BHUyxQfl.js";import{g as V,e as Z}from"./utility-Dgy6CMn3.js";function j(){document.body.style.backgroundColor="transparent",x.selectorQueryAll("[data-hide-background]",SVGElement).forEach(l=>l.style.display="none")}function J(){const l=x.selectorQuery("[data-hide-background]",SVGElement);l.parentElement?.append(l)}const O=new URLSearchParams(window.location.search);O.get("hide_background")=="1"?j():O.get("only_background")=="1"&&J();{const e=x.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");e.filter="url(#watercolor)";const s=1;e.scale(s,s)}const W=1024;class I{constructor(e,s){this.terms=s,e instanceof SVGGElement||(e=x.selectorQuery(e,SVGGElement)),this.#e=x.selectorQueryAll("g.frequency",SVGGElement,0,1/0,e).map(u=>{const t=x.selectorQuery("text",SVGTextElement,u),c=document.createElementNS("http://www.w3.org/2000/svg","text");return c.classList.add("background"),u.insertBefore(c,t),{top:u,spinner:x.selectorQuery(".spinner",SVGPolygonElement,u),text:t,background:c}})}#e;show(e,s,u){this.#e.forEach((t,c)=>{if(c>=e+s)t.top.style.display="none";else{t.top.style.display="";const y=this.terms[c];t.background.innerHTML=t.text.innerHTML=y.frequency.toString(),t.spinner.style.transform=`rotate(${u*y.frequency+y.phase+f.FULL_CIRCLE/4}rad)`}})}}function G(l,e){if(l>=e)throw new Error("wtf");const s=f.makeLinear(l,0,e,1);function u(t){if(t<=l)return 0;if(t>=e)return 1;const c=s(t);return Z(c)}return u}let U=()=>{};window.showFrame=l=>{U(l)};class ${constructor(e,s){this.getTransform=s,this.#e=x.selectorQuery(e,SVGGElement),this.#s=x.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=x.selectorQuery("[data-live]",SVGPathElement,this.#e)}#e;#s;#t;hide(){this.#e.style.display="none"}show(e,s){this.#e.style.display="",this.#s.style.stroke=e,this.#t.style.stroke=s}setReferencePath(e){this.#s.setAttribute("d",e)}setLivePath(e){this.#t.setAttribute("d",e)}setTransform(e){const s=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",s.toString())}static right=new $("#right",e=>z(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const _=new X;class ee{hide(){this.#t.hide()}#e;show(e){this.#t.show(this.#n,this.#r),this.#t.setReferencePath(this.#s),this.#t.setTransform(this.#a),this.#e(e)}endTime;#s;#t;#n;#r;#a;constructor(e,s){this.#s=e.pathString,this.#t=e.destination,this.#n=e.referenceColor,this.#r=e.liveColor,_.d=this.#s,this.#a=this.#t.getTransform(_.getBBox());const u=N(e.pathString,W),t=H(u),c=K({addTime:5250,pauseTime:750,maxGroupsToDisplay:e.maxGroupsToDisplay,skipCountAtEnd:e.skipCountAtEnd??0,terms:t});this.endTime=c.at(-1).endTime;const y=n=>Math.max(...t.slice(0,n).map(o=>Math.abs(o.frequency))),d=n=>8*y(n)+7,a=c.map(n=>{if(n.addingCircles==0){const h=R(t,n.usingCircles),o=d(n.usingCircles),w=B.glitchFreeParametric(h,o);return()=>w.rawPath}else if(n.usingCircles==0&&n.addingCircles==1&&t[0].frequency==0){let h=function(g){return`${m.x*g},${m.y*g}`};const{startTime:o,endTime:w}=n,r=w-o,i=G(o,o+r/2),S=G(o,w),m=M(t[0]);return g=>{const k=S(g),P=h(k),L=i(g),F=h(L);return`M ${P} L ${F}`}}else{const o=.2/y(n.usingCircles+n.addingCircles),w=f.makeBoundedLinear(n.startTime,-o,n.endTime,1+o),r=R(t,n.usingCircles),i=R(t,n.addingCircles,n.usingCircles);let S=d(n.usingCircles+n.addingCircles);if(n.usingCircles==0||n.usingCircles==1&&M(t[0])){const m=M(t[0])??{x:0,y:0};return g=>{const k=w(g),P=k-o,L=k+o,F=G(P,L),b=Math.min(1,L);if(b<=0)return`M${m.x},${m.y} L${m.x},${m.y}`;{let v=function(E){E=E*b;const A=r(E),q=1-F(E);if(q==0)return A;{const D=i(E);return{x:A.x+q*D.x,y:A.y+q*D.y}}};const T=Math.ceil(Math.max(S,150)*b);return B.glitchFreeParametric(v,T).rawPath}}}else return m=>{const g=w(m),k=G(g-o,g+o);function P(F){const b=r(F),v=1-k(F);if(v==0)return b;{const T=i(F);return{x:b.x+v*T.x,y:b.y+v*T.y}}}return B.glitchFreeParametric(P,S).rawPath}}}),p=new I(s,t);this.#e=n=>{function h(){const k=c.findIndex(({endTime:P})=>n<P);return k==-1?c.length-1:k}const o=h(),w=a[o](n);this.#t.setLivePath(w);const{usingCircles:r,addingCircles:i,startTime:S,endTime:m}=c[o],g=i>0?(n-S)/(m-S)*f.FULL_CIRCLE:0;p.show(r,i,g)}}}function te(...l){U=e=>{l.forEach(s=>s.show(e))}}let Q;setTimeout(()=>{let l=NaN;Q=new x.AnimationLoop(e=>{isNaN(l)&&(l=e);const s=e-l;U(s)}),window.animationLoop=Q},1);function se(l){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),Q.cancel(),{source:"fourier-smackdown.ts",script:l,seconds:103,devicePixelRatio}}window.initScreenCapture=se;class ne{constructor(e,s){this.vertex1=e,this.vertex2=s}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class C{constructor(e,s){this.pathSoFar=e,this.remainingEdges=s}oneStep(){const e=f.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((s,u)=>{const t=s.other(e);return t===void 0||this.pathSoFar.length==1&&t!=1?[]:new C([...this.pathSoFar,t],this.remainingEdges.toSpliced(u,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const s of e)yield*s.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const s=Math.max(...e.map(t=>Math.max(t.vertex1,t.vertex2)))+1,u=new Set;for(const t of this.get(e)){const c=t.slice(0,t.length-1),y=this.#s(c);if(!u.has(y)){yield t,u.add(y);const d=this.#t(c,s).map(a=>this.#s(a));for(const a of d)u.add(a)}}}static#s(e){return String.fromCharCode(...e.map(s=>s+65))}static#t(e,s){const u=new Array;for(let t=1;t<e.length;t++){const c=e[t],y=(c+1)%s,d=V(e,t+1);y==d?u.push(f.initializedArray(e.length,a=>{const p=V(e,a+t);return f.positiveModulo(p-c,s)})):V(e,t-1)==y&&u.push(f.initializedArray(e.length,p=>{const n=V(e,t-p);return f.positiveModulo(n-c,s)}))}return u}static getSamples(){function e(s,...u){return f.initializedArray(s,t=>u.map(c=>new ne(t,(t+c)%s))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=C;function re(){const l=C.getSamples(),e=C.getUnique(l.pentagram);console.log(e,e.constructor.name);for(const s of e);}re();{class l{constructor(a){throw new Error("wtf")}static points=f.initializedArray(5,a=>{const p=f.FULL_CIRCLE*a/5+f.FULL_CIRCLE/4,n=Math.cos(p),h=Math.sin(p);return{x:n,y:h}});static allPaths=[...C.getUnique(C.getSamples().pentagram)]}class e{constructor(a){throw new Error("wtf")}static points=f.initializedArray(6,a=>{const p=f.FULL_CIRCLE*a/6+f.FULL_CIRCLE/4,n=Math.cos(p),h=Math.sin(p);return{x:n,y:h}});static allPaths=[...C.getUnique(C.getSamples().dodecahedron)];static makePathShape(a){const p=this.allPaths[a],n=Y.M(s[0].x,s[0].y);return p.forEach((h,o)=>{if(o==0){if(h!=0)throw new Error("wtf")}else{const{x:w,y:r}=s[h],i=p[o-1];switch(f.positiveModulo(h-i,6)){case 1:{n.arc(0,0,w,r,"cw");break}case 2:case 4:{n.L(w,r);break}case 5:{n.arc(0,0,w,r,"ccw");break}default:throw new Error("wtf")}}}),n.pathShape}}const s=e.points,u=e.allPaths,t=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],c=f.Random.fromString("fourier-smackdown.ts");f.initializedArray(u.length,()=>{const d=c()*3|0,a=t[d];return t.splice(d,1),t.push(a),a});const y=new Array;{let d=function(a,p,n,h=a){const o=x.selectorQuery(`g.frequencies[data-frequencies="${h}"]`,SVGGElement),w=new $(`[data-fourier-top="${h}"]`,g=>z(g,p,"srcRect fits completely into destRect"));o.style.fill=a;const i={maxGroupsToDisplay:15,skipCountAtEnd:1,pathString:e.makePathShape(n).rawPath,destination:w,liveColor:a,referenceColor:a},S=new ee(i,o);y.push(S);const m=x.selectorQuery(`text.chapter[data-chapter="${h}"]`,SVGTextElement);m.innerHTML=`#${n}`,m.style.fill=a};d("red",{x:.5,y:.5,width:5,height:5},9),d("white",{x:5.5,y:3.5,width:5,height:5},10),d("var(--blue)",{x:10.5,y:.5,width:5,height:5},11,"blue")}{const d=x.getById("main",SVGSVGElement),a=x.selectorQuery("#small-shadow > feDropShadow",SVGFEDropShadowElement),p=.03,n=1,h=23e3,o=28e3,w=f.makeLinear(h,n,o,p);y.push({show(r){{let i;if(r>=4500&&r<=8e3?r%1e3>=500&&(i="none"):r>14e3&&r<=16600&&(i="none"),r>=46500){if(r<=54e3)i="drop-shadow(0px 0px 0.03px black)";else if(r<57e3)i="drop-shadow(0px 1px 0.03px black)";else if(r<60600)i="drop-shadow(1px 1px 0.03px black)";else if(r<69600){const m=["drop-shadow(2px 1px 0.03px black)","drop-shadow(2px 0px 0.03px black)","drop-shadow(1px 0px 0.03px black)","drop-shadow(1px -1px 0.03px black)"],k=Math.floor((r-60600)/9e3*m.length);i=m[k]}}const S="--big-shadow";i===void 0?d.style.removeProperty(S):d.style.setProperty(S,i)}{let i;r>=17750&&r<=22e3&&Math.floor((r-17750)/4250*5)%2==0&&(i="none");const g="--small-shadow";i===void 0?d.style.removeProperty(g):d.style.setProperty(g,i)}{const i=r<h||r>o?p:w(r);a.stdDeviationX.baseVal=i,a.stdDeviationY.baseVal=i}}})}te(...y)}
