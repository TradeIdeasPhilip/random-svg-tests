import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as L}from"./client-misc-leadhGo2.js";import{d as A,T as w,Q as T,P as C,D as I}from"./letters-more-DL2hhA-c.js";import{b as P,a as V}from"./utility-DcEUXXL7.js";import{l as R}from"./math-to-path-CWuJ-zIl.js";const E=L("input",HTMLTextAreaElement),u=L("main",SVGElement);{const t=new w().font,{normal:s}=A(t),n=L("available",HTMLSpanElement);n.innerText=[...s].sort().join(" ")}class f{static#t;static doCleanup(){this.#t?.doCleanup(),this.#t=void 0,u.innerHTML=""}static restartCurrent(){const t=this.#t;t&&(this.doCleanup(),t.start())}start(){f.doCleanup(),this.startImpl(),f.#t=this}doCleanup(){}}class G extends f{startImpl(){const t=new w;t.restart();const s=E.value,n=t.addText(s);t.displayText(n,u),u.ownerSVGElement.viewBox.baseVal.height=t.baseline+t.font.get("0").fontMetrics.bottom}static start(){new this().start()}}const S=L("completionRatio",HTMLInputElement);class F extends f{startImpl(){const t=new w;t.restart();const s=E.value,n=t.addText(s);u.ownerSVGElement.viewBox.baseVal.height=t.baseline+t.font.get("0").fontMetrics.bottom;const m=w.join(n),o=document.createElementNS("http://www.w3.org/2000/svg","g");o.classList.add("handwriting"),u.appendChild(o);let c=0;m.splitOnMove().forEach(r=>{const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",r.rawPath),o.appendChild(l);const e=c,h=l.getTotalLength();c=e+h,l.style.setProperty("--offset",e.toString()),l.style.setProperty("--length",h.toString())});const a=new AbortController;this.doCleanup=()=>a.abort();const x=c,g=()=>{const r=S.valueAsNumber*x;P(r),o.style.setProperty("--total-position",r.toString())};g(),S.addEventListener("input",g,{signal:a.signal})}static start(){new this().start()}}class N extends f{startImpl(){const t=new w;t.restart();const s=E.value,n=t.addText(s);u.ownerSVGElement.viewBox.baseVal.height=t.baseline+t.font.get("0").fontMetrics.bottom;const m=w.join(n),o=document.createElementNS("http://www.w3.org/2000/svg","g");o.classList.add("handwriting","skywriting"),u.appendChild(o);let c=0;m.splitOnMove().forEach(l=>{const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",l.rawPath),o.appendChild(e);const h=c,i=e.getTotalLength();c=h+i,e.style.setProperty("--offset",h.toString()),e.style.setProperty("--length",i.toString())});const a=new AbortController;this.doCleanup=()=>a.abort();const g=c+40,r=()=>{const l=S.valueAsNumber*g;P(l),o.style.setProperty("--total-position",l.toString())};r(),S.addEventListener("input",r,{signal:a.signal})}static start(){new this().start()}}function B(p){return!p.commands.some(t=>t.command!="L")}class M extends f{static makeRoughShape(t,s){const n=new Array,m=new Array;return t.splitOnMove().forEach(o=>{if(B(o)){let c=function(e,h){const i=s*(h?Math.SQRT1_2:1)*Math.random(),d=Math.random()*Math.PI*2,y=V(i,d),b=e.x+y.x,v=e.y+y.y;return{x:b,y:v,offset:y,initial:e}};const a=o.commands,x=a.flatMap((e,h)=>h==0?[]:{x:e.x0,y:e.y0}),g=a[0],r=[c({x:g.x0,y:g.y0},"½")];x.forEach(e=>{r.push(c(e))});const l=a[a.length-1];if(r.push(c(l)),r.length!=a.length+1||a.length!=x.length+1)throw new Error("wtf");a.forEach((e,h)=>{const i=r[h],d=r[h+1],y=e instanceof T?{x:e.x1,y:e.y1}:R(i,d,Math.random()),b={x:y.x+(i.offset.x+d.offset.x)/2,y:y.y+(i.offset.y+d.offset.y)/2},v=c(b,"½");n.push(new T(i.initial.x,i.initial.y,b.x,b.y,d.initial.x,d.initial.y)),m.push(new T(i.x,i.y,v.x,v.y,d.x,d.y))})}else n.push(...o.commands),m.push(...o.commands)}),{before:new C(n),after:new C(m)}}static makeRoughFont(t){const s=new Map;return t.forEach((n,m)=>{const o=new I(this.makeRoughShape(n.shape,n.fontMetrics.strokeWidth*1.5).before,n.advance,n.fontMetrics);s.set(m,o)}),s}startImpl(){const t=new w;t.font=M.makeRoughFont(t.font),t.restart();const s=E.value,n=t.addText(s);t.displayText(n,u),u.ownerSVGElement.viewBox.baseVal.height=t.baseline+t.font.get("0").fontMetrics.bottom}static start(){new this().start()}}E.addEventListener("input",()=>{f.restartCurrent()});function k(){const p=document.querySelector('input[name="type"]:checked')?.id;switch(p){case"simpleType":{G.start();break}case"handwritingType":{new F().start();break}case"skywritingType":{new N().start();break}case"roughType":{new M().start();break}default:throw new Error(`invalid id: ${p}`)}}k();document.querySelectorAll('input[name="type"]').forEach(p=>{p.addEventListener("click",k)});
