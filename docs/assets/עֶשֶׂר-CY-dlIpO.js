import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as i,A as C}from"./client-misc-1LRynplM.js";import{s as _,R as f,m as $,a as M}from"./utility-Dw-q5N--.js";import{T as v,m as q}from"./letters-more-BnvpEBrd.js";import{m as N}from"./rough-lib-BHAdLWbz.js";import{m as b}from"./misc-CLGTS8fC.js";import"./path-shape-C2966eRL.js";import"./math-to-path-DqQ6Gsvd.js";const O=i("input",HTMLTextAreaElement),x=i("randomSeed",HTMLInputElement),Q=i("draw",HTMLButtonElement),U=i("timeInSeconds",HTMLInputElement),k=i("start",HTMLButtonElement),W=i("time",HTMLInputElement),m=i("handwriting",SVGGElement),w=i("morph",SVGGElement),u={text:"",alignment:""};Q.addEventListener("click",()=>{I()});function I(o=O.value){const s=_('input[name="align"]:checked',HTMLInputElement,1,1)[0].value;if(s!="left"&&s!="center"&&s!="right")throw new Error("wtf");const d=o==u.text&&s==u.alignment;u.text=o,u.alignment=s;let c=x.value;(d||!f.seedIsValid(c))&&(c=f.newSeed(),x.value=c);const l=f.create(c);m.innerHTML="",w.innerHTML="";const r=new v;r.font=q(7);const g=r.font.get("0").fontMetrics;r.lineHeight=g.bottom-g.capitalTop,r.restart();const A=r.addText(o,s),B=["hwb(180deg 0% 25.07%)","hwb(180deg 0% 25.07%)","white","hwb(47.34deg 8.63% 5.88%)"],y=new Map,S=A.map(t=>{const e=t.baseline;let n=y.get(e);return n===void 0&&(n=B.shift(),n??="violet",y.set(e,n)),{...t,color:n}}).map(t=>{const e=N(t.description.shape,t.description.fontMetrics.strokeWidth,l),n=e.after,p=e.before;return{...t,roughShape:n,normalShape:p,description:{shape:n}}}),T=v.displayText(S,w).map(t=>{t.element.style.stroke=t.color;const e=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],n=t.element.animate(e,{duration:1,fill:"both"});return n.pause(),n}),P=()=>{w.style.display="none"},G=t=>{M(t),w.style.display="";const e=t*T.length;T.forEach((n,p)=>{const a=e-p,h=Math.min(1,Math.max(0,a));n.currentTime=h})};{let t=.01;S.forEach(e=>{e.roughShape.splitOnMove().map(p=>{const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",p.rawPath),a.style.transform=`translate(${e.x}px, ${e.baseline}px)`,a.style.stroke=e.color,m.appendChild(a);const h=t,L=a.getTotalLength();t=h+L,a.style.setProperty("--offset",h.toString()),a.style.setProperty("--length",L.toString())});const n=t;m.style.setProperty("--total-length",n.toString())})}const F=()=>{m.style.display="none"},E=t=>{M(t),m.style.display="",m.style.setProperty("--t",t.toString())};window.showHandwriting=E;const R=$(2,1),V=t=>{const e=R(t);switch(e.index){case 0:{P(),E(e.t);break}case 1:{F(),G(e.t);break}default:throw new Error("wtf")}};window.showFrame=V,k.disabled=!1}let H;k.addEventListener("click",()=>{H?.cancel();const o=b.parseIntX(U.value);if(o===void 0)throw new Error("I don't want to do this better");let s=0,d;const c=new C(l=>{if(d||(s=l+o*1e3,d=b.makeLinear(l,0,s,1)),l>s)c.cancel(),window.showFrame(1);else{const r=d(l);W.value=r.toString(),window.showFrame(r)}});H=c});function X(){return I(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(o=>{if(!(o instanceof SVGElement||o instanceof HTMLElement))throw new Error("wtf");o.style.display="none"}),{source:"show-text.ts",devicePixelRatio}}window.initScreenCapture=X;
