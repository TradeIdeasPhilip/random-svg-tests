import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as f}from"./client-misc-B8CxQsfg.js";import{b as H,s as D,h as B,t as _}from"./fourier-shared-DpvWsPe-.js";import{p as $,d as K,b as Z,P as z}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as T,e as J}from"./utility-Dgy6CMn3.js";function W(){document.body.style.backgroundColor="transparent",f.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function X(){const i=f.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}const N=new URLSearchParams(window.location.search);let j=!1;N.get("hide_background")=="1"?W():N.get("only_background")=="1"&&X();{const t=f.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const Y=1024;class tt{constructor(t,e){this.terms=e,t instanceof SVGGElement||(t=f.selectorQuery(t,SVGGElement)),this.#t=f.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(r=>{const n=f.selectorQuery("text",SVGTextElement,r),h=document.createElementNS("http://www.w3.org/2000/svg","text");return h.classList.add("background"),r.insertBefore(h,n),{top:r,spinner:f.selectorQuery(".spinner",SVGPolygonElement,r),text:n,background:h}})}#t;show(t,e){this.#t.forEach((r,n)=>{if(n>=t)r.top.style.display="none";else{r.top.style.display="";const h=this.terms[n];r.background.innerHTML=r.text.innerHTML=h.frequency.toString(),r.spinner.style.transform=`rotate(${e*h.frequency+h.phase+a.FULL_CIRCLE/4}rad)`}})}}function q(i,t){if(i>=t)throw new Error("wtf");const e=a.makeLinear(i,0,t,1);function r(n){if(n<=i)return 0;if(n>=t)return 1;const h=e(n);return J(h)}return r}let Q=()=>{};window.showFrame=i=>{Q(i)};class U{constructor(t,e){this.getTransform=e,this.#t=f.selectorQuery(t,SVGGElement),this.#n=f.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=f.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new U("#right",t=>$(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const O=new K;class et{constructor(t){this.pathString=t,this.samples=H(t,Y),this.terms=D(this.samples),this.keyframes=a.initializedArray(21,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t,e=0,r=t-e){const n=this.makeGetPath2(),h=a.makeBoundedLinear(e,0,r,1),E=this.stepCount;function x(m){let l=Math.floor(m/t),o;l<0?(l=0,o=0):l>=E?(l=E-1,o=t):o=m%t;const u=h(o);return{pathString:n(l,u),index:l,t:u}}return x}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],r=this.stepCount,n=m=>Math.max(...t.slice(0,m).map(o=>Math.abs(o.frequency))),h=m=>{const l=n(m);return 8*Math.min(l,50)+7},E=a.initializedArray(r,m=>{const l=e[m],o=e[m+1];if(l==0&&o==1&&t[0].frequency==0){let u=function(y){return`${s.x*y},${s.y*y}`};const s=a.assertNonNullable(B(t[0])),c=q(0,.5),d=q(0,1);return y=>{const k=d(y),g=u(k),b=c(y),w=u(b);return`M ${g} L ${w}`}}else{const s=.2/Math.abs(t[l].frequency),c=a.makeBoundedLinear(0,-s,1,1+s),d=_(t,l),y=_(t,o-l,l),k=h(o);if(l==0||l==1&&B(t[0])){const g=B(t[0])??{x:0,y:0};return b=>{const w=c(b),C=w-s,V=w+s,G=q(C,V),p=Math.min(1,V);if(p<=0)return`M${g.x},${g.y} L${g.x},${g.y}`;{let F=function(L){L=L*p;const R=d(L),M=1-G(L);if(M==0)return R;{const A=y(L);return{x:R.x+M*A.x,y:R.y+M*A.y}}};const S=Math.ceil(Math.max(k,150)*p);return z.glitchFreeParametric(F,S).rawPath}}}else return g=>{const b=c(g),w=q(b-s,b+s);function C(G){const p=d(G),F=1-w(G);if(F==0)return p;{const S=y(G);return{x:p.x+F*S.x,y:p.y+F*S.y}}}return z.glitchFreeParametric(C,k).rawPath}}});function x(m,l){const o=E[m];return o(l)}return x}}class nt{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}endTime;#n;#e;#s;#r;#o;constructor(t,e){this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,O.d=this.#n,this.#o=this.#e.getTransform(O.getBBox());const r=7500,n=750;this.endTime=r*t.base.stepCount;const h=t.base.makeGetPath1(r,0,r-n),E=new tt(e,t.base.terms);this.#t=x=>{const{pathString:m,index:l,t:o}=h(x);this.#e.setLivePath(m),E.show(t.base.keyframes[l+1],o*a.FULL_CIRCLE)}}}function st(...i){Q=t=>{i.forEach(e=>e.show(t))}}let I;setTimeout(()=>{if(j)return;let i=NaN;I=new f.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;Q(e)}),window.animationLoop=I},1);function rt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),I?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:95,devicePixelRatio}}window.initScreenCapture=rt;class ot{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class P{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,r)=>{const n=e.other(t);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new P([...this.pathSoFar,n],this.remainingEdges.toSpliced(r,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(n=>Math.max(n.vertex1,n.vertex2)))+1,r=new Set;for(const n of this.get(t)){const h=n.slice(0,n.length-1),E=this.#n(h);if(!r.has(E)){yield n,r.add(E);const x=this.#e(h,e).map(m=>this.#n(m));for(const m of x)r.add(m)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const r=new Array;for(let n=1;n<t.length;n++){const h=t[n],E=(h+1)%e,x=T(t,n+1);E==x?r.push(a.initializedArray(t.length,m=>{const l=T(t,m+n);return a.positiveModulo(l-h,e)})):T(t,n-1)==E&&r.push(a.initializedArray(t.length,l=>{const o=T(t,n-l);return a.positiveModulo(o-h,e)}))}return r}static getSamples(){function t(e,...r){return a.initializedArray(e,n=>r.map(h=>new ot(n,(n+h)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=P;function at(){const i=P.getSamples(),t=P.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}at();{let i=function(o,u=0){const s=[],c=o.terms,d=c.length,y=7,k=10,g=c.splice(5,3),b=g.splice(u,1);for(s.push(g);s.length<k-2;){let C;s.length<6?C=1:(s.length<9,C=2);const V=c.splice(0,C);if(V.length!=C)throw new Error("wtf");s.push(V)}if(s.splice(y,0,[...c]),s.push(b),console.log(s),s.length!=k)throw new Error("wtf");if(c.length=0,c.length!=0)throw new Error("wtf");const w=o.keyframes;if(w.length=0,w.push(0),s.forEach(C=>{c.push(...C),w.push(c.length)}),c.length!=d)throw new Error("wtf")};class t{constructor(u){throw new Error("wtf")}static points=a.initializedArray(5,u=>{const s=a.FULL_CIRCLE*u/5+a.FULL_CIRCLE/4,c=Math.cos(s),d=Math.sin(s);return{x:c,y:d}});static allPaths=[...P.getUnique(P.getSamples().pentagram)]}class e{constructor(u){throw new Error("wtf")}static points=a.initializedArray(6,u=>{const s=a.FULL_CIRCLE*u/6+a.FULL_CIRCLE/4,c=Math.cos(s),d=Math.sin(s);return{x:c,y:d}});static allPaths=[...P.getUnique(P.getSamples().dodecahedron)];static makePathShape(u){const s=this.allPaths[u],c=Z.M(r[0].x,r[0].y);return s.forEach((d,y)=>{if(y==0){if(d!=0)throw new Error("wtf")}else{const{x:k,y:g}=r[d],b=s[y-1];switch(a.positiveModulo(d-b,6)){case 1:{c.arc(0,0,k,g,"cw");break}case 2:case 4:{c.L(k,g);break}case 5:{c.arc(0,0,k,g,"ccw");break}default:throw new Error("wtf")}}}),c.pathShape}}const r=e.points,n=e.allPaths,h=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],E=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(n.length,()=>{const o=E()*3|0,u=h[o];return h.splice(o,1),h.push(u),u});const x=[{color:"#black",destRect:{x:.5,y:.5,width:5,height:5},index:36,colorName:"red"},{color:"black",destRect:{x:5.5,y:3.5,width:5,height:5},index:36,colorName:"white"},{color:"black",destRect:{x:10.5,y:.5,width:5,height:5},index:36,colorName:"blue"}],m=x.map(({index:o})=>{const u=e.makePathShape(o).rawPath;return new et(u)});console.log(m),i(m[0],0),i(m[1],1),i(m[2],2);const l=new Array;for(const[o,u]of a.zip(x,m)){const{color:s,destRect:c}=o,d=o.colorName??o.color,y=f.selectorQuery(`g.frequencies[data-frequencies="${d}"]`,SVGGElement),k=new U(`[data-fourier-top="${d}"]`,w=>$(w,c,"srcRect fits completely into destRect"));y.style.fill=s;const g={base:u,destination:k,liveColor:s,referenceColor:s},b=new nt(g,y);l.push(b),console.log(b)}{let o=function(p,F){const v=[p,p+a.FULL_CIRCLE/3,p-a.FULL_CIRCLE/3].map(A=>V(Math.sin(A)));v.push(0),v.push(G(Math.cos(F)));const L=v.join(" "),M=[L,L,L,"0 0 0 0 1"].join(`
`);c.setAttribute("values",M)},u=function(p){const F=d.map(S=>[]);p.forEach(S=>{if(S.length!=d.length)throw new Error("wtf");S.forEach((v,L)=>{F[L].push(v)})});for(const[S,v]of a.zip(d,F))S.setAttribute("tableValues",v.join(" "))},s=function(p){const F=p/24e4*a.FULL_CIRCLE*2,S=p/24e4*a.FULL_CIRCLE/2;o(F,S)};const c=f.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),d=[f.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),f.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),f.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],w=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),C=a.makeLinear(0,0,255,1);w.forEach(p=>p.forEach((F,S,v)=>v[S]=C(F)));const V=a.makeLinear(-1,-.05,1,.8),G=a.makeLinear(1,0,-1,-.4);window.updateValues=o,u(w),l.push({show:s})}if(console.log(l),st(...l),N.get("thumbnail")=="1"){const o=f.selectorQuery("g#foreground",SVGGElement);j=!0;const u=new Array;Array.from(o.children).forEach(s=>{const c=a.assertClass(s,SVGElement);c.dataset.live===void 0?c.style.display="none":(console.log("live",c.dataset.live),u.push(c))}),Q(2e4),f.selectorQueryAll("[data-reference]",SVGPathElement).forEach(s=>s.style.display="none"),window.showFrame=s=>{console.info("ignoring showFrame()",s)}}}{const i=a.Random.fromString("Starry, Starry Night 🌌"),t=f.selectorQuery("[data-favorite]",SVGCircleElement),e=a.makeLinear(0,.025,2,.1);for(let r=0;r<100;r++){const n=a.assertClass(t.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=i()*16,n.cy.baseVal.value=i()*9,n.r.baseVal.value=e(i()+i()),t.parentElement.append(n)}}
