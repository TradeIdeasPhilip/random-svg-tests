import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as E}from"./client-misc-ZHNZ3-cL.js";import{b as P,s as M}from"./utility-D9E8BDCl.js";import{P as T}from"./path-shape-fljILaqi.js";import{m as y}from"./misc-wGF4FraP.js";const g=1e-4;class b{compute(t,e,s){let r=0;for(let i=0;i<s;i++){const a=this.constant(e,i);r+=a*(t-e)**i}return r}invalid(t){return this.badPoints.some(({real:e,imaginary:s})=>t==e&&s==0)}validRanges(){const t=this.badPoints.flatMap(({real:s,imaginary:r})=>r==0?[s]:[]).sort((s,r)=>s-r);return t.push(1/0),t.map((s,r,i)=>({from:(i[r-1]??-1/0)+g,to:s-g}))}radiusOfConvergence(t){return Math.min(...this.badPoints.map(e=>Math.hypot(t-e.real,e.imaginary)))}partialSum(t,e){const s=y.initializedArray(e,i=>this.constant(t,i));function r(i){const a=i-t;let n=0;return s.forEach((o,l)=>n+=o*a**l),n}return r}}class S extends b{numberOfTerms=1/0;constant(t,e){if(t===0)throw new Error("Reciprocal is undefined at x0 = 0");return(-1)**e/t**(e+1)}f(t){if(t===0)throw new Error("Reciprocal is undefined at x = 0");return 1/t}static instance=new this;badPoints=[{real:0,imaginary:0}]}class R extends b{numberOfTerms=1/0;constant(t,e){const s=t+e*Math.PI/2;let r=1;for(let i=1;i<=e;i++)r*=i;return Math.sin(s)/r}f(t){return Math.sin(t)}static instance=new this;badPoints=[]}class I extends b{numberOfTerms=12;constant(t,e){const s=1+t*t;switch(e){case 0:return 1/s;case 1:return-2*t/s**2;case 2:return(3*t*t-1)/s**3;case 3:return 2*t*(3-5*t*t)/s**4;case 4:return(25*t**4-38*t*t+3)/(2*s**5);case 5:return t*(2842*t*t-1450*t**4-636)/(5*s**6);case 6:return(-7700*t**6+20316*t**4-9120*t*t+216)/(12*s**7);case 7:return t*(29718*t**4-46410*t*t+10869)/(3*s**8);case 8:return(159600*t**8-498960*t**6+424116*t**4-90456*t*t+2268)/(48*s**9);case 9:return t*(-672452*t**6+1660530*t**4-987318*t*t+117693)/(30*s**10);case 10:return(8044400*t**10-30524376*t**8+35128260*t**6-13524948*t**4+1475730*t*t-18360)/(720*s**11);case 11:return t*(29887350*t**8-96204090*t**6+87415950*t**4-22994430*t*t+1596795)/(180*s**12);default:throw new Error(`Term ${e} not implemented.`)}}f(t){return 1/(1+t*t)}static instance=new this;badPoints=[{real:0,imaginary:1},{real:0,imaginary:-1}]}const m=document.documentElement.style;class w{constructor(t){this.which=t,this.#t=P(`[data-center="${t}"]`,SVGCircleElement),this.#e=P(`[data-reconstruction="${t}"]`,SVGPathElement)}#t;#e;hide(){m.setProperty(`--example${this.which}-open-end-display`,"none"),this.#t.style.display="none",this.#e.style.d=""}draw2(t,e,s,r,i,a){function n(o){const l=t(o),u=e(o);return l*(1-s)+u*s}this.draw(n,r,i,a)}draw(t,e,s,r){if(s-=g,s<=0)throw new Error("wtf");const i=-9,a=9,n=e-s,o=e+s,l=Math.max(i,n),u=Math.min(a,o),p=d=>{const f=y.lerp(l,u,d),v=t(f);return{x:f,y:v}},h=T.parametric(p,50);this.#e.style.d=h.cssPath,this.#t.style.display="",m.setProperty(`--example${this.which}-center-x`,e+"px"),m.setProperty(`--example${this.which}-center-y`,t(e)+"px"),isFinite(s)?(m.setProperty(`--example${this.which}-from-x`,n+"px"),m.setProperty(`--example${this.which}-from-y`,t(n)+"px"),m.setProperty(`--example${this.which}-from-y-ideal`,r(n)+"px"),m.setProperty(`--example${this.which}-to-x`,o+"px"),m.setProperty(`--example${this.which}-to-y`,t(o)+"px"),m.setProperty(`--example${this.which}-to-y-ideal`,r(o)+"px"),m.setProperty(`--example${this.which}-open-end-display`,"")):m.setProperty(`--example${this.which}-open-end-display`,"none")}precompute(t,e,s){const r=t.radiusOfConvergence(e),i=y.initializedArray(s,n=>t.partialSum(e,n));return n=>{if(n>i.length-1)throw new Error(`Requested: ${n}, Available [0 - ${i.length-1}]`);if(Number.isInteger(n))this.draw(i[n],e,r,t.f);else{let o=function(h){const d=l(h),f=u(h);return d*(1-p)+f*p};const l=i[Math.floor(n)],u=i[Math.ceil(n)],p=n%1;this.draw(o,e,r,t.f)}}}drawAll(t,e,s){if(t.invalid(e))this.hide();else{const r=t.radiusOfConvergence(e);if(Number.isInteger(s))this.draw(t.partialSum(e,s),e,r,t.f);else{const i=t.partialSum(e,Math.floor(s)),a=t.partialSum(e,Math.ceil(s)),n=s%1;this.draw2(i,a,n,e,r,t.f)}}}static instances=[new this("1"),new this("2"),new this("3")]}class A{#t=E.getById("original-function",SVGPathElement);#e=E.getById("bad-points",SVGGElement);#s=E.getById("circles-all",SVGGElement);hide(){this.#t.style.d="",this.#s.style.display="none"}draw(t,e){e?(this.#s.style.display="",this.#e.innerHTML="",t.badPoints.forEach(n=>{const o=document.createElementNS("http://www.w3.org/2000/svg","text");o.innerHTML="⚠️",o.setAttribute("x",n.real.toString()),o.setAttribute("y",n.imaginary.toString()),this.#e.appendChild(o)})):this.#s.style.display="none";const s=-9,r=9,i=t.validRanges().flatMap(n=>{const o=Math.max(s,n.from),l=Math.min(r,n.to);if(o>=l)return[];{const u=h=>{const d=y.lerp(o,l,h),f=t.f(d);return{x:d,y:f}};return T.parametric(u,Math.ceil((l-o)*5)).commands}}),a=new T(i);this.#t.style.d=a.cssPath}static instance=new this}class L{#t={paused:!0,timePassed:0};get timePassed(){return this.#t.paused?this.#t.timePassed:performance.now()-this.#t.timeOffset}get paused(){return this.#t.paused}pause(){this.#t.paused||(this.#t={paused:!0,timePassed:this.timePassed})}play(){this.#t.paused&&(this.#t={paused:!1,timeOffset:performance.now()-this.timePassed})}set paused(t){t?this.pause():this.play()}restart(t){switch(t){case 1:{this.show=this.showPart1;break}case 2:{this.show=this.showPart2;break}}const e=this.paused;this.#t={timePassed:0,paused:!0},this.paused=e}#e(t){this.#t.paused||this.show(t-this.#t.timeOffset)}#s=38;#n=1e3;#r=800;#o=this.#s*(this.#r+this.#n)+this.#n;showPart1(t){if(t<0||t>=this.#o)return;const e=Math.floor(t/(this.#n+this.#r)),s=t-e*(this.#n+this.#r),i=Math.max(0,s-this.#n)/this.#r,a=e+i,n=R.instance;A.instance.draw(n,!1),w.instances[0].drawAll(n,-Math.PI*7/4,a),w.instances[1].drawAll(n,0,a),w.instances[2].drawAll(n,Math.PI*3/2,a)}#u=20;#i=1100;#a=900;#c=this.#u*(this.#a+this.#i)+this.#i;#h=13e3;#l=22e3;#d=y.makeLinear(this.#h,-9,this.#l,9);showPart2(t){if(t<0||t>=this.#c)return;m.setProperty("--ms-since-start",t.toString());const e=Math.floor(t/(this.#i+this.#a)),s=t-e*(this.#i+this.#a),i=Math.max(0,s-this.#i)/this.#a,a=e+i,n=S.instance;A.instance.draw(n,!1),w.instances[0].drawAll(n,-2,a),w.instances[1].drawAll(n,1,a),t<this.#h||t>this.#l?w.instances[2].hide():w.instances[2].drawAll(n,this.#d(t),a)}show=this.showPart1;constructor(){console.log(`Part 1 length: ${this.#o/1e3} seconds.`,`Part 2 length: ${this.#c/1e3} seconds.`),new E.AnimationLoop(this.#e.bind(this)),window.initScreenCapture=this.initScreenCapture.bind(this),window.showFrame=t=>{this.show(t/60*1e3)}}static instance=new this;initScreenCapture(t){switch(document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),t){case"part 1":return this.show=this.showPart1,{source:"some4.ts",devicePixelRatio,script:t,firstFrame:0,lastFrame:Math.floor(this.#o/1e3*60)};case"part 2":return this.show=this.showPart2,{source:"some4.ts",devicePixelRatio,script:t,firstFrame:0,lastFrame:Math.floor(this.#c/1e3*60)};default:throw new Error(`Unknown script: ${JSON.stringify(t)}`)}}}window.debugStuff={HiddenPoles:I,Sine:R,Reciprocal:S,TaylorElements:w,Script:L};console.log("debugStuff",window.debugStuff);{let c=function(){t()},t=function(){const h=o.map(({use:d,value:f})=>{if(d.checked)return f.valueAsNumber});_(y.parseIntX(s.value),l.checked,r.valueAsNumber,...h)},e=function(){const h=r.valueAsNumber;Number.isInteger(h)?(u=Math.max(0,h-1),p=Math.min(12,h+1)):(u=Math.floor(h),p=Math.ceil(h)),n.innerText=h.toFixed(3),i.innerText=u.toString(),a.innerText=p.toString()};const s=P("#manual-controls select",HTMLSelectElement),r=P("#manual-controls > input",HTMLInputElement),[i,a]=M("[data-term-stepper] button",HTMLButtonElement,2,2),n=P("[data-term-stepper] span",HTMLSpanElement),o=M("#manual-controls > div[data-x0]",HTMLDivElement,3,3).map(h=>{const[d,f]=M("input",HTMLInputElement,2,2,h);return d.addEventListener("input",c),f.addEventListener("input",()=>{d.checked=!0,c()}),{use:d,value:f}}),l=E.getById("show-bad-points",HTMLInputElement);s.addEventListener("input",c);let u=NaN,p=NaN;r.addEventListener("input",()=>{e(),c()}),i.addEventListener("click",()=>{r.value=u.toString(),e(),c()}),a.addEventListener("click",()=>{r.value=p.toString(),e(),c()}),l.addEventListener("input",c),e(),c()}function _(c,t,e,...s){const r=[R.instance,S.instance,I.instance],i=r[c%r.length];A.instance.draw(i,t),w.instances.forEach((a,n)=>{const o=s[n];o===void 0?a.hide():a.drawAll(i,o,e)})}window.debugDraw=_;
