import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as x}from"./client-misc-B8CxQsfg.js";import{b as N,s as H,g as K,t as R,h as M}from"./fourier-shared-BdjzRlL0.js";import{p as z,d as X,b as Y,P as Q}from"./path-shape-CZZKMsju.js";import{m as f}from"./misc-BHUyxQfl.js";import{g as V,e as Z}from"./utility-Dgy6CMn3.js";function j(){document.body.style.backgroundColor="transparent",x.selectorQueryAll("[data-hide-background]",SVGElement).forEach(o=>o.style.display="none")}function J(){const o=x.selectorQuery("[data-hide-background]",SVGElement);o.parentElement?.append(o)}const B=new URLSearchParams(window.location.search);if(B.get("hide_background")=="1")j();else if(B.get("only_background")=="1")J();else if(B.get("thumbnail")=="1"){const o=x.selectorQuery("g#foreground",SVGGElement);o.style.display="none";const e=x.selectorQuery("g#thumbnail-foreground",SVGGElement);e.style.display=""}{const e=x.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");e.filter="url(#watercolor)";const s=1;e.scale(s,s)}const W=1024;class I{constructor(e,s){this.terms=s,e instanceof SVGGElement||(e=x.selectorQuery(e,SVGGElement)),this.#e=x.selectorQueryAll("g.frequency",SVGGElement,0,1/0,e).map(u=>{const t=x.selectorQuery("text",SVGTextElement,u),l=document.createElementNS("http://www.w3.org/2000/svg","text");return l.classList.add("background"),u.insertBefore(l,t),{top:u,spinner:x.selectorQuery(".spinner",SVGPolygonElement,u),text:t,background:l}})}#e;show(e,s,u){this.#e.forEach((t,l)=>{if(l>=e+s)t.top.style.display="none";else{t.top.style.display="";const y=this.terms[l];t.background.innerHTML=t.text.innerHTML=y.frequency.toString(),t.spinner.style.transform=`rotate(${u*y.frequency+y.phase+f.FULL_CIRCLE/4}rad)`}})}}function G(o,e){if(o>=e)throw new Error("wtf");const s=f.makeLinear(o,0,e,1);function u(t){if(t<=o)return 0;if(t>=e)return 1;const l=s(t);return Z(l)}return u}let $=()=>{};window.showFrame=o=>{$(o)};class D{constructor(e,s){this.getTransform=s,this.#e=x.selectorQuery(e,SVGGElement),this.#s=x.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=x.selectorQuery("[data-live]",SVGPathElement,this.#e)}#e;#s;#t;hide(){this.#e.style.display="none"}show(e,s){this.#e.style.display="",this.#s.style.stroke=e,this.#t.style.stroke=s}setReferencePath(e){this.#s.setAttribute("d",e)}setLivePath(e){this.#t.setAttribute("d",e)}setTransform(e){const s=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",s.toString())}static right=new D("#right",e=>z(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const _=new X;class ee{hide(){this.#t.hide()}#e;show(e){this.#t.show(this.#n,this.#r),this.#t.setReferencePath(this.#s),this.#t.setTransform(this.#a),this.#e(e)}endTime;#s;#t;#n;#r;#a;constructor(e,s){this.#s=e.pathString,this.#t=e.destination,this.#n=e.referenceColor,this.#r=e.liveColor,_.d=this.#s,this.#a=this.#t.getTransform(_.getBBox());const u=N(e.pathString,W),t=H(u),l=K({addTime:5250,pauseTime:750,maxGroupsToDisplay:e.maxGroupsToDisplay,skipCountAtEnd:e.skipCountAtEnd??0,terms:t});this.endTime=l.at(-1).endTime;const y=n=>Math.max(...t.slice(0,n).map(i=>Math.abs(i.frequency))),d=n=>8*y(n)+7,a=l.map(n=>{if(n.addingCircles==0){const h=R(t,n.usingCircles),i=d(n.usingCircles),w=Q.glitchFreeParametric(h,i);return()=>w.rawPath}else if(n.usingCircles==0&&n.addingCircles==1&&t[0].frequency==0){let h=function(g){return`${m.x*g},${m.y*g}`};const{startTime:i,endTime:w}=n,r=w-i,c=G(i,i+r/2),S=G(i,w),m=M(t[0]);return g=>{const b=S(g),C=h(b),L=c(g),F=h(L);return`M ${C} L ${F}`}}else{const i=.2/y(n.usingCircles+n.addingCircles),w=f.makeBoundedLinear(n.startTime,-i,n.endTime,1+i),r=R(t,n.usingCircles),c=R(t,n.addingCircles,n.usingCircles);let S=d(n.usingCircles+n.addingCircles);if(n.usingCircles==0||n.usingCircles==1&&M(t[0])){const m=M(t[0])??{x:0,y:0};return g=>{const b=w(g),C=b-i,L=b+i,F=G(C,L),P=Math.min(1,L);if(P<=0)return`M${m.x},${m.y} L${m.x},${m.y}`;{let v=function(E){E=E*P;const A=r(E),q=1-F(E);if(q==0)return A;{const O=c(E);return{x:A.x+q*O.x,y:A.y+q*O.y}}};const T=Math.ceil(Math.max(S,150)*P);return Q.glitchFreeParametric(v,T).rawPath}}}else return m=>{const g=w(m),b=G(g-i,g+i);function C(F){const P=r(F),v=1-b(F);if(v==0)return P;{const T=c(F);return{x:P.x+v*T.x,y:P.y+v*T.y}}}return Q.glitchFreeParametric(C,S).rawPath}}}),p=new I(s,t);this.#e=n=>{function h(){const b=l.findIndex(({endTime:C})=>n<C);return b==-1?l.length-1:b}const i=h(),w=a[i](n);this.#t.setLivePath(w);const{usingCircles:r,addingCircles:c,startTime:S,endTime:m}=l[i],g=c>0?(n-S)/(m-S)*f.FULL_CIRCLE:0;p.show(r,c,g)}}}function te(...o){$=e=>{o.forEach(s=>s.show(e))}}let U;setTimeout(()=>{let o=NaN;U=new x.AnimationLoop(e=>{isNaN(o)&&(o=e);const s=e-o;$(s)}),window.animationLoop=U},1);function se(o){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),U.cancel(),{source:"fourier-smackdown.ts",script:o,seconds:103,devicePixelRatio}}window.initScreenCapture=se;class ne{constructor(e,s){this.vertex1=e,this.vertex2=s}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class k{constructor(e,s){this.pathSoFar=e,this.remainingEdges=s}oneStep(){const e=f.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((s,u)=>{const t=s.other(e);return t===void 0||this.pathSoFar.length==1&&t!=1?[]:new k([...this.pathSoFar,t],this.remainingEdges.toSpliced(u,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const s of e)yield*s.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const s=Math.max(...e.map(t=>Math.max(t.vertex1,t.vertex2)))+1,u=new Set;for(const t of this.get(e)){const l=t.slice(0,t.length-1),y=this.#s(l);if(!u.has(y)){yield t,u.add(y);const d=this.#t(l,s).map(a=>this.#s(a));for(const a of d)u.add(a)}}}static#s(e){return String.fromCharCode(...e.map(s=>s+65))}static#t(e,s){const u=new Array;for(let t=1;t<e.length;t++){const l=e[t],y=(l+1)%s,d=V(e,t+1);y==d?u.push(f.initializedArray(e.length,a=>{const p=V(e,a+t);return f.positiveModulo(p-l,s)})):V(e,t-1)==y&&u.push(f.initializedArray(e.length,p=>{const n=V(e,t-p);return f.positiveModulo(n-l,s)}))}return u}static getSamples(){function e(s,...u){return f.initializedArray(s,t=>u.map(l=>new ne(t,(t+l)%s))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=k;function re(){const o=k.getSamples(),e=k.getUnique(o.pentagram);console.log(e,e.constructor.name);for(const s of e);}re();{class o{constructor(a){throw new Error("wtf")}static points=f.initializedArray(5,a=>{const p=f.FULL_CIRCLE*a/5+f.FULL_CIRCLE/4,n=Math.cos(p),h=Math.sin(p);return{x:n,y:h}});static allPaths=[...k.getUnique(k.getSamples().pentagram)]}class e{constructor(a){throw new Error("wtf")}static points=f.initializedArray(6,a=>{const p=f.FULL_CIRCLE*a/6+f.FULL_CIRCLE/4,n=Math.cos(p),h=Math.sin(p);return{x:n,y:h}});static allPaths=[...k.getUnique(k.getSamples().dodecahedron)];static makePathShape(a){const p=this.allPaths[a],n=Y.M(s[0].x,s[0].y);return p.forEach((h,i)=>{if(i==0){if(h!=0)throw new Error("wtf")}else{const{x:w,y:r}=s[h],c=p[i-1];switch(f.positiveModulo(h-c,6)){case 1:{n.arc(0,0,w,r,"cw");break}case 2:case 4:{n.L(w,r);break}case 5:{n.arc(0,0,w,r,"ccw");break}default:throw new Error("wtf")}}}),n.pathShape}}const s=e.points,u=e.allPaths,t=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],l=f.Random.fromString("fourier-smackdown.ts");f.initializedArray(u.length,()=>{const d=l()*3|0,a=t[d];return t.splice(d,1),t.push(a),a});const y=new Array;{let d=function(a,p,n,h=a){const i=x.selectorQuery(`g.frequencies[data-frequencies="${h}"]`,SVGGElement),w=new D(`[data-fourier-top="${h}"]`,g=>z(g,p,"srcRect fits completely into destRect"));i.style.fill=a;const c={maxGroupsToDisplay:15,skipCountAtEnd:1,pathString:e.makePathShape(n).rawPath,destination:w,liveColor:a,referenceColor:a},S=new ee(c,i);y.push(S);const m=x.selectorQuery(`text.chapter[data-chapter="${h}"]`,SVGTextElement);m.innerHTML=`#${n}`,m.style.fill=a};d("red",{x:.5,y:.5,width:5,height:5},9),d("white",{x:5.5,y:3.5,width:5,height:5},10),d("var(--blue)",{x:10.5,y:.5,width:5,height:5},11,"blue")}{const d=x.getById("main",SVGSVGElement),a=x.selectorQuery("#small-shadow > feDropShadow",SVGFEDropShadowElement),p=.03,n=1,h=23e3,i=28e3,w=f.makeLinear(h,n,i,p);y.push({show(r){{let c;if(r>=4500&&r<=8e3?r%1e3>=500&&(c="none"):r>14e3&&r<=16600&&(c="none"),r>=46500){if(r<=54e3)c="drop-shadow(0px 0px 0.03px black)";else if(r<57e3)c="drop-shadow(0px 1px 0.03px black)";else if(r<60600)c="drop-shadow(1px 1px 0.03px black)";else if(r<69600){const m=["drop-shadow(2px 1px 0.03px black)","drop-shadow(2px 0px 0.03px black)","drop-shadow(1px 0px 0.03px black)","drop-shadow(1px -1px 0.03px black)"],b=Math.floor((r-60600)/9e3*m.length);c=m[b]}}const S="--big-shadow";c===void 0?d.style.removeProperty(S):d.style.setProperty(S,c)}{let c;r>=17750&&r<=22e3&&Math.floor((r-17750)/4250*5)%2==0&&(c="none");const g="--small-shadow";c===void 0?d.style.removeProperty(g):d.style.setProperty(g,c)}{const c=r<h||r>i?p:w(r);a.stdDeviationX.baseVal=c,a.stdDeviationY.baseVal=c}}})}te(...y)}
