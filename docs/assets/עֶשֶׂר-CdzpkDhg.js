import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as r}from"./client-misc-B8CxQsfg.js";import{m as V,b as I}from"./utility-DH3fWvUB.js";import{T as M,m as C}from"./letters-more-DS-WHSP9.js";import{m as $}from"./rough-lib-D9lzy4DB.js";import{m as h}from"./misc-BHUyxQfl.js";import"./letters-base-Diwx_0WQ.js";import"./path-shape-CZZKMsju.js";import"./math-to-path-DHD-XsCZ.js";const q=r.getById("input",HTMLTextAreaElement),b=r.getById("randomSeed",HTMLInputElement),N=r.getById("draw",HTMLButtonElement),O=r.getById("timeInSeconds",HTMLInputElement),x=r.getById("start",HTMLButtonElement),Q=r.getById("time",HTMLInputElement),d=r.getById("handwriting",SVGGElement),g=r.getById("morph",SVGGElement),u={text:"",alignment:""};N.addEventListener("click",()=>{B()});function B(o=q.value){const s=r.selectorQueryAll('input[name="align"]:checked',HTMLInputElement,1,1)[0].value;if(s!="left"&&s!="center"&&s!="right")throw new Error("wtf");const m=o==u.text&&s==u.alignment;u.text=o,u.alignment=s;let c=b.value;(m||!h.Random.seedIsValid(c))&&(c=h.Random.newSeed(),b.value=c);const l=h.Random.create(c);d.innerHTML="",g.innerHTML="";const i=new M;i.font=C(7);const f=i.font.get("0").fontMetrics;i.lineHeight=f.bottom-f.capitalTop,i.restart();const H=i.addText(o,s),k=["hwb(180deg 0% 25.07%)","hwb(180deg 0% 25.07%)","white","hwb(47.34deg 8.63% 5.88%)"],y=new Map,S=H.map(t=>{const e=t.baseline;let n=y.get(e);return n===void 0&&(n=k.shift(),n??="violet",y.set(e,n)),{...t,color:n}}).map(t=>{const e=$(t.description.shape,t.description.fontMetrics.strokeWidth,l),n=e.after,p=e.before;return{...t,roughShape:n,normalShape:p,description:{shape:n}}}),E=M.displayText(S,g).map(t=>{t.element.style.stroke=t.color;const e=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],n=t.element.animate(e,{duration:1,fill:"both"});return n.pause(),n}),A=()=>{g.style.display="none"},P=t=>{I(t),g.style.display="";const e=t*E.length;E.forEach((n,p)=>{const a=e-p,w=Math.min(1,Math.max(0,a));n.currentTime=w})};{let t=.01;S.forEach(e=>{e.roughShape.splitOnMove().map(p=>{const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",p.rawPath),a.style.transform=`translate(${e.x}px, ${e.baseline}px)`,a.style.stroke=e.color,d.appendChild(a);const w=t,L=a.getTotalLength();t=w+L,a.style.setProperty("--offset",w.toString()),a.style.setProperty("--length",L.toString())});const n=t;d.style.setProperty("--total-length",n.toString())})}const G=()=>{d.style.display="none"},T=t=>{I(t),d.style.display="",d.style.setProperty("--t",t.toString())};window.showHandwriting=T;const F=V(2,1),R=t=>{const e=F(t);switch(e.index){case 0:{A(),T(e.t);break}case 1:{G(),P(e.t);break}default:throw new Error("wtf")}};window.showFrame=R,x.disabled=!1}let v;x.addEventListener("click",()=>{v?.cancel();const o=h.parseIntX(O.value);if(o===void 0)throw new Error("I don't want to do this better");let s=0,m;const c=new r.AnimationLoop(l=>{if(m||(s=l+o*1e3,m=h.makeLinear(l,0,s,1)),l>s)c.cancel(),window.showFrame(1);else{const i=m(l);Q.value=i.toString(),window.showFrame(i)}});v=c});function U(){return B(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(o=>{if(!(o instanceof SVGElement||o instanceof HTMLElement))throw new Error("wtf");o.style.display="none"}),{source:"show-text.ts",devicePixelRatio}}window.initScreenCapture=U;
