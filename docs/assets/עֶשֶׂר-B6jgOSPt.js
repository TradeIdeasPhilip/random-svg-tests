import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as i,m as M,A as V}from"./client-misc-CqK8Npau.js";import{s as C,R as f,m as _,a as v}from"./utility-CcMiQaH1.js";import{m as $,T as q}from"./letters-more-D_4o2xKt.js";import{m as N}from"./rough-lib-DZc4J2vG.js";import"./path-shape-BXOkZTxi.js";import"./math-to-path-D11qeOG5.js";const O=i("input",HTMLTextAreaElement),b=i("randomSeed",HTMLInputElement),Q=i("draw",HTMLButtonElement),U=i("timeInSeconds",HTMLInputElement),H=i("start",HTMLButtonElement),W=i("time",HTMLInputElement),m=i("handwriting",SVGGElement),u=i("morph",SVGGElement),w={text:"",alignment:""};Q.addEventListener("click",()=>{k()});function k(o=O.value){const s=C('input[name="align"]:checked',HTMLInputElement,1,1)[0].value;if(s!="left"&&s!="center"&&s!="right")throw new Error("wtf");const d=o==w.text&&s==w.alignment;w.text=o,w.alignment=s;let c=b.value;(d||!f.seedIsValid(c))&&(c=f.newSeed(),b.value=c);const l=f.create(c);m.innerHTML="",u.innerHTML="";const r=new q;r.font=$(7);const g=r.font.get("0").fontMetrics;r.lineHeight=g.bottom-g.capitalTop,r.restart();const I=r.addText(o,s),A=["hwb(180deg 0% 25.07%)","hwb(180deg 0% 25.07%)","white","hwb(47.34deg 8.63% 5.88%)"],y=new Map,S=I.map(t=>{const e=t.baseline;let n=y.get(e);return n===void 0&&(n=A.shift(),n??="violet",y.set(e,n)),{...t,color:n}}).map(t=>{const e=N(t.description.shape,t.description.fontMetrics.strokeWidth,l),n=e.after,p=e.before;return{...t,roughShape:n,normalShape:p,description:{shape:n}}}),T=r.displayText(S,u).map(t=>{t.element.style.stroke=t.color;const e=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],n=t.element.animate(e,{duration:1,fill:"both"});return n.pause(),n}),B=()=>{u.style.display="none"},P=t=>{v(t),u.style.display="";const e=t*T.length;T.forEach((n,p)=>{const a=e-p,h=Math.min(1,Math.max(0,a));n.currentTime=h})};{let t=.01;S.forEach(e=>{e.roughShape.splitOnMove().map(p=>{const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",p.rawPath),a.style.transform=`translate(${e.x}px, ${e.baseline}px)`,a.style.stroke=e.color,m.appendChild(a);const h=t,L=a.getTotalLength();t=h+L,a.style.setProperty("--offset",h.toString()),a.style.setProperty("--length",L.toString())});const n=t;m.style.setProperty("--total-length",n.toString())})}const G=()=>{m.style.display="none"},E=t=>{v(t),m.style.display="",m.style.setProperty("--t",t.toString())};window.showHandwriting=E;const F=_(2,1),R=t=>{const e=F(t);switch(e.index){case 0:{B(),E(e.t);break}case 1:{G(),P(e.t);break}default:throw new Error("wtf")}};window.showFrame=R,H.disabled=!1}let x;H.addEventListener("click",()=>{x?.cancel();const o=M.parseIntX(U.value);if(o===void 0)throw new Error("I don't want to do this better");let s=0,d;const c=new V(l=>{if(d||(s=l+o*1e3,d=M.makeLinear(l,0,s,1)),l>s)c.cancel();else{const r=d(l);W.value=r.toString(),window.showFrame(r)}});x=c});function X(){return k(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(o=>{if(!(o instanceof SVGElement||o instanceof HTMLElement))throw new Error("wtf");o.style.display="none"}),{source:"show-text.ts",devicePixelRatio}}window.initScreenCapture=X;
