import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as g}from"./client-misc-B8CxQsfg.js";import{b as D,s as K,h as I,t as B}from"./fourier-shared-DpvWsPe-.js";import{p as O,d as Z,b as J,P as _}from"./path-shape-CZZKMsju.js";import{m as a}from"./misc-BHUyxQfl.js";import{g as q,e as W}from"./utility-Dgy6CMn3.js";function X(){document.body.style.backgroundColor="transparent",g.selectorQueryAll("[data-hide-background]",SVGElement).forEach(c=>c.style.display="none")}function Y(){const c=g.selectorQuery("[data-hide-background]",SVGElement);c.parentElement?.append(c)}const U=new URLSearchParams(window.location.search);let j=!1;U.get("hide_background")=="1"?X():U.get("only_background")=="1"&&Y();{const e=g.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");e.filter="url(#watercolor)";const t=1;e.scale(t,t)}const ee=1024;class te{constructor(e,t){this.terms=t,e instanceof SVGGElement||(e=g.selectorQuery(e,SVGGElement)),this.#e=g.selectorQueryAll("g.frequency",SVGGElement,0,1/0,e).map(r=>{const n=g.selectorQuery("text",SVGTextElement,r),h=document.createElementNS("http://www.w3.org/2000/svg","text");return h.classList.add("background"),r.insertBefore(h,n),{top:r,spinner:g.selectorQuery(".spinner",SVGPolygonElement,r),text:n,background:h}})}#e;show(e,t){this.#e.forEach((r,n)=>{if(n>=e)r.top.style.display="none";else{r.top.style.display="";const h=this.terms[n];r.background.innerHTML=r.text.innerHTML=h.frequency.toString(),r.spinner.style.transform=`rotate(${t*h.frequency+h.phase+a.FULL_CIRCLE/4}rad)`}})}}function T(c,e){if(c>=e)throw new Error("wtf");const t=a.makeLinear(c,0,e,1);function r(n){if(n<=c)return 0;if(n>=e)return 1;const h=t(n);return W(h)}return r}let Q=()=>{};window.showFrame=c=>{Q(c)};class ${constructor(e,t){this.getTransform=t,this.#e=e,this.#n=g.selectorQuery("[data-reference]",SVGPathElement,this.#e),this.#t=g.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#e)}#e;#n;#t;hide(){this.#e.style.display="none"}show(e,t){this.#e.style.display="",this.#n.style.stroke=e}setReferencePath(e){this.#n.setAttribute("d",e)}setLivePath(e){this.#t.forEach(t=>t.setAttribute("d",e))}setTransform(e){const t=e.a;this.#e.style.transform=e.toString(),this.#e.style.setProperty("--path-scale",t.toString())}static right=new $(g.getById("right",SVGGElement),e=>O(e,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const z=new Z;class ne{constructor(e){this.pathString=e,this.samples=D(e,ee),this.terms=K(this.samples),this.keyframes=a.initializedArray(21,t=>t)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(e,t=0,r=e-t){const n=this.makeGetPath2(),h=a.makeBoundedLinear(t,0,r,1),S=this.stepCount;function v(m){let l=Math.floor(m/e),f;l<0?(l=0,f=0):l>=S?(l=S-1,f=e):f=m%e;const u=h(f);return{pathString:n(l,u),index:l,t:u}}return v}makeGetPath2(){const e=[...this.terms],t=[...this.keyframes],r=this.stepCount,n=m=>Math.max(...e.slice(0,m).map(f=>Math.abs(f.frequency))),h=m=>{if(m==0)return 8;{const l=n(m);return 8*Math.min(l,50)+7}},S=a.initializedArray(r,m=>{const l=t[m],f=t[m+1];if(l==0&&f==1&&e[0].frequency==0){let u=function(d){return`${o.x*d},${o.y*d}`};const o=a.assertNonNullable(I(e[0])),s=T(0,.5),i=T(0,1);return d=>{const b=i(d),p=u(b),C=s(d),w=u(C);return`M ${p} L ${w}`}}else if(l==f){const u=B(e,l),o=h(f),i=_.glitchFreeParametric(u,o).rawPath;return d=>i}else{const o=.2/Math.abs(e[l].frequency),s=a.makeBoundedLinear(0,-o,1,1+o),i=B(e,l),d=B(e,f-l,l),b=h(f);if(l==0||l==1&&I(e[0])){const p=I(e[0])??{x:0,y:0};return C=>{const w=s(C),k=w-o,y=w+o,P=T(k,y),V=Math.min(1,y);if(V<=0)return`M${p.x},${p.y} L${p.x},${p.y}`;{let E=function(x){x=x*V;const G=i(x),M=1-P(x);if(M==0)return G;{const A=d(x);return{x:G.x+M*A.x,y:G.y+M*A.y}}};const F=Math.ceil(Math.max(b,150)*V);return _.glitchFreeParametric(E,F).rawPath}}}else return p=>{const C=s(p),w=T(C-o,C+o);function k(P){const V=i(P),E=1-w(P);if(E==0)return V;{const F=d(P);return{x:V.x+E*F.x,y:V.y+E*F.y}}}return _.glitchFreeParametric(k,b).rawPath}}});function v(m,l){const f=S[m];return f(l)}return v}}class se{hide(){this.#t.hide()}#e;show(e){this.#t.show(this.#s,this.#r),this.#t.setReferencePath(this.#n),this.#t.setTransform(this.#o),this.#e(e)}endTime;#n;#t;#s;#r;#o;constructor(e,t){this.#n=e.base.pathString,this.#t=e.destination,this.#s=e.referenceColor,this.#r=e.liveColor,z.d=this.#n,this.#o=this.#t.getTransform(z.getBBox());const r=7500,n=750;this.endTime=r*e.base.stepCount;const h=e.base.makeGetPath1(r,0,r-n),S=new te(t,e.base.terms);this.#e=v=>{const{pathString:m,index:l,t:f}=h(v);this.#t.setLivePath(m),S.show(e.base.keyframes[l+1],f*a.FULL_CIRCLE)}}}function re(...c){Q=e=>{c.forEach(t=>t.show(e))}}let N;setTimeout(()=>{if(j)return;let c=NaN;N=new g.AnimationLoop(e=>{isNaN(c)&&(c=e);const t=e-c;Q(t)}),window.animationLoop=N},1);function oe(c){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),N?.cancel(),{source:"fourier-smackdown.ts",script:c,seconds:125,devicePixelRatio}}window.initScreenCapture=oe;class ae{constructor(e,t){this.vertex1=e,this.vertex2=t}has(e){return e==this.vertex1||e==this.vertex2}other(e){if(this.vertex1==e)return this.vertex2;if(this.vertex2==e)return this.vertex1}}class R{constructor(e,t){this.pathSoFar=e,this.remainingEdges=t}oneStep(){const e=a.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((t,r)=>{const n=t.other(e);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new R([...this.pathSoFar,n],this.remainingEdges.toSpliced(r,1))})}*#e(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const e=this.oneStep();for(const t of e)yield*t.#e()}}static*get(e){yield*new this([0],e).#e()}static*getUnique(e){const t=Math.max(...e.map(n=>Math.max(n.vertex1,n.vertex2)))+1,r=new Set;for(const n of this.get(e)){const h=n.slice(0,n.length-1),S=this.#n(h);if(!r.has(S)){yield n,r.add(S);const v=this.#t(h,t).map(m=>this.#n(m));for(const m of v)r.add(m)}}}static#n(e){return String.fromCharCode(...e.map(t=>t+65))}static#t(e,t){const r=new Array;for(let n=1;n<e.length;n++){const h=e[n],S=(h+1)%t,v=q(e,n+1);S==v?r.push(a.initializedArray(e.length,m=>{const l=q(e,m+n);return a.positiveModulo(l-h,t)})):q(e,n-1)==S&&r.push(a.initializedArray(e.length,l=>{const f=q(e,n-l);return a.positiveModulo(f-h,t)}))}return r}static getSamples(){function e(t,...r){return a.initializedArray(t,n=>r.map(h=>new ae(n,(n+h)%t))).flat()}return{pentagram:e(5,1,2),dodecahedron:e(6,1,2),square:e(4,1),hex:e(10,1)}}}window.Progress=R;function ie(){const c=R.getSamples(),e=R.getUnique(c.pentagram);console.log(e,e.constructor.name);for(const t of e);}ie();{let c=function(u,o=0){const s=[],i=u.terms,d=i.length,b=7,p=14,C=i.splice(5,3),w=[];for(C.forEach((y,P)=>{(o&2**P)>0?(s.push([y]),w.push([])):(s.push([]),w.push([y]))});s.length<p-1-w.length;){let y;s.length<6?y=1:(s.length<9,y=2);const P=i.splice(0,y);if(P.length!=y)throw new Error("wtf");s.push(P)}if(s.splice(b,0,[...i]),s.push(...w),console.log(s),s.length!=p)throw new Error("wtf");if(i.length=0,i.length!=0)throw new Error("wtf");const k=u.keyframes;if(k.length=0,k.push(0),s.forEach(y=>{i.push(...y),k.push(i.length)}),i.length!=d)throw new Error("wtf")};class e{constructor(o){throw new Error("wtf")}static points=a.initializedArray(5,o=>{const s=a.FULL_CIRCLE*o/5+a.FULL_CIRCLE/4,i=Math.cos(s),d=Math.sin(s);return{x:i,y:d}});static allPaths=[...R.getUnique(R.getSamples().pentagram)]}class t{constructor(o){throw new Error("wtf")}static points=a.initializedArray(6,o=>{const s=a.FULL_CIRCLE*o/6+a.FULL_CIRCLE/4,i=Math.cos(s),d=Math.sin(s);return{x:i,y:d}});static allPaths=[...R.getUnique(R.getSamples().dodecahedron)];static makePathShape(o){const s=this.allPaths[o],i=J.M(r[0].x,r[0].y);return s.forEach((d,b)=>{if(b==0){if(d!=0)throw new Error("wtf")}else{const{x:p,y:C}=r[d],w=s[b-1];switch(a.positiveModulo(d-w,6)){case 1:{i.arc(0,0,p,C,"cw");break}case 2:case 4:{i.L(p,C);break}case 5:{i.arc(0,0,p,C,"ccw");break}default:throw new Error("wtf")}}}),i.pathShape}}const r=t.points,n=t.allPaths,h=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],S=a.Random.fromString("fourier-smackdown.ts");a.initializedArray(n.length,()=>{const u=S()*3|0,o=h[u];return h.splice(u,1),h.push(o),o});const v=[{color:"yellow",destRect:{x:.5,y:.5,width:3,height:3},index:37},{color:"red",destRect:{x:.5,y:4.5,width:3,height:3},index:37},{color:"var(--blue)",destRect:{x:4.5,y:1.5,width:3,height:3},index:37},{color:"lime",destRect:{x:4.5,y:5.5,width:3,height:3},index:37},{color:"pink",destRect:{x:8.5,y:.5,width:3,height:3},index:37},{color:"magenta",destRect:{x:8.5,y:4.5,width:3,height:3},index:37},{color:"orange",destRect:{x:12.5,y:1.5,width:3,height:3},index:37},{color:"#e2e2e2",destRect:{x:12.5,y:5.5,width:3,height:3},index:37}],m=v.map(({index:u})=>{const o=t.makePathShape(u).rawPath;return new ne(o)});console.log(m),m.forEach((u,o)=>{c(u,o)});const l=new Array,f=g.selectorQuery("g#foreground",SVGGElement);for(const[u,o]of a.zip(v,m)){const{color:s,destRect:i,search:d}=u,b=d===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):g.selectorQuery(`g.frequencies[data-frequencies="${d}"]`,SVGGElement),p=d===void 0?f.appendChild(a.assertClass(g.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):g.selectorQuery(`[data-fourier-top="${d}"]`,SVGGElement);p.style.setProperty("--color",s);const C=new $(p,y=>O(y,i,"srcRect fits completely into destRect"));b.style.fill=s;const w={base:o,destination:C,liveColor:s,referenceColor:s},k=new se(w,b);l.push(k),console.log(k)}{let u=function(E,F){const x=[E,E+a.FULL_CIRCLE/3,E-a.FULL_CIRCLE/3].map(H=>P(Math.sin(H)));x.push(0),x.push(V(Math.cos(F)));const G=x.join(" "),A=[G,G,G,"0 0 0 0 1"].join(`
`);i.setAttribute("values",A)},o=function(E){const F=d.map(L=>[]);E.forEach(L=>{if(L.length!=d.length)throw new Error("wtf");L.forEach((x,G)=>{F[G].push(x)})});for(const[L,x]of a.zip(d,F))L.setAttribute("tableValues",x.join(" "))},s=function(E){const F=E/24e4*a.FULL_CIRCLE*2,L=E/24e4*a.FULL_CIRCLE/2;u(F,L)};const i=g.selectorQuery("#lava-lamp feColorMatrix:first-of-type",SVGFEColorMatrixElement),d=[g.selectorQuery('#lava-lamp feFuncR[type="discrete"]',SVGFEFuncRElement),g.selectorQuery('#lava-lamp feFuncG[type="discrete"]',SVGFEFuncGElement),g.selectorQuery('#lava-lamp feFuncB[type="discrete"]',SVGFEFuncBElement)],k=[[[25,25,112],[70,130,180],[147,112,219],[60,179,113],[199,21,133],[0,206,209],[216,191,216]],[[65,105,225],[204,85,0],[255,160,122],[255,182,193],[255,245,157],[175,238,238]],[[80,40,100],[100,60,120],[120,80,140],[140,100,160],[160,120,180],[180,140,200]],[[70,100,80],[90,120,100],[110,140,120],[130,160,140],[150,180,160],[170,200,180]]].at(-1),y=a.makeLinear(0,0,255,1);k.forEach(E=>E.forEach((F,L,x)=>x[L]=y(F)));const P=a.makeLinear(-1,-.05,1,.8),V=a.makeLinear(1,0,-1,-.4);window.updateValues=u,o(k),l.push({show:s})}if(console.log(l),re(...l),U.get("thumbnail")=="1"){j=!0;const u=new Array;Array.from(f.children).forEach(s=>{const i=a.assertClass(s,SVGElement);i.dataset.live===void 0?i.style.display="none":(console.log("live",i.dataset.live),u.push(i))}),Q(2e4),g.selectorQueryAll("[data-reference]",SVGPathElement).forEach(s=>s.style.display="none");const o=g.selectorQueryAll("#starfield rect",SVGRectElement);o[0].parentElement.style.transform="scale(3)",o.forEach(s=>{s.style.transformOrigin=`${50/3}% 9%`}),o[1].style.transform="rotate(1.75deg)",o[2].style.transform="rotate(-2deg)",window.showFrame=s=>{console.info("ignoring showFrame()",s)}}}{const c=a.Random.fromString("Good Night 🌛"),e=g.selectorQuery("[data-favorite]",SVGCircleElement),t=a.makeLinear(0,.025,2,.15);for(let r=0;r<150;r++){const n=a.assertClass(e.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=c()*16,n.cy.baseVal.value=c()*9,n.r.baseVal.value=t(c()+c()),e.parentElement.append(n)}}
