import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as r}from"./client-misc-ZHNZ3-cL.js";import{s as C,R as u,m as $,b as I}from"./utility-CLLqSOR5.js";import{T as M,m as q}from"./letters-more-CCb5yfDk.js";import{m as N}from"./rough-lib-BT7NeulV.js";import{m as b}from"./misc-wGF4FraP.js";import"./path-shape-XCUZuMzS.js";import"./letters-base-DAfgggyy.js";import"./math-to-path-BjxPr1Cw.js";const O=r.getById("input",HTMLTextAreaElement),v=r.getById("randomSeed",HTMLInputElement),Q=r.getById("draw",HTMLButtonElement),U=r.getById("timeInSeconds",HTMLInputElement),B=r.getById("start",HTMLButtonElement),W=r.getById("time",HTMLInputElement),d=r.getById("handwriting",SVGGElement),w=r.getById("morph",SVGGElement),g={text:"",alignment:""};Q.addEventListener("click",()=>{H()});function H(o=O.value){const s=C('input[name="align"]:checked',HTMLInputElement,1,1)[0].value;if(s!="left"&&s!="center"&&s!="right")throw new Error("wtf");const m=o==g.text&&s==g.alignment;g.text=o,g.alignment=s;let c=v.value;(m||!u.seedIsValid(c))&&(c=u.newSeed(),v.value=c);const l=u.create(c);d.innerHTML="",w.innerHTML="";const i=new M;i.font=q(7);const f=i.font.get("0").fontMetrics;i.lineHeight=f.bottom-f.capitalTop,i.restart();const k=i.addText(o,s),A=["hwb(180deg 0% 25.07%)","hwb(180deg 0% 25.07%)","white","hwb(47.34deg 8.63% 5.88%)"],y=new Map,S=k.map(t=>{const e=t.baseline;let n=y.get(e);return n===void 0&&(n=A.shift(),n??="violet",y.set(e,n)),{...t,color:n}}).map(t=>{const e=N(t.description.shape,t.description.fontMetrics.strokeWidth,l),n=e.after,p=e.before;return{...t,roughShape:n,normalShape:p,description:{shape:n}}}),E=M.displayText(S,w).map(t=>{t.element.style.stroke=t.color;const e=[{offset:0,d:t.roughShape.cssPath},{offset:1,d:t.normalShape.cssPath}],n=t.element.animate(e,{duration:1,fill:"both"});return n.pause(),n}),P=()=>{w.style.display="none"},G=t=>{I(t),w.style.display="";const e=t*E.length;E.forEach((n,p)=>{const a=e-p,h=Math.min(1,Math.max(0,a));n.currentTime=h})};{let t=.01;S.forEach(e=>{e.roughShape.splitOnMove().map(p=>{const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",p.rawPath),a.style.transform=`translate(${e.x}px, ${e.baseline}px)`,a.style.stroke=e.color,d.appendChild(a);const h=t,L=a.getTotalLength();t=h+L,a.style.setProperty("--offset",h.toString()),a.style.setProperty("--length",L.toString())});const n=t;d.style.setProperty("--total-length",n.toString())})}const F=()=>{d.style.display="none"},T=t=>{I(t),d.style.display="",d.style.setProperty("--t",t.toString())};window.showHandwriting=T;const R=$(2,1),V=t=>{const e=R(t);switch(e.index){case 0:{P(),T(e.t);break}case 1:{F(),G(e.t);break}default:throw new Error("wtf")}};window.showFrame=V,B.disabled=!1}let x;B.addEventListener("click",()=>{x?.cancel();const o=b.parseIntX(U.value);if(o===void 0)throw new Error("I don't want to do this better");let s=0,m;const c=new r.AnimationLoop(l=>{if(m||(s=l+o*1e3,m=b.makeLinear(l,0,s,1)),l>s)c.cancel(),window.showFrame(1);else{const i=m(l);W.value=i.toString(),window.showFrame(i)}});x=c});function X(){return H(),document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(o=>{if(!(o instanceof SVGElement||o instanceof HTMLElement))throw new Error("wtf");o.style.display="none"}),{source:"show-text.ts",devicePixelRatio}}window.initScreenCapture=X;
