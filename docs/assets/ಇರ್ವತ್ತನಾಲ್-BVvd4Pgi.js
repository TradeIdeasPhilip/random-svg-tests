import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as x}from"./client-misc-B8CxQsfg.js";import{b as tt,s as et,h as B,t as $}from"./fourier-shared-BneanVCb.js";import{p as X,d as nt,b as st,P as z}from"./path-shape-DN4hoPl6.js";import{m as c}from"./misc-BHUyxQfl.js";import{g as q,e as rt}from"./utility-Dgy6CMn3.js";function ot(){document.body.style.backgroundColor="transparent",x.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function at(){const i=x.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}{const i=c.Random.fromString("Pastel 41"),t=x.selectorQuery("[data-favorite]",SVGCircleElement),e=c.makeLinear(0,.025,2,.15);for(let s=0;s<150;s++){const n=c.assertClass(t.cloneNode(!0),SVGCircleElement);n.cx.baseVal.value=i()*16,n.cy.baseVal.value=i()*9,n.r.baseVal.value=e(i()+i()),t.parentElement.append(n)}}const N=new URLSearchParams(window.location.search);let K=!1;N.get("hide_background")=="1"?ot():N.get("only_background")=="1"&&at();{const t=x.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const it=1024;class U{static#t=x.selectorQuery("[data-motion-blur-spinners]",HTMLDivElement);#n;constructor(t={radius:1,centerX:2,centerY:2}){const e=document.createElement("div");e.classList.add("motion-blur-spinner"),U.#t.append(e);const s=this.#n=e.style;s.setProperty("--radius",t.radius.toString()),s.setProperty("--center-x",t.centerX.toString()),s.setProperty("--center-y",t.centerY.toString()),t.color&&s.setProperty("--color",t.color),this.hide()}#e;showRadians(t){const e=this.#e??t;this.#e=t;const s=this.#n;s.display="",s.setProperty("--main-angle",`${t}rad`),s.setProperty("--blur-angle",`${e}rad`)}hide(){this.#e=void 0,this.#n.display="none"}}function O(i,t){if(i>=t)throw new Error("wtf");const e=c.makeLinear(i,0,t,1);function s(n){if(n<=i)return 0;if(n>=t)return 1;const g=e(n);return rt(g)}return s}let _=()=>{};window.showFrame=i=>{_(i)};class D{constructor(t,e){this.getTransform=e,this.#t=t,this.#n=x.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=x.selectorQueryAll("[data-live]",SVGPathElement,1,1/0,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.forEach(e=>e.setAttribute("d",t))}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new D(x.getById("right",SVGGElement),t=>X(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const Y=new nt;class ct{constructor(t,e,s=0,n=e-s){this.stepCount=t,this.period=e,this.#t=c.makeBoundedLinear(s,0,n,1),this.endTime=e*t}#t;endTime;get(t){let e=Math.floor(t/this.period),s;e<0?(e=0,s=0):e>=this.stepCount?(e=this.stepCount-1,s=this.period):s=t%this.period;const n=this.#t(s);return{index:e,t:n}}}class lt{constructor(t){this.pathString=t,this.samples=tt(t,it),this.terms=et(this.samples),this.keyframes=c.initializedArray(21,e=>e)}samples;terms;keyframes;bins(){const t=new Array;return this.keyframes.forEach((e,s,n)=>{const g=s-1;if(g>=0){const S=n[g],F=this.terms.slice(S,e);t.push(F)}}),t}get stepCount(){return this.keyframes.length-1}makeGetPath1(t){const e=this.makeGetPath2();function s(n){const{index:g,t:S}=t.get(n);return e(g,S)}return s}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],s=this.stepCount,n=f=>Math.max(...t.slice(0,f).map(m=>Math.abs(m.frequency))),g=f=>{if(f==0)return 8;{const o=n(f);return 8*Math.min(o,50)+7}},S=c.initializedArray(s,f=>{const o=e[f],m=e[f+1];if(o==0&&m==1&&t[0].frequency==0){let V=function(C){return`${P.x*C},${P.y*C}`};const P=c.assertNonNullable(B(t[0])),L=O(0,.5),v=O(0,1);return C=>{const R=v(C),a=V(R),r=L(C),l=V(r);return`M ${a} L ${l}`}}else if(o==m){const V=$(t,o),P=g(m),v=z.glitchFreeParametric(V,P).rawPath;return C=>v}else{const P=.2/Math.abs(t[o].frequency),L=c.makeBoundedLinear(0,-P,1,1+P),v=$(t,o),C=$(t,m-o,o),R=g(m);if(o==0||o==1&&B(t[0])){const a=B(t[0])??{x:0,y:0};return r=>{const l=L(r),h=l-P,d=l+P,p=O(h,d),u=Math.min(1,d);if(u<=0)return`M${a.x},${a.y} L${a.x},${a.y}`;{let b=function(w){w=w*u;const k=v(w),G=1-p(w);if(G==0)return k;{const I=C(w);return{x:k.x+G*I.x,y:k.y+G*I.y}}};const E=Math.ceil(Math.max(R,150)*u);return z.glitchFreeParametric(b,E).rawPath}}}else return a=>{const r=L(a),l=O(r-P,r+P);function h(p){const u=v(p),b=1-l(p);if(b==0)return u;{const E=C(p);return{x:u.x+b*E.x,y:u.y+b*E.y}}}return z.glitchFreeParametric(h,R).rawPath}}});function F(f,o){const m=S[f];return m(o)}return F}}class A{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#o),this.#t(t)}timer;#n;#e;#s;#r;#o;base;static PERIOD=7e3;static PAUSE=1e3;constructor(t){this.base=t.base,this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,Y.d=this.#n,this.#o=this.#e.getTransform(Y.getBBox()),this.timer=new ct(t.base.stepCount,A.PERIOD,A.PAUSE);const e=t.base.makeGetPath1(this.timer);this.#t=s=>{const n=e(s);this.#e.setLivePath(n)}}}function ht(...i){_=t=>{i.forEach(e=>e.show(t))}}let Q;setTimeout(()=>{if(K)return;let i=NaN;Q=new x.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;_(e)}),window.animationLoop=Q},1);function ut(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),Q?.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:90,devicePixelRatio}}window.initScreenCapture=ut;class dt{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class M{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=c.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,s)=>{const n=e.other(t);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new M([...this.pathSoFar,n],this.remainingEdges.toSpliced(s,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(n=>Math.max(n.vertex1,n.vertex2)))+1,s=new Set;for(const n of this.get(t)){const g=n.slice(0,n.length-1),S=this.#n(g);if(!s.has(S)){yield n,s.add(S);const F=this.#e(g,e).map(f=>this.#n(f));for(const f of F)s.add(f)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const s=new Array;for(let n=1;n<t.length;n++){const g=t[n],S=(g+1)%e,F=q(t,n+1);S==F?s.push(c.initializedArray(t.length,f=>{const o=q(t,f+n);return c.positiveModulo(o-g,e)})):q(t,n-1)==S&&s.push(c.initializedArray(t.length,o=>{const m=q(t,n-o);return c.positiveModulo(m-g,e)}))}return s}static getSamples(){function t(e,...s){return c.initializedArray(e,n=>s.map(g=>new dt(n,(n+g)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=M;function ft(){const i=M.getSamples(),t=M.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}ft();{let i=function(a,r,l){const h=r-a,d=l-a,p=2*a,u=2*a;return{x:h,y:d,width:p,height:u}},t=function(a){return S.map(({dark:r})=>new U({...a,color:r})).reverse()};class e{constructor(r){throw new Error("wtf")}static points=c.initializedArray(5,r=>{const l=c.FULL_CIRCLE*r/5+c.FULL_CIRCLE/4,h=Math.cos(l),d=Math.sin(l);return{x:h,y:d}});static allPaths=[...M.getUnique(M.getSamples().pentagram)]}class s{constructor(r){throw new Error("wtf")}static points=c.initializedArray(6,r=>{const l=c.FULL_CIRCLE*r/6+c.FULL_CIRCLE/4,h=Math.cos(l),d=Math.sin(l);return{x:h,y:d}});static allPaths=[...M.getUnique(M.getSamples().dodecahedron)];static makePathShape(r){const l=this.allPaths[r],h=st.M(n[0].x,n[0].y);return l.forEach((d,p)=>{if(p==0){if(d!=0)throw new Error("wtf")}else{const{x:u,y:b}=n[d],E=l[p-1];switch(c.positiveModulo(d-E,6)){case 1:{h.arc(0,0,u,b,"cw");break}case 2:case 4:{h.L(u,b);break}case 5:{h.arc(0,0,u,b,"ccw");break}default:throw new Error("wtf")}}}),h.pathShape}}const n=s.points,g=s.allPaths,S=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],F=c.Random.fromString("fourier-smackdown.ts");c.initializedArray(g.length,()=>{const a=F()*3|0,r=S[a];return S.splice(a,1),S.push(r),r});let f=63;const o=9/4,m=.65,V=[{color:"n/a",destRect:i(o*m,o,2.75*o),index:f},{color:"n/a",destRect:i(o*m,(o+16/2)/2,9-2.75*o),index:f},{color:"n/a",destRect:i(o*m,16/2,2.75*o),index:f},{color:"n/a",destRect:i(o*m,(16-o+16/2)/2,9-2.75*o),index:f},{color:"n/a",destRect:i(o*m,16-o,2.75*o),index:f}],P={radius:o*m,cx:[o,(o+16/2)/2,16/2,(16-o+16/2)/2,16-o],cy:[9-2.75*o,2.75*o]};console.log(P);const L=V.map(({index:a})=>{const r=s.makePathShape(a).rawPath;return new lt(r)});L.forEach(({terms:a,keyframes:r},l)=>{const h=a.length,d=[],p=10;for(;d.length<p-1;){let y;d.length<6?y=1:y=2;const w=a.splice(0,y);if(w.length!=y)throw new Error("wtf");d.push(w)}const u=[],b=[];d.forEach((y,w)=>{w%3<2?u.push(y):b.unshift(y)});const E=[...u,[...a],...b];if(E.length!=p)throw new Error("wtf");if(console.log(E),a.length=0,r.length=0,r.push(0),E.forEach((y,w,k)=>{a.push(...y),r.push(a.length)}),a.length!=h)throw new Error("wtf")}),console.log(L);const v=new Array,C=x.selectorQuery("g#foreground",SVGGElement);x.getById("chapterList",SVGTextElement);const R=[{light:"HotPink",dark:"red"},{light:"white",dark:"gray"},{light:"var(--blue)",dark:"blue"},{light:"orange",dark:"darkOrange"},{light:"Fuchsia ",dark:"DarkViolet"}];V.length-1;for(const[a,r,{light:l,dark:h},d]of c.zip(V,L,R,c.count())){const{destRect:p,search:u}=a,b=u===void 0?document.createElementNS("http://www.w3.org/2000/svg","g"):x.selectorQuery(`g.frequencies[data-frequencies="${u}"]`,SVGGElement),E=u===void 0?C.appendChild(c.assertClass(x.selectorQuery("defs g[data-fourier-top]",SVGGElement).cloneNode(!0),SVGGElement)):x.selectorQuery(`[data-fourier-top="${u}"]`,SVGGElement);E.style.setProperty("--color",l),E.style.setProperty("--blur-color",h);const y=new D(E,G=>X(G,p,"srcRect fits completely into destRect"));E.dataset.liveIndex=d.toString(),b.style.fill=h;const w={base:r,destination:y,liveColor:h,referenceColor:l},k=new A(w);v.push(k),console.log(k)}{let a=function(y){const{index:w,t:k}=b.get(y),G=k>=1?-1:w,I=k*c.FULL_CIRCLE;for(const[Z,H,j]of c.zip(E,p,c.count()))if(j>G)H.forEach(T=>{T.hide()});else for(const[T,J]of c.zip(Z,H)){const W=I*T.frequency+T.phase;J.showRadians(W)}};const r=P.radius/4,l=P.cx,h=P.cy,d=r*1.5,p=[];if([-1,1].forEach(y=>{const w=h[0]+y*d;[l[0],l[2],l[4]].forEach(k=>{p.push(t({centerX:k,centerY:w,radius:r}))})}),[-1,1].forEach(y=>{const w=h[1]+y*d;[l[1],l[3]].forEach(k=>{p.push(t({centerX:k,centerY:w,radius:r}))})}),p.length!=10)throw new Error("wtf");const u=c.assertClass(v[0],A),b=u.timer,E=u.base.bins();v.push({show:a})}if(console.log(v),ht(...v),N.get("thumbnail")=="1"){K=!0;const a=new Array;Array.from(C.children).forEach(r=>{const l=c.assertClass(r,SVGElement);l.dataset.live===void 0?l.style.display="none":(console.log("live",l.dataset.live),a.push(l))}),v[0].show(14e3),v[1].show(28e3),v[2].show(42e3),window.showFrame=r=>{console.info(`ignoring showFrame(${r})`)},x.selectorQueryAll("[data-reference]",SVGPathElement).forEach(r=>r.style.display="none"),x.selectorQueryAll("#new-starfield circle",SVGCircleElement).forEach(r=>{r.style.transform="scale(3)",r.style.transformOrigin=`${r.cx.baseVal.value}px ${r.cy.baseVal.value}px`})}}
