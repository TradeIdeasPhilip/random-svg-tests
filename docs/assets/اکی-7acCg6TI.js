import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as v}from"./client-misc-ZHNZ3-cL.js";import{b as y,s as P}from"./utility-D9E8BDCl.js";import{P as T}from"./path-shape-fljILaqi.js";import{m as w}from"./misc-wGF4FraP.js";const M=1e-4;class S{compute(t,e,s){let r=0;for(let i=0;i<s;i++){const a=this.constant(e,i);r+=a*(t-e)**i}return r}invalid(t){return this.badPoints.some(({real:e,imaginary:s})=>t==e&&s==0)}validRanges(){const t=this.badPoints.flatMap(({real:s,imaginary:r})=>r==0?[s]:[]).sort((s,r)=>s-r);return t.push(1/0),t.map((s,r,i)=>({from:(i[r-1]??-1/0)+M,to:s-M}))}radiusOfConvergence(t){return Math.min(...this.badPoints.map(e=>Math.hypot(t-e.real,e.imaginary)))}partialSum(t,e){const s=w.initializedArray(e,i=>this.constant(t,i));function r(i){const a=i-t;let n=0;return s.forEach((c,l)=>n+=c*a**l),n}return r}}class A extends S{numberOfTerms=1/0;constant(t,e){if(t===0)throw new Error("Reciprocal is undefined at x0 = 0");return(-1)**e/t**(e+1)}f(t){if(t===0)throw new Error("Reciprocal is undefined at x = 0");return 1/t}static instance=new this;badPoints=[{real:0,imaginary:0}]}class R extends S{numberOfTerms=1/0;constant(t,e){const s=t+e*Math.PI/2;let r=1;for(let i=1;i<=e;i++)r*=i;return Math.sin(s)/r}f(t){return Math.sin(t)}static instance=new this;badPoints=[]}class _ extends S{numberOfTerms=12;constant(t,e){const s=1+t*t;switch(e){case 0:return 1/s;case 1:return-2*t/s**2;case 2:return(3*t*t-1)/s**3;case 3:return 2*t*(3-5*t*t)/s**4;case 4:return(25*t**4-38*t*t+3)/(2*s**5);case 5:return t*(2842*t*t-1450*t**4-636)/(5*s**6);case 6:return(-7700*t**6+20316*t**4-9120*t*t+216)/(12*s**7);case 7:return t*(29718*t**4-46410*t*t+10869)/(3*s**8);case 8:return(159600*t**8-498960*t**6+424116*t**4-90456*t*t+2268)/(48*s**9);case 9:return t*(-672452*t**6+1660530*t**4-987318*t*t+117693)/(30*s**10);case 10:return(8044400*t**10-30524376*t**8+35128260*t**6-13524948*t**4+1475730*t*t-18360)/(720*s**11);case 11:return t*(29887350*t**8-96204090*t**6+87415950*t**4-22994430*t*t+1596795)/(180*s**12);default:throw new Error(`Term ${e} not implemented.`)}}f(t){return 1/(1+t*t)}static instance=new this;badPoints=[{real:0,imaginary:1},{real:0,imaginary:-1}]}const p=document.documentElement.style;class f{constructor(t){this.which=t,this.#t=y(`[data-center="${t}"]`,SVGCircleElement),this.#e=y(`[data-reconstruction="${t}"]`,SVGPathElement)}#t;#e;hide(){p.setProperty(`--example${this.which}-open-end-display`,"none"),this.#t.style.display="none",this.#e.style.d=""}draw2(t,e,s,r,i,a){function n(c){const l=t(c),d=e(c);return l*(1-s)+d*s}this.draw(n,r,i,a)}draw(t,e,s,r){if(s-=M,s<=0)throw new Error("wtf");const i=-9,a=9,n=e-s,c=e+s,l=Math.max(i,n),d=Math.min(a,c),o=m=>{const E=w.lerp(l,d,m),b=t(E);return{x:E,y:b}},u=T.parametric(o,50);this.#e.style.d=u.cssPath,this.#t.style.display="",this.#t.cx.baseVal.value=e,this.#t.cy.baseVal.value=t(e),isFinite(s)?(p.setProperty(`--example${this.which}-from-x`,n.toString()),p.setProperty(`--example${this.which}-from-y`,t(n).toString()),p.setProperty(`--example${this.which}-from-y-ideal`,r(n).toString()),p.setProperty(`--example${this.which}-to-x`,c.toString()),p.setProperty(`--example${this.which}-to-y`,t(c).toString()),p.setProperty(`--example${this.which}-to-y-ideal`,r(c).toString()),p.setProperty(`--example${this.which}-open-end-display`,"")):p.setProperty(`--example${this.which}-open-end-display`,"none")}precompute(t,e,s){const r=t.radiusOfConvergence(e),i=w.initializedArray(s,n=>t.partialSum(e,n));return n=>{if(n>i.length-1)throw new Error(`Requested: ${n}, Available [0 - ${i.length-1}]`);if(Number.isInteger(n))this.draw(i[n],e,r,t.f);else{let c=function(u){const m=l(u),E=d(u);return m*(1-o)+E*o};const l=i[Math.floor(n)],d=i[Math.ceil(n)],o=n%1;this.draw(c,e,r,t.f)}}}drawAll(t,e,s){if(t.invalid(e))this.hide();else{const r=t.radiusOfConvergence(e);if(Number.isInteger(s))this.draw(t.partialSum(e,s),e,r,t.f);else{const i=t.partialSum(e,Math.floor(s)),a=t.partialSum(e,Math.ceil(s)),n=s%1;this.draw2(i,a,n,e,r,t.f)}}}static instances=[new this("1"),new this("2"),new this("3")]}class g{#t=v.getById("original-function",SVGPathElement);hide(){this.#t.style.d=""}draw(t){const r=t.validRanges().flatMap(a=>{const n=Math.max(-9,a.from),c=Math.min(9,a.to);if(n>=c)return[];{const l=o=>{const u=w.lerp(n,c,o),m=t.f(u);return{x:u,y:m}};return T.parametric(l,Math.ceil((c-n)*5)).commands}}),i=new T(r);this.#t.style.d=i.cssPath}static instance=new this}class I{#t={paused:!0,timePassed:0};get timePassed(){return this.#t.paused?this.#t.timePassed:performance.now()-this.#t.timeOffset}get paused(){return this.#t.paused}pause(){this.#t.paused||(this.#t={paused:!0,timePassed:this.timePassed})}play(){this.#t.paused&&(this.#t={paused:!1,timeOffset:performance.now()-this.timePassed})}set paused(t){t?this.pause():this.play()}restart(){const t=this.paused;this.#t={timePassed:0,paused:!0},this.paused=t}#e(t){this.#t.paused||this.show(t-this.#t.timeOffset)}#l=38;#s=1e3;#i=800;#a=this.#l*(this.#i+this.#s)+this.#s;showPart1(t){if(t<0||t>=this.#a)return;const e=Math.floor(t/(this.#s+this.#i)),s=t-e*(this.#s+this.#i),i=Math.max(0,s-this.#s)/this.#i,a=e+i,n=R.instance;g.instance.draw(n),f.instances[0].drawAll(n,-Math.PI*7/4,a),f.instances[1].drawAll(n,0,a),f.instances[2].drawAll(n,Math.PI*3/2,a)}#u=20;#n=1100;#r=900;#o=this.#u*(this.#r+this.#n)+this.#n;#c=13e3;#h=22e3;#d=w.makeLinear(this.#c,-9,this.#h,9);showPart2(t){if(t<0||t>=this.#o)return;const e=Math.floor(t/(this.#n+this.#r)),s=t-e*(this.#n+this.#r),i=Math.max(0,s-this.#n)/this.#r,a=e+i,n=A.instance;g.instance.draw(n),f.instances[0].drawAll(n,-2,a),f.instances[1].drawAll(n,1,a),t<this.#c||t>this.#h?f.instances[2].hide():f.instances[2].drawAll(n,this.#d(t),a)}show=this.showPart1;constructor(){console.log(`Part 1 length: ${this.#a/1e3} seconds.`,`Part 2 length: ${this.#o/1e3} seconds.`),new v.AnimationLoop(this.#e.bind(this)),window.initScreenCapture=this.initScreenCapture.bind(this),window.showFrame=t=>{this.show(t/60*1e3)}}static instance=new this;initScreenCapture(t){switch(document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(e=>{if(!(e instanceof SVGElement||e instanceof HTMLElement))throw new Error("wtf");e.style.display="none"}),t){case"part 1":return this.show=this.showPart1,{source:"some4.ts",devicePixelRatio,script:t,firstFrame:0,lastFrame:Math.floor(this.#a/1e3*60)};case"part 2":return this.show=this.showPart2,{source:"some4.ts",devicePixelRatio,script:t,firstFrame:0,lastFrame:Math.floor(this.#o/1e3*60)};default:throw new Error(`Unknown script: ${JSON.stringify(t)}`)}}}window.debugStuff={HiddenPoles:_,Sine:R,Reciprocal:A,TaylorElements:f,Script:I};console.log("debugStuff",window.debugStuff);{let h=function(){t()},t=function(){const o=c.map(({use:u,value:m})=>{if(u.checked)return m.valueAsNumber});L(w.parseIntX(s.value),r.valueAsNumber,...o)},e=function(){const o=r.valueAsNumber;Number.isInteger(o)?(l=Math.max(0,o-1),d=Math.min(12,o+1)):(l=Math.floor(o),d=Math.ceil(o)),n.innerText=o.toFixed(3),i.innerText=l.toString(),a.innerText=d.toString()};const s=y("#manual-controls select",HTMLSelectElement),r=y("#manual-controls > input",HTMLInputElement),[i,a]=P("[data-term-stepper] button",HTMLButtonElement,2,2),n=y("[data-term-stepper] span",HTMLSpanElement),c=P("#manual-controls > div[data-x0]",HTMLDivElement,3,3).map(o=>{const[u,m]=P("input",HTMLInputElement,2,2,o);return u.addEventListener("input",h),m.addEventListener("input",()=>{u.checked=!0,h()}),{use:u,value:m}});s.addEventListener("input",t);let l=NaN,d=NaN;r.addEventListener("input",()=>{e(),h()}),i.addEventListener("click",()=>{r.value=l.toString(),e(),h()}),a.addEventListener("click",()=>{r.value=d.toString(),e(),h()}),e(),h()}function L(h,t,...e){const s=[R.instance,A.instance,_.instance],r=s[h%s.length];g.instance.draw(r),f.instances.forEach((i,a)=>{const n=e[a];n===void 0?i.hide():i.drawAll(r,n,t)})}window.debugDraw=L;
