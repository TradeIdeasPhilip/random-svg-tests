import"./modulepreload-polyfill-B5Qt9EMX.js";import{c as f}from"./client-misc-B8CxQsfg.js";import{b as I,s as H,h as A,t as O}from"./fourier-shared-NjkoHtEt.js";import{p as N,d as D,b as K,P as z}from"./path-shape-CZZKMsju.js";import{m as l}from"./misc-BHUyxQfl.js";import{g as G,e as Z}from"./utility-Dgy6CMn3.js";function j(){document.body.style.backgroundColor="transparent",f.selectorQueryAll("[data-hide-background]",SVGElement).forEach(i=>i.style.display="none")}function J(){const i=f.selectorQuery("[data-hide-background]",SVGElement);i.parentElement?.append(i)}const R=new URLSearchParams(window.location.search);if(R.get("hide_background")=="1")j();else if(R.get("only_background")=="1")J();else if(R.get("thumbnail")=="1"){const i=f.selectorQuery("g#foreground",SVGGElement);i.style.display="none";const t=f.selectorQuery("g#thumbnail-foreground",SVGGElement);t.style.display=""}{const t=f.selectorQuery("canvas#cache",HTMLCanvasElement).getContext("2d");t.filter="url(#watercolor)";const e=1;t.scale(e,e)}const W=1024;class X{constructor(t,e){this.terms=e,t instanceof SVGGElement||(t=f.selectorQuery(t,SVGGElement)),this.#t=f.selectorQueryAll("g.frequency",SVGGElement,0,1/0,t).map(r=>{const n=f.selectorQuery("text",SVGTextElement,r),c=document.createElementNS("http://www.w3.org/2000/svg","text");return c.classList.add("background"),r.insertBefore(c,n),{top:r,spinner:f.selectorQuery(".spinner",SVGPolygonElement,r),text:n,background:c}})}#t;show(t,e){this.#t.forEach((r,n)=>{if(n>=t)r.top.style.display="none";else{r.top.style.display="";const c=this.terms[n];r.background.innerHTML=r.text.innerHTML=c.frequency.toString(),r.spinner.style.transform=`rotate(${e*c.frequency+c.phase+l.FULL_CIRCLE/4}rad)`}})}}function M(i,t){if(i>=t)throw new Error("wtf");const e=l.makeLinear(i,0,t,1);function r(n){if(n<=i)return 0;if(n>=t)return 1;const c=e(n);return Z(c)}return r}let $=()=>{};window.showFrame=i=>{$(i)};class B{constructor(t,e){this.getTransform=e,this.#t=f.selectorQuery(t,SVGGElement),this.#n=f.selectorQuery("[data-reference]",SVGPathElement,this.#t),this.#e=f.selectorQuery("[data-live]",SVGPathElement,this.#t)}#t;#n;#e;hide(){this.#t.style.display="none"}show(t,e){this.#t.style.display="",this.#n.style.stroke=t,this.#e.style.stroke=e}setReferencePath(t){this.#n.setAttribute("d",t)}setLivePath(t){this.#e.setAttribute("d",t)}setTransform(t){const e=t.a;this.#t.style.transform=t.toString(),this.#t.style.setProperty("--path-scale",e.toString())}static right=new B("#right",t=>N(t,{x:1,y:1,width:14,height:7},"srcRect fits completely into destRect",1))}const _=new D;class Y{constructor(t){this.pathString=t,this.samples=I(t,W),this.terms=H(this.samples),this.keyframes=l.initializedArray(16,e=>e)}samples;terms;keyframes;get stepCount(){return this.keyframes.length-1}makeGetPath1(t,e=0,r=t-e){const n=this.makeGetPath2(),c=l.makeBoundedLinear(e,0,r,1),d=this.stepCount;function u(s){let a=Math.floor(s/t),o;a<0?(a=0,o=0):a>=d?(a=d-1,o=t):o=s%t;const h=c(o);return{pathString:n(a,h),index:a,t:h}}return u}makeGetPath2(){const t=[...this.terms],e=[...this.keyframes],r=this.stepCount,n=s=>Math.max(...t.slice(0,s).map(o=>Math.abs(o.frequency))),c=s=>8*n(s)+7,d=l.initializedArray(r,s=>{const a=e[s],o=e[s+1];if(a==0&&o==1&&t[0].frequency==0){let h=function(g){return`${m.x*g},${m.y*g}`};const m=l.assertNonNullable(A(t[0])),y=M(0,.5),w=M(0,1);return g=>{const k=w(g),p=h(k),x=y(g),E=h(x);return`M ${p} L ${E}`}}else{const m=.2/n(o),y=l.makeBoundedLinear(0,-m,1,1+m),w=O(t,a),g=O(t,o-a,a),k=c(o);if(a==0||a==1&&A(t[0])){const p=A(t[0])??{x:0,y:0};return x=>{const E=y(x),v=E-m,V=E+m,b=M(v,V),P=Math.min(1,V);if(P<=0)return`M${p.x},${p.y} L${p.x},${p.y}`;{let F=function(C){C=C*P;const q=w(C),T=1-b(C);if(T==0)return q;{const U=g(C);return{x:q.x+T*U.x,y:q.y+T*U.y}}};const L=Math.ceil(Math.max(k,150)*P);return z.glitchFreeParametric(F,L).rawPath}}}else return p=>{const x=y(p),E=M(x-m,x+m);function v(b){const P=w(b),F=1-E(b);if(F==0)return P;{const L=g(b);return{x:P.x+F*L.x,y:P.y+F*L.y}}}return z.glitchFreeParametric(v,k).rawPath}}});function u(s,a){const o=d[s];return o(a)}return u}}class tt{hide(){this.#e.hide()}#t;show(t){this.#e.show(this.#s,this.#r),this.#e.setReferencePath(this.#n),this.#e.setTransform(this.#a),this.#t(t)}endTime;#n;#e;#s;#r;#a;constructor(t,e){this.#n=t.base.pathString,this.#e=t.destination,this.#s=t.referenceColor,this.#r=t.liveColor,_.d=this.#n,this.#a=this.#e.getTransform(_.getBBox());const r=6e3,n=750;this.endTime=r*t.base.stepCount;const c=t.base.makeGetPath1(r,0,r-n),d=new X(e,t.base.terms);this.#t=u=>{const{pathString:s,index:a,t:o}=c(u);this.#e.setLivePath(s),d.show(t.base.keyframes[a+1],o*l.FULL_CIRCLE)}}}function et(...i){$=t=>{i.forEach(e=>e.show(t))}}let Q;setTimeout(()=>{let i=NaN;Q=new f.AnimationLoop(t=>{isNaN(i)&&(i=t);const e=t-i;$(e)}),window.animationLoop=Q},1);function nt(i){return document.querySelectorAll("[data-hideBeforeScreenshot]").forEach(t=>{if(!(t instanceof SVGElement||t instanceof HTMLElement))throw new Error("wtf");t.style.display="none"}),Q.cancel(),{source:"fourier-smackdown.ts",script:i,seconds:103,devicePixelRatio}}window.initScreenCapture=nt;class st{constructor(t,e){this.vertex1=t,this.vertex2=e}has(t){return t==this.vertex1||t==this.vertex2}other(t){if(this.vertex1==t)return this.vertex2;if(this.vertex2==t)return this.vertex1}}class S{constructor(t,e){this.pathSoFar=t,this.remainingEdges=e}oneStep(){const t=l.assertNonNullable(this.pathSoFar.at(-1));return this.remainingEdges.flatMap((e,r)=>{const n=e.other(t);return n===void 0||this.pathSoFar.length==1&&n!=1?[]:new S([...this.pathSoFar,n],this.remainingEdges.toSpliced(r,1))})}*#t(){if(this.remainingEdges.length==0)yield this.pathSoFar;else{const t=this.oneStep();for(const e of t)yield*e.#t()}}static*get(t){yield*new this([0],t).#t()}static*getUnique(t){const e=Math.max(...t.map(n=>Math.max(n.vertex1,n.vertex2)))+1,r=new Set;for(const n of this.get(t)){const c=n.slice(0,n.length-1),d=this.#n(c);if(!r.has(d)){yield n,r.add(d);const u=this.#e(c,e).map(s=>this.#n(s));for(const s of u)r.add(s)}}}static#n(t){return String.fromCharCode(...t.map(e=>e+65))}static#e(t,e){const r=new Array;for(let n=1;n<t.length;n++){const c=t[n],d=(c+1)%e,u=G(t,n+1);d==u?r.push(l.initializedArray(t.length,s=>{const a=G(t,s+n);return l.positiveModulo(a-c,e)})):G(t,n-1)==d&&r.push(l.initializedArray(t.length,a=>{const o=G(t,n-a);return l.positiveModulo(o-c,e)}))}return r}static getSamples(){function t(e,...r){return l.initializedArray(e,n=>r.map(c=>new st(n,(n+c)%e))).flat()}return{pentagram:t(5,1,2),dodecahedron:t(6,1,2),square:t(4,1),hex:t(10,1)}}}window.Progress=S;function rt(){const i=S.getSamples(),t=S.getUnique(i.pentagram);console.log(t,t.constructor.name);for(const e of t);}rt();{class i{constructor(s){throw new Error("wtf")}static points=l.initializedArray(5,s=>{const a=l.FULL_CIRCLE*s/5+l.FULL_CIRCLE/4,o=Math.cos(a),h=Math.sin(a);return{x:o,y:h}});static allPaths=[...S.getUnique(S.getSamples().pentagram)]}class t{constructor(s){throw new Error("wtf")}static points=l.initializedArray(6,s=>{const a=l.FULL_CIRCLE*s/6+l.FULL_CIRCLE/4,o=Math.cos(a),h=Math.sin(a);return{x:o,y:h}});static allPaths=[...S.getUnique(S.getSamples().dodecahedron)];static makePathShape(s){const a=this.allPaths[s],o=K.M(e[0].x,e[0].y);return a.forEach((h,m)=>{if(m==0){if(h!=0)throw new Error("wtf")}else{const{x:y,y:w}=e[h],g=a[m-1];switch(l.positiveModulo(h-g,6)){case 1:{o.arc(0,0,y,w,"cw");break}case 2:case 4:{o.L(y,w);break}case 5:{o.arc(0,0,y,w,"ccw");break}default:throw new Error("wtf")}}}),o.pathShape}}const e=t.points,r=t.allPaths,n=[{light:"var(--pastel-blue)",dark:"var(--darker-blue)"},{light:"var(--pastel-lavender)",dark:"var(--darker-purple)"},{light:"var(--pastel-pink)",dark:"var(--darker-pink)"},{light:"var(--pastel-mint)",dark:"var(--darker-teal)"},{light:"var(--pastel-coral)",dark:"var(--darker-coral)"}],c=l.Random.fromString("fourier-smackdown.ts");l.initializedArray(r.length,()=>{const u=c()*3|0,s=n[u];return n.splice(u,1),n.push(s),s});const d=new Array;{let u=function(s,a,o,h=s){const m=f.selectorQuery(`g.frequencies[data-frequencies="${h}"]`,SVGGElement),y=new B(`[data-fourier-top="${h}"]`,x=>N(x,a,"srcRect fits completely into destRect"));m.style.fill=s;const w=t.makePathShape(o).rawPath,g={base:new Y(w),destination:y,liveColor:s,referenceColor:s},k=new tt(g,m);d.push(k);const p=f.selectorQuery(`text.chapter[data-chapter="${h}"]`,SVGTextElement);p.innerHTML=`#${o}`,p.style.fill=s};u("red",{x:.5,y:.5,width:5,height:5},12),u("white",{x:5.5,y:3.5,width:5,height:5},13),u("var(--blue)",{x:10.5,y:.5,width:5,height:5},14,"blue")}et(...d)}
